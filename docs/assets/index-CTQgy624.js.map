{"version":3,"mappings":"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","names":["MAIN_MENU_ID","THEMES","PIECE_THEMES","BOARD_THEMES","EventEmitter","__publicField","listener","idx","event","_listeners","textToImages","text","result","words","cont","themeColor","_a","color","word","image","x","urlIcon","icon","pieceTheme","ariaDescriptionFromIcon","clone","object","setTitle","newTitle","setMeta","name","newValue","setupSEO","template","params","page","Configuration","_useSyzygy","_stockfishDepth","_stockfishMovetime","_automaticShowFirstPosition","_preventScreenOff","_colorTheme","_playSounds","_fullScreen","_highlightSquares","_pieceTheme","_boardTheme","value","DEFAULT_CONFIG","endgameDatabase","endgamedatabaseJson","StorageService","Storage","Drivers","key","storageService","ConfigurationService","resolve","config","cfg","configurationService","ThemeSwitcherService","theme","_b","themeSwitcherService","EndgameDatabaseService","localDatabase","database","category","subcategory","defaultDatabase","game","localCategory","localSubcategory","localGame","endgameDatabaseService","tryDefine","impl","tag","initialize","IonAlert","IonApp","IonButton","IonButtons","IonCardContent","IonCardHeader","IonCard","IonCardTitle","IonCol","IonContent","IonFabButton","IonFab","IonFabList","IonFooter","IonGrid","IonHeader","IonIcon","IonItem","IonLabel","IonList","IonMenuButton","IonMenu","IonMenuToggle","IonModal","IonRange","IonRippleEffect","IonRouterLink","IonRouterOutlet","IonRow","IonSegmentButton","IonSegment","IonSpinner","IonSplitPane","IonTitle","IonToast","IonToggle","IonToolbar","images","redrawIconImages","el","url","RouteService","menuId","query","menu","menuController","navigo","targetElementSelector","controller","targetElement","elementObserver","mutations","_mutation","content","response","routeItem","xData","pageMode","autoHeight","info","element","component","modal","modalController","data","routeMap","Navigo","mainRoute","route","oRoute","done","_match","canExit","routeService","BoardThemeSwitcherService","themeDefinition","item","style","boardThemeSwitcherService","SyzygyService","fen","syzygyService","StockfishService","message","engineUrl","nnue","self","mem","sourceWithSimd","stockfishListener","features","stockfishService","SoundService","sound","soundToPlay","soundJson","Howl","soundService","TemplateOutletDirective","metadata","framework","templateRef","Alpine","domHook","AlpineService","loaderContainer","browserLang","candidate","created","i18nJson","AlpineI18n","alpineService","services_initialize","BaseController","_info","_$routeParams","AboutController","version","aboutJson","aboutController","SettingsController","boardTheme","checked","toastController","toggleHighlightSquares","togglePlaySounds","toggleUseSyzygy","stockfishDepthRange","stockfishMovetimeRange","_value","settingsController","AppController","appController","HomeController","homeController","ListController","$routeParams","categories","idxCategory","idxSubcategory","idxLastSubcategory","listController","PromotionController","player","piece","promotionController","PositionController","Chess","header","container","infoWrapper","infoTarget","infoMoves","actionButtons","containerWidth","containerHeight","minSize","mod","board","dests","SQUARES","s","ms","m","turn","alertController","alert","order","idxGame","idxLastGame","customFen","turnWhite","turnColor","move","targetImage","colors","orig","dest","_metadata","Chessground","movelist","y","prevFen","history","itemOrder","move1","itemIndex","moveItem","source","target","promotion","moveFunk","match","from","to","_err","toast","positionController","ROUTE_MAP"],"ignoreList":[],"sources":["../../code/src/commons/constants.ts","../../code/src/commons/event-emitter.ts","../../code/src/commons/utils.ts","../../code/src/model/configuration.ts","../../code/src/model/endgame-database.ts","../../code/src/services/storage-service.ts","../../code/src/services/configuration-service.ts","../../code/src/services/theme-switcher-service.ts","../../code/src/services/endgame-database-service.ts","../../code/src/services/ionic.ts","../../code/src/services/route-service.ts","../../code/src/services/board-theme-switcher-service.ts","../../code/src/services/syzygy-service.ts","../../code/src/services/stockfish-service.ts","../../code/src/services/sound-service.ts","../../code/src/services/alpine-service.ts","../../code/src/services/services.ts","../../code/src/controllers/controller.ts","../../code/src/controllers/about.ts","../../code/src/controllers/settings.ts","../../code/src/controllers/app.ts","../../code/src/controllers/home.ts","../../code/src/controllers/list.ts","../../code/src/controllers/promotion.ts","../../code/src/controllers/position.ts","../../code/src/routes.ts","../../code/src/main.ts"],"sourcesContent":["export const MAIN_MENU_ID = 'main-menu';\nexport const THEMES = [\n    {\n        'name': 'dark',\n        'class': 'dark',\n        'mainColor': '#000000'\n    },\n    {\n        'name': 'light',\n        'class': '',\n        'mainColor': '#ffffff'\n    }\n];\n\nexport const PIECE_THEMES = ['alpha', 'california', 'cburnett', 'chess7', 'chessnut', 'chicago', 'companion', 'fantasy', 'iowa', 'kosal', 'leipzig', 'letter', 'merida', 'mono', 'oslo', 'pirouetti', 'pixel', 'reilly', 'riohacha', 'shapes', 'spatial', 'symmetric'];\n\nexport const BOARD_THEMES = [\n    {\n      'name': 'brown',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#F3E1C2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#C39976' },\n        { 'themeVariable': '--chess-black-background', 'value': '#C39976' },\n        { 'themeVariable': '--chess-black-color', 'value': '#F3E1C2' },\n      ]\n    },\n    {\n      'name': 'blue',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#E4E9EB' },\n        { 'themeVariable': '--chess-white-color', 'value': '#9DB1BB' },\n        { 'themeVariable': '--chess-black-background', 'value': '#9DB1BB' },\n        { 'themeVariable': '--chess-black-color', 'value': '#E4E9EB' },\n      ]\n    },\n    {\n      'name': 'green',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#FFFEE4' },\n        { 'themeVariable': '--chess-white-color', 'value': '#97B378' },\n        { 'themeVariable': '--chess-black-background', 'value': '#97B378' },\n        { 'themeVariable': '--chess-black-color', 'value': '#FFFEE4' },\n      ]\n    },\n    {\n      'name': 'grey',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#AAAAAA' },\n        { 'themeVariable': '--chess-white-color', 'value': '#888888' },\n        { 'themeVariable': '--chess-black-background', 'value': '#888888' },\n        { 'themeVariable': '--chess-black-color', 'value': '#AAAAAA' },\n      ]\n    },\n    {\n      'name': 'pink',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#FFF2F2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#BC4545' },\n        { 'themeVariable': '--chess-black-background', 'value': '#BC4545' },\n        { 'themeVariable': '--chess-black-color', 'value': '#FFF2F2' },\n      ]\n    },\n    {\n      'name': 'navy',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#ECECEC' },\n        { 'themeVariable': '--chess-white-color', 'value': '#385170' },\n        { 'themeVariable': '--chess-black-background', 'value': '#385170' },\n        { 'themeVariable': '--chess-black-color', 'value': '#ECECEC' },\n      ]\n    },\n    {\n      'name': 'dark-green',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#E0EFBA' },\n        { 'themeVariable': '--chess-white-color', 'value': '#467A4B' },\n        { 'themeVariable': '--chess-black-background', 'value': '#467A4B' },\n        { 'themeVariable': '--chess-black-color', 'value': '#E0EFBA' },\n      ]\n    },\n    {\n      'name': 'black-white',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#F2F2F2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#0C0C0C' },\n        { 'themeVariable': '--chess-black-background', 'value': '#0C0C0C' },\n        { 'themeVariable': '--chess-black-color', 'value': '#F2F2F2' },\n      ]\n    }\n  ];","export class EventEmitter<T> {\n  private _listeners: ((event: T) => void)[] = [];\n\n  constructor() { }\n\n  public addEventListener(listener: (event: T) => void) {\n    if (!this._listeners.includes(listener)) {\n      this._listeners.push(listener);\n    }\n  }\n\n  public removeEventListener(listener: (event: T) => void) {\n    const idx = this._listeners.indexOf(listener);\n    if (idx !== -1) {\n      this._listeners.splice(idx, 1);\n    }\n  }\n\n  public removeListeners() {\n    this._listeners = [];\n  }\n\n  public notify(event: T) {\n    this._listeners.forEach((_listeners) => {\n      _listeners(event);\n    });\n  }\n}\n","export const textToImages = (text: string) => {\n    const result: string[] = [];\n    const words = text.split(\" \");\n    let cont = 1;\n    let themeColor = document.querySelector('html')?.classList.contains('ion-theme-dark') ? 'w' : 'b';\n    let color = 'w';\n    words.forEach(word => {\n        let image;\n        word = word.toUpperCase();\n        if (word == 'ONE') {\n            cont = 1;\n        } else if (word == 'TWO') {\n            cont = 2;\n        } else if (word == 'THREE') {\n            image = `${themeColor}3.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'FOUR') {\n            image = `${themeColor}4.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'FIVE') {\n            image = `${themeColor}5.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'VS') {\n            image = `${themeColor}swords.svg`;\n            result.push(image);\n            color = 'b';\n        } else if (word.lastIndexOf('KING', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}K.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('QUEEN', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}Q.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('ROOK', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}R.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('BISHOP', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}B.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('KNIGHT', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}N.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('PAWN', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}P.svg`\n                result.push(image);\n            }\n            cont = 1;\n        }\n    });\n    return result;\n};\n\nexport const urlIcon = (icon: string, pieceTheme: string) => {\n    if (icon.includes('3.svg') || icon.includes('4.svg') || icon.includes('5.svg') || icon.includes('swords.svg') || icon.includes('elementary.svg')) {\n        return `assets/icons/${icon}`;\n    }\n    else {\n        return `assets/pieces/${pieceTheme}/${icon}`;\n    }\n};\n\nexport const ariaDescriptionFromIcon = (icon: string) => {\n    if (icon.endsWith('3.svg')) return 'three';\n    else if (icon.endsWith('4.svg')) return 'four';\n    else if (icon.endsWith('5.svg')) return 'five';\n    else if (icon.endsWith('elementary.svg')) return 'elementary';\n    else if (icon.endsWith('swords.svg')) return 'against';\n    else if (icon.endsWith('B.svg')) return 'bishop';\n    else if (icon.endsWith('K.svg')) return 'king';\n    else if (icon.endsWith('N.svg')) return 'knight';\n    else if (icon.endsWith('P.svg')) return 'pawn';\n    else if (icon.endsWith('Q.svg')) return 'queen';\n    else if (icon.endsWith('R.svg')) return 'rook';\n    else return 'unknown';\n};\n\nexport const clone = (object: any) => {\n    return JSON.parse(JSON.stringify(object));\n};\n\nconst setTitle = (newTitle: string) => {\n    window.document.title = newTitle;\n};\n\nconst setMeta = (name: string, newValue: string) => {\n    (window.document.getElementsByName(name)[0] as HTMLMetaElement).content = newValue;\n}\n\nexport const setupSEO = (template: string, params: any) => {\n    const page = template.replace('.html', '');\n    setTitle(window.AlpineI18n.t(`${page}.seo.title`, params));\n    setMeta('description', window.AlpineI18n.t(`${page}.seo.meta_description`, params));\n};","import { BOARD_THEMES, PIECE_THEMES, EventEmitter } from '../commons';\n\nexport type ConfigurationField =\n\n    'useSyzygy' | 'stockfishDepth' | 'stockfishMovetime' | 'automaticShowFirstPosition' | 'preventScreenOff' | 'colorTheme' | 'playSounds' | 'fullScreen' | 'highlightSquares' | 'pieceTheme' | 'boardTheme';\n\nexport type ConfigurationChangedEvent = { config: Configuration, field: ConfigurationField };\n\nexport class Configuration {\n\n    private _configurationChangedEmitter: EventEmitter<ConfigurationChangedEvent> = new EventEmitter<ConfigurationChangedEvent>();\n\n    constructor(\n        private _useSyzygy: boolean,\n        private _stockfishDepth: number,\n        private _stockfishMovetime: number,\n        private _automaticShowFirstPosition: boolean,\n        private _preventScreenOff: boolean,\n        private _colorTheme: string,\n        private _playSounds: boolean,\n        private _fullScreen: boolean,\n        private _highlightSquares: boolean,\n        private _pieceTheme: string,\n        private _boardTheme: string\n    ) { }\n\n    public serialize() {\n        return {\n            useSyzygy: this._useSyzygy,\n            stockfishDepth: this._stockfishDepth,\n            stockfishMovetime: this._stockfishMovetime,\n            automaticShowFirstPosition: this._automaticShowFirstPosition,\n            preventScreenOff: this._preventScreenOff,\n            colorTheme: this._colorTheme,\n            playSounds: this._playSounds,\n            fullScreen: this._fullScreen,\n            highlightSquares: this._highlightSquares,\n            pieceTheme: this._pieceTheme,\n            boardTheme: this._boardTheme\n        };\n    }\n\n    get configuration(): Configuration { return this; }\n    get configurationChangedEmitter(): EventEmitter<ConfigurationChangedEvent> { return this._configurationChangedEmitter; }\n\n    get useSyzygy(): boolean { return this._useSyzygy; }\n    set useSyzygy(value: boolean) { this._useSyzygy = value; this._configurationChangedEmitter.notify({ config: this, field: 'useSyzygy' }); }\n\n    get stockfishDepth(): number { return this._stockfishDepth; }\n    set stockfishDepth(value: number) { this._stockfishDepth = value; this._configurationChangedEmitter.notify({ config: this, field: 'stockfishDepth' }); }\n\n    get stockfishMovetime(): number { return this._stockfishMovetime; }\n    set stockfishMovetime(value: number) { this._stockfishMovetime = value; this._configurationChangedEmitter.notify({ config: this, field: 'stockfishMovetime' }); }\n\n    get automaticShowFirstPosition(): boolean { return this._automaticShowFirstPosition; }\n    set automaticShowFirstPosition(value: boolean) { this._automaticShowFirstPosition = value; this._configurationChangedEmitter.notify({ config: this, field: 'automaticShowFirstPosition' }); }\n\n    get preventScreenOff(): boolean { return this._preventScreenOff; }\n    set preventScreenOff(value: boolean) { this._preventScreenOff = value; this._configurationChangedEmitter.notify({ config: this, field: 'preventScreenOff' }); }\n\n    get colorTheme(): string { return this._colorTheme; }\n    set colorTheme(value: string) { this._colorTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'colorTheme' }); }\n\n    get playSounds(): boolean { return this._playSounds; }\n    set playSounds(value: boolean) { this._playSounds = value; this._configurationChangedEmitter.notify({ config: this, field: 'playSounds' }); }\n\n    get fullScreen(): boolean { return this._fullScreen; }\n    set fullScreen(value: boolean) { this._fullScreen = value; this._configurationChangedEmitter.notify({ config: this, field: 'fullScreen' }); }\n\n    get highlightSquares(): boolean { return this._highlightSquares; }\n    set highlightSquares(value: boolean) { this._highlightSquares = value; this._configurationChangedEmitter.notify({ config: this, field: 'highlightSquares' }); }\n\n    get pieceTheme(): string { return this._pieceTheme; }\n    set pieceTheme(value: string) { this._pieceTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'pieceTheme' }); }\n\n    get boardTheme(): string { return this._boardTheme; }\n    set boardTheme(value: string) { this._boardTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'boardTheme' }); }\n\n}\n\nexport const DEFAULT_CONFIG = new Configuration(\n    true,\n    15,\n    5,\n    true,\n    true,\n    'dark',\n    true,\n    true,\n    true,\n    PIECE_THEMES[0],\n    BOARD_THEMES[0].name\n);\n","import { Category } from './category';\nimport { endgamedatabaseJson } from '../static';\n\nexport interface EndgameDatabase {\n    version: string;\n    categories: Category[];\n    count: number;\n}\n\nexport const endgameDatabase: EndgameDatabase = <any>endgamedatabaseJson;","import { Drivers, Storage } from '@ionic/storage';\n\nclass StorageService {\n    private store = new Storage({ name: 'CET_STORAGE', driverOrder: [ Drivers.IndexedDB, Drivers.LocalStorage ] });\n\n    public async init(): Promise<any> {\n        return this.store.create();\n    }\n\n    public get(key: string) {\n        return this.store.get(key);\n    }\n    \n    public set(key: string, value: any) {\n        return this.store.set(key, value);\n    }\n    \n    public remove(key: string) {\n        return this.store.remove(key);\n    }\n\n}\n\nexport const storageService = new StorageService();\n","import { Configuration, DEFAULT_CONFIG } from '../model';\nimport { storageService } from './storage-service';\n\nclass ConfigurationService {\n\n    private _configuration!: Configuration;\n\n    get configuration(): Configuration { return this._configuration; }\n\n    constructor() { }\n\n    public init(): Promise<Configuration> {\n        return new Promise<Configuration>(resolve => {\n            storageService.get('CONFIGURATION').then(config => {\n                if (config) {\n                    if (config.useSyzygy === undefined) config.useSyzygy = DEFAULT_CONFIG.useSyzygy;\n                    if (config.stockfishDepth === undefined) config.stockfishDepth = DEFAULT_CONFIG.stockfishDepth;\n                    if (config.stockfishMovetime === undefined) config.stockfishMovetime = DEFAULT_CONFIG.stockfishMovetime;\n                    if (config.automaticShowFirstPosition === undefined) config.automaticShowFirstPosition = DEFAULT_CONFIG.automaticShowFirstPosition;\n                    if (config.preventScreenOff === undefined) config.preventScreenOff = DEFAULT_CONFIG.preventScreenOff;\n                    if (config.colorTheme === undefined) config.colorTheme = DEFAULT_CONFIG.colorTheme;\n                    if (config.playSounds === undefined) config.playSounds = DEFAULT_CONFIG.playSounds;\n                    if (config.fullScreen === undefined) config.fullScreen = DEFAULT_CONFIG.fullScreen;\n                    if (config.highlightSquares === undefined) config.highlightSquares = DEFAULT_CONFIG.highlightSquares;\n                    if (config.pieceTheme === undefined) config.pieceTheme = DEFAULT_CONFIG.pieceTheme;\n                    if (config.boardTheme === undefined) config.boardTheme = DEFAULT_CONFIG.boardTheme;\n                    this._configuration = new Configuration(\n                        config.useSyzygy,\n                        config.stockfishDepth,\n                        config.stockfishMovetime,\n                        config.automaticShowFirstPosition,\n                        config.preventScreenOff,\n                        config.colorTheme,\n                        config.playSounds,\n                        config.fullScreen,\n                        config.highlightSquares,\n                        config.pieceTheme,\n                        config.boardTheme\n                    );\n                    resolve(this._configuration);\n                } else {\n                    this._configuration = DEFAULT_CONFIG;\n                    this.save().then(cfg => {\n                        resolve(cfg);\n                    });\n                }\n            });\n        });\n    }\n\n    public save(): Promise<Configuration> {\n        return storageService.set('CONFIGURATION', this._configuration.serialize());\n    }\n\n}\n\nexport const configurationService = new ConfigurationService();\n","import { THEMES } from '../commons';\nimport { configurationService } from './configuration-service';\n\nclass ThemeSwitcherService {\n\n    public getThemes() {\n        return THEMES;\n    }\n\n    public setTheme(theme: string) {\n        if ('dark' == theme)\n            document.querySelector('html')?.classList.add('ion-theme-dark');\n        else\n            document.querySelector('html')?.classList.remove('ion-theme-dark');\n    }\n\n    public currentTheme() {\n        return document.querySelector('html')?.classList.contains('ion-theme-dark') ? 'dark' : 'light';\n    }\n\n    public init() {\n        this.setTheme(configurationService.configuration.colorTheme);\n    }\n}\n\nexport const themeSwitcherService = new ThemeSwitcherService();\n","import { EndgameDatabase, endgameDatabase } from '../model';\nimport { configurationService } from './configuration-service';\nimport { storageService } from './storage-service';\nimport { EventEmitter, textToImages, urlIcon } from '../commons';\nimport { themeSwitcherService } from './theme-switcher-service';\n\nclass EndgameDatabaseService {\n    private _endgameDatabase!: EndgameDatabase;\n    private _endgameDatabaseChangedEmitter: EventEmitter<EndgameDatabase> = new EventEmitter<EndgameDatabase>();\n\n    get endgameDatabase(): EndgameDatabase { return this._endgameDatabase; }\n    get endgameDatabaseChangedEmitter(): EventEmitter<EndgameDatabase> { return this._endgameDatabaseChangedEmitter; }\n\n    public async init(): Promise<boolean> {\n        return new Promise(resolve => {\n            this.getLocalDatabase().then((localDatabase: EndgameDatabase) => {\n                this._endgameDatabase = this.reconcileDatabases(localDatabase, endgameDatabase);\n                this.enrich(this.endgameDatabase, configurationService.configuration.pieceTheme);\n                configurationService.configuration.configurationChangedEmitter.addEventListener((event) => {\n                    if (event.field == 'pieceTheme') this.enrich(this.endgameDatabase, event.config.pieceTheme);\n                });\n                configurationService.configuration.configurationChangedEmitter.addEventListener((event) => {\n                    switch (event.field) {\n                      case 'pieceTheme': \n                      case 'colorTheme': this.enrich(this.endgameDatabase, event.config.pieceTheme); break;\n                    }\n                  });\n\n                /////////////// TO DO: eliminar esto, es para el sitemap.xml\n                /*\n                this._endgameDatabase.categories.forEach( (category, idxCategory) => {\n                    category.subcategories.forEach((subcategory, idxSubcategory) => {\n                        console.log(`<url><loc>https://server.mydomain.local:5173/chess-endgame-training/list/${idxCategory}/${idxSubcategory}</loc><priority>0.7</priority><changefreq>weekly</changefreq></url>`);\n                        subcategory.games.forEach((_position, idxPosition) => {\n                            console.log(`<url><loc>https://server.mydomain.local:5173/chess-endgame-training/position/${idxCategory}/${idxSubcategory}/${idxPosition}</loc><priority>0.6</priority><changefreq>weekly</changefreq></url>`);\n                        });\n                    });\n                });\n                */\n                //////////////\n                resolve(true);\n            });\n        });\n    }\n\n    private getLocalDatabase(): Promise<EndgameDatabase> {\n        return storageService.get('ENDGAME_DATABASE');\n    }\n\n    private enrich(database: EndgameDatabase, pieceTheme: string) {\n        const color = themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b';\n        database.count = database.categories.length;\n        database.categories.forEach(category => {\n          category.count = category.subcategories.length;\n          category.iconUrls = [];\n          category.icons.forEach(icon => category.iconUrls.push(urlIcon(`${color}${icon}`, pieceTheme)));\n          category.subcategories.forEach(subcategory => {\n            subcategory.count = subcategory.games.length;\n            subcategory.images = textToImages(subcategory.name);\n            subcategory.imageUrls = [];\n            subcategory.images.forEach(image => subcategory.imageUrls.push(urlIcon(image, pieceTheme)));\n          });\n        });\n        this._endgameDatabaseChangedEmitter.notify(database);\n    }\n\n    private reconcileDatabases(localDatabase: EndgameDatabase, defaultDatabase: EndgameDatabase): EndgameDatabase {\n        if (!localDatabase) {\n            storageService.set('ENDGAME_DATABASE', defaultDatabase);\n            return defaultDatabase;\n        }\n        if (localDatabase.version && localDatabase.version === defaultDatabase.version) {\n            return localDatabase;\n        }\n        // recover records\n        defaultDatabase.categories.forEach(category => {\n            category.subcategories.forEach(subcategory => {\n                subcategory.games.forEach(game => {\n                    const localCategory = localDatabase.categories.find(x => x.name === category.name);\n                    if (localCategory) {\n                        const localSubcategory = localCategory.subcategories.find(x => x.name === subcategory.name);\n                        if (localSubcategory) {\n                            const localGame = localSubcategory.games.find(x => x.fen === game.fen);\n                            if (localGame && localGame.record) {\n                                game.record = localGame.record;\n                            }\n                        }\n                    }\n                });\n            });\n        });\n        storageService.set('ENDGAME_DATABASE', defaultDatabase);\n        return defaultDatabase;\n    }\n}\n\nexport const endgameDatabaseService = new EndgameDatabaseService();","import { initialize } from '@ionic/core/components';\n\n// import { IonAccordionGroup } from '@ionic/core/components/ion-accordion-group';\n// import { IonAccordion } from '@ionic/core/components/ion-accordion';\n// import { IonActionSheet } from '@ionic/core/components/ion-action-sheet';\nimport { IonAlert } from '@ionic/core/components/ion-alert';\nimport { IonApp } from '@ionic/core/components/ion-app';\n// import { IonAvatar } from '@ionic/core/components/ion-avatar';\n//import { IonBackButton } from '@ionic/core/components/ion-back-button';\n// import { IonBackdrop } from '@ionic/core/components/ion-backdrop';\n// import { IonBadge } from '@ionic/core/components/ion-badge';\n// import { IonBreadcrumb } from '@ionic/core/components/ion-breadcrumb';\n// import { IonBreadcrumbs } from '@ionic/core/components/ion-breadcrumbs';\nimport { IonButton } from '@ionic/core/components/ion-button';\nimport { IonButtons } from '@ionic/core/components/ion-buttons';\nimport { IonCardContent } from '@ionic/core/components/ion-card-content';\nimport { IonCardHeader } from '@ionic/core/components/ion-card-header';\nimport { IonCard } from '@ionic/core/components/ion-card';\n//import { IonCardSubtitle } from '@ionic/core/components/ion-card-subtitle';\nimport { IonCardTitle } from '@ionic/core/components/ion-card-title';\n//import { IonCheckbox } from '@ionic/core/components/ion-checkbox';\n// import { IonChip } from '@ionic/core/components/ion-chip';\nimport { IonCol } from '@ionic/core/components/ion-col';\nimport { IonContent } from '@ionic/core/components/ion-content';\n// import { IonDatetime } from '@ionic/core/components/ion-datetime';\nimport { IonFabButton } from '@ionic/core/components/ion-fab-button';\nimport { IonFab } from '@ionic/core/components/ion-fab';\nimport { IonFabList } from '@ionic/core/components/ion-fab-list';\nimport { IonFooter } from '@ionic/core/components/ion-footer';\nimport { IonGrid } from '@ionic/core/components/ion-grid';\nimport { IonHeader } from '@ionic/core/components/ion-header';\nimport { IonIcon } from '@ionic/core/components/ion-icon';\n// import { IonImg } from '@ionic/core/components/ion-img';\n// import { IonInfiniteScrollContent } from '@ionic/core/components/ion-infinite-scroll-content';\n// import { IonInfiniteScroll } from '@ionic/core/components/ion-infinite-scroll';\n//import { IonInput } from '@ionic/core/components/ion-input';\n// import { IonItemDivider } from '@ionic/core/components/ion-item-divider';\n// import { IonItemGroup } from '@ionic/core/components/ion-item-group';\nimport { IonItem } from '@ionic/core/components/ion-item';\n// import { IonItemOption } from '@ionic/core/components/ion-item-option';\n// import { IonItemOptions } from '@ionic/core/components/ion-item-options';\n// import { IonItemSliding } from '@ionic/core/components/ion-item-sliding';\nimport { IonLabel } from '@ionic/core/components/ion-label';\n//import { IonListHeader } from '@ionic/core/components/ion-list-header';\nimport { IonList } from '@ionic/core/components/ion-list';\n// import { IonLoading } from '@ionic/core/components/ion-loading';\nimport { IonMenuButton } from '@ionic/core/components/ion-menu-button';\nimport { IonMenu } from '@ionic/core/components/ion-menu';\nimport { IonMenuToggle } from '@ionic/core/components/ion-menu-toggle';\nimport { IonModal } from '@ionic/core/components/ion-modal';\n// import { IonNav } from '@ionic/core/components/ion-nav';\n// import { IonNavLink } from '@ionic/core/components/ion-nav-link';\n// import { IonNote } from '@ionic/core/components/ion-note';\n// import { IonPickerColumnInternal } from '@ionic/core/components/ion-picker-column-internal';\n// import { IonPickerColumn } from '@ionic/core/components/ion-picker-column';\n// import { IonPickerInternal } from '@ionic/core/components/ion-picker-internal';\n// import { IonPicker } from '@ionic/core/components/ion-picker';\n// import { IonPopover } from '@ionic/core/components/ion-popover';\n// import { IonProgressBar } from '@ionic/core/components/ion-progress-bar';\n// import { IonRadioGroup } from '@ionic/core/components/ion-radio-group';\n// import { IonRadio } from '@ionic/core/components/ion-radio';\nimport { IonRange } from '@ionic/core/components/ion-range';\n// import { IonRefresherContent } from '@ionic/core/components/ion-refresher-content';\n// import { IonRefresher } from '@ionic/core/components/ion-refresher';\n//import { IonReorderGroup } from '@ionic/core/components/ion-reorder-group';\n//import { IonReorder } from '@ionic/core/components/ion-reorder';\nimport { IonRippleEffect } from '@ionic/core/components/ion-ripple-effect';\n// import { IonRoute } from '@ionic/core/components/ion-route';\n// import { IonRouteRedirect } from '@ionic/core/components/ion-route-redirect';\n// import { IonRouter } from '@ionic/core/components/ion-router';\nimport { IonRouterLink } from '@ionic/core/components/ion-router-link';\nimport { IonRouterOutlet } from '@ionic/core/components/ion-router-outlet';\nimport { IonRow } from '@ionic/core/components/ion-row';\n// import { IonSearchbar } from '@ionic/core/components/ion-searchbar';\nimport { IonSegmentButton } from '@ionic/core/components/ion-segment-button';\nimport { IonSegment } from '@ionic/core/components/ion-segment';\n//import { IonSelect } from '@ionic/core/components/ion-select';\n//import { IonSelectOption } from '@ionic/core/components/ion-select-option';\n// import { IonSelectPopover } from '@ionic/core/components/ion-select-popover';\n// import { IonSkeletonText } from '@ionic/core/components/ion-skeleton-text';\n// import { IonSlide } from '@ionic/core/components/ion-slide';\n// import { IonSlides } from '@ionic/core/components/ion-slides';\nimport { IonSpinner } from '@ionic/core/components/ion-spinner';\nimport { IonSplitPane } from '@ionic/core/components/ion-split-pane';\n// import { IonTabBar } from '@ionic/core/components/ion-tab-bar';\n// import { IonTabButton } from '@ionic/core/components/ion-tab-button';\n// import { IonTab } from '@ionic/core/components/ion-tab';\n// import { IonTabs } from '@ionic/core/components/ion-tabs';\n//import { IonTextarea } from '@ionic/core/components/ion-textarea';\n//import { IonText } from '@ionic/core/components/ion-text';\n// import { IonThumbnail } from '@ionic/core/components/ion-thumbnail';\nimport { IonTitle } from '@ionic/core/components/ion-title';\nimport { IonToast } from '@ionic/core/components/ion-toast';\nimport { IonToggle } from '@ionic/core/components/ion-toggle';\nimport { IonToolbar } from '@ionic/core/components/ion-toolbar';\n// import { IonVirtualScroll } from '@ionic/core/components/ion-virtual-scroll';\n\ndocument.documentElement.classList.add('ion-ce');\n\nfunction tryDefine(impl: CustomElementConstructor, tag: string) {\n  try {\n    customElements.define(tag, impl);\n  } catch (error) {}\n}\n\ninitialize(/*{mode:'ios'}*/);\n\n// tryDefine(IonAccordionGroup, 'ion-accordion-group');\n// tryDefine(IonAccordion, 'ion-accordion');\n// tryDefine(IonActionSheet, 'ion-action-sheet');\ntryDefine(IonAlert, 'ion-alert');\ntryDefine(IonApp, 'ion-app');\n// tryDefine(IonAvatar, 'ion-avatar');\n//tryDefine(IonBackButton, 'ion-back-button');\n// tryDefine(IonBackdrop, 'ion-backdrop');\n// tryDefine(IonBadge, 'ion-badge');\n// tryDefine(IonBreadcrumb, 'ion-breadcrumb');\n// tryDefine(IonBreadcrumbs, 'ion-breadcrumbs');\ntryDefine(IonButton, 'ion-button');\ntryDefine(IonButtons, 'ion-buttons');\ntryDefine(IonCardContent, 'ion-card-content');\ntryDefine(IonCardHeader, 'ion-card-header');\ntryDefine(IonCard, 'ion-card');\n//tryDefine(IonCardSubtitle, 'ion-card-subtitle');\ntryDefine(IonCardTitle, 'ion-card-title');\n//tryDefine(IonCheckbox, 'ion-checkbox');\n// tryDefine(IonChip, 'ion-chip');\ntryDefine(IonCol, 'ion-col');\ntryDefine(IonContent, 'ion-content');\n// tryDefine(IonDatetime, 'ion-datetime');\ntryDefine(IonFabButton, 'ion-fab-button');\ntryDefine(IonFab, 'ion-fab');\ntryDefine(IonFabList, 'ion-fab-list');\ntryDefine(IonFooter, 'ion-footer');\ntryDefine(IonGrid, 'ion-grid');\ntryDefine(IonHeader, 'ion-header');\ntryDefine(IonIcon, 'ion-icon');\n// tryDefine(IonImg, 'ion-img');\n// tryDefine(IonInfiniteScrollContent, 'ion-infinite-scroll-content');\n// tryDefine(IonInfiniteScroll, 'ion-infinite-scroll');\n//tryDefine(IonInput, 'ion-input');\n// tryDefine(IonItemDivider, 'ion-item-divider');\n// tryDefine(IonItemGroup, 'ion-item-group');\ntryDefine(IonItem, 'ion-item');\n// tryDefine(IonItemOption, 'ion-item-option');\n// tryDefine(IonItemOptions, 'ion-item-options');\n// tryDefine(IonItemSliding, 'ion-item-sliding');\ntryDefine(IonLabel, 'ion-label');\n//tryDefine(IonListHeader, 'ion-list-header');\ntryDefine(IonList, 'ion-list');\n// tryDefine(IonLoading, 'ion-loading');\ntryDefine(IonMenuButton, 'ion-menu-button');\ntryDefine(IonMenu, 'ion-menu');\ntryDefine(IonMenuToggle, 'ion-menu-toggle');\ntryDefine(IonModal, 'ion-modal');\n// tryDefine(IonNav, 'ion-nav');\n// tryDefine(IonNavLink, 'ion-nav-link');\n// tryDefine(IonNote, 'ion-note');\n// tryDefine(IonPickerColumnInternal, 'ion-picker-column-internal');\n// tryDefine(IonPickerColumn, 'ion-picker-column');\n// tryDefine(IonPickerInternal, 'ion-picker-internal');\n// tryDefine(IonPicker, 'ion-picker');\n// tryDefine(IonPopover, 'ion-popover');\n// tryDefine(IonProgressBar, 'ion-progress-bar');\n// tryDefine(IonRadioGroup, 'ion-radio-group');\n// tryDefine(IonRadio, 'ion-radio');\ntryDefine(IonRange, 'ion-range');\n// tryDefine(IonRefresherContent, 'ion-refresher-content');\n// tryDefine(IonRefresher, 'ion-refresher');\n//tryDefine(IonReorderGroup, 'ion-reorder-group');\n//tryDefine(IonReorder, 'ion-reorder');\ntryDefine(IonRippleEffect, 'ion-ripple-effect');\n// tryDefine(IonRoute, 'ion-route');\n// tryDefine(IonRouteRedirect, 'ion-route-redirect');\n// tryDefine(IonRouter, 'ion-router');\ntryDefine(IonRouterLink, 'ion-router-link');\ntryDefine(IonRouterOutlet, 'ion-router-outlet');\ntryDefine(IonRow, 'ion-row');\n// tryDefine(IonSearchbar, 'ion-searchbar');\ntryDefine(IonSegmentButton, 'ion-segment-button');\ntryDefine(IonSegment, 'ion-segment');\n//tryDefine(IonSelect, 'ion-select');\n//tryDefine(IonSelectOption, 'ion-select-option');\n// tryDefine(IonSelectPopover, 'ion-select-popover');\n// tryDefine(IonSkeletonText, 'ion-skeleton-text');\n// tryDefine(IonSlide, 'ion-slide');\n// tryDefine(IonSlides, 'ion-slides');\ntryDefine(IonSpinner, 'ion-spinner');\ntryDefine(IonSplitPane, 'ion-split-pane');\n// tryDefine(IonTabBar, 'ion-tab-bar');\n// tryDefine(IonTabButton, 'ion-tab-button');\n// tryDefine(IonTab, 'ion-tab');\n// tryDefine(IonTabs, 'ion-tabs');\n//tryDefine(IonTextarea, 'ion-textarea');\n//tryDefine(IonText, 'ion-text');\n// tryDefine(IonThumbnail, 'ion-thumbnail');\ntryDefine(IonTitle, 'ion-title');\ntryDefine(IonToast, 'ion-toast');\ntryDefine(IonToggle, 'ion-toggle');\ntryDefine(IonToolbar, 'ion-toolbar');\n// tryDefine(IonVirtualScroll, 'ion-virtual-scroll');\n\nconst images = import.meta.glob('/node_modules/@ionic/core/dist/ionic/svg/(close|home-sharp|information-circle|settings-sharp|save|caret-down|caret-forward|caret-up|arrow-back|arrow-forward|power|swap-vertical|arrow-undo|bulb|color-wand|flag|stop|trash).svg', { as: 'url' });\nexport const redrawIconImages = () => {\n  requestAnimationFrame(() => {\n    document.querySelectorAll('ion-icon').forEach((el) => {\n      const name = el.getAttribute('data-name');\n      if (name != null) {\n        images[`/node_modules/@ionic/core/dist/ionic/svg/${name}.svg`]().then((url: string) => {\n          el.src = url;\n        });\n      }\n    });\n  });\n};\n","\nimport Navigo from 'navigo';\nimport { MenuI, menuController, modalController } from '@ionic/core';\nimport { Controller } from '../controllers';\nimport { MAIN_MENU_ID, setupSEO } from '../commons';\nimport { redrawIconImages } from './ionic';\n\ninterface RouteItem {\n    path: string;\n    template: string;\n    tag: string;\n    controller: Controller;\n    hasParams: boolean;\n}\n\ninterface RouteMap {\n    hash: boolean,\n    mainRoute: RouteItem;\n    routes: RouteItem[];\n}\n\nclass RouteService {\n\n    private navigo!: Navigo;\n    private menuRegistered = false;\n    private templates = new Map<string, string>();\n    \n    private closeMenu = (menuId: string) => {\n        if (!this.menuRegistered) {\n            const query = \"ion-menu[menu-id='\" + menuId + \"']\";\n            const menu = document.querySelector(query) as unknown as MenuI;\n            if (!menu) return;\n            menuController._register(menu);\n            this.menuRegistered = true;\n        }\n        menuController.close(menuId);\n    }\n\n    private openRoute = (navigo: Navigo, template: string, targetElementSelector: string, controller: Controller, params?: any): Promise<void> => {\n        this.closeMenu(MAIN_MENU_ID);\n        return new Promise<void>(resolve => {\n            const targetElement = document.querySelector(targetElementSelector);\n            if (targetElement) {\n                const elementObserver = new MutationObserver((mutations) => {\n                    mutations.forEach((_mutation) => {\n                        if (controller) {\n                            elementObserver.disconnect();\n                            redrawIconImages();\n                            navigo.updatePageLinks();\n                            resolve();\n                        }\n                    });\n                });\n                elementObserver.observe(targetElement, { childList: true });\n                controller.onEnter(params);\n                const content = this.templates.get(template);\n                if (content) {\n                    targetElement.innerHTML = content;\n                    setupSEO(template, controller.getSEOParams());\n                } else {\n                    fetch(template)\n                        .then(response => response.text()\n                            .then(content => {\n                                this.templates.set(template, content);\n                                targetElement.innerHTML = content;\n                                setupSEO(template, controller.getSEOParams());\n                                redrawIconImages();\n                            }));\n                }\n            }\n        });\n    }\n\n    private open(routeItem: RouteItem): (params?: any) => Promise<void> {\n        if (routeItem.hasParams) {\n            return (params: any) => this.openRoute(this.navigo, routeItem.template, routeItem.tag, routeItem.controller, params);\n        } else {\n            return () => this.openRoute(this.navigo, routeItem.template, routeItem.tag, routeItem.controller);\n        }\n    }\n\n    public openModal(xData: string, template: string, controller: Controller, pageMode: boolean, autoHeight: boolean, info?: any): Promise<any> {\n        const element = document.createElement('div');\n        element.setAttribute('x-data', xData);\n        const content = this.templates.get(template);\n        if (content) {\n            element.innerHTML = content;\n            return this.innerOpenModal(element, controller, pageMode, autoHeight, info);\n        } else {\n            return fetch(template)\n                .then(response => response.text()\n                    .then(async content => {\n                        this.templates.set(template, content);\n                        element.innerHTML = content;\n                        return this.innerOpenModal(element, controller, pageMode, autoHeight, info);\n                    }));\n        }\n    }\n\n    private async innerOpenModal(component: HTMLElement, controller: Controller, pageMode: boolean, autoHeight: boolean, info?: any): Promise<any> {\n        const modal = await modalController.create({ component: component });\n        if (autoHeight) modal.style.setProperty('--height', 'auto');\n        if (info) controller.setInfo(info);\n        controller.onEnter(info);\n        modal.present().then(() => { redrawIconImages(); });\n        // remove ion-page class on the next tick, when the DOM of the modal has been loaded\n        if (!pageMode) {\n            requestAnimationFrame(() => {\n                if (!pageMode) component.classList.remove('ion-page');\n            });\n        }\n        const { data } = await modal.onDidDismiss();\n        return data;\n    }\n\n    public updatePageLinks() {\n        this.navigo.updatePageLinks();\n    }\n\n    public init(routeMap: RouteMap) {\n        this.navigo = new Navigo(routeMap.mainRoute.path, { hash: routeMap.hash });\n        const mainRoute = this.open(routeMap.mainRoute);\n        routeMap.routes.forEach((route) => {\n            const oRoute = this.open(route);\n            if (route.hasParams) {\n                this.navigo.on(route.path, (info: any) => {\n                    document.querySelector(route.tag) ? oRoute(info.data) : mainRoute().then(() => oRoute(info.data));\n                }, {\n                    leave(done, _match) {\n                        route.controller.onExit().then((canExit: boolean) => done(canExit));\n                    }\n                });\n            } else {\n                this.navigo.on(route.path, () => {\n                    document.querySelector(route.tag) ? oRoute() : mainRoute().then(() => oRoute());\n                }, {\n                    leave(done, _match) {\n                        route.controller.onExit().then((canExit: boolean) => done(canExit));\n                    }\n                });\n            }\n        });\n        this.navigo.resolve();\n    }\n}\n\nexport const routeService = new RouteService();","import { BOARD_THEMES } from '../commons';\nimport { configurationService } from './configuration-service';\n\nclass BoardThemeSwitcherService {\n\n    public getThemes() {\n        return BOARD_THEMES;\n    }\n\n    public setTheme(theme: string) {\n        const themeDefinition = BOARD_THEMES.find(item => item.name == theme);\n        if (themeDefinition) themeDefinition.styles.forEach(style => {\n            document.documentElement.style.setProperty(style.themeVariable, style.value);\n          });\n    }\n\n    public currentTheme() {\n        return configurationService.configuration.boardTheme;\n    }\n\n    public init() {\n        this.setTheme(this.currentTheme());\n    }\n}\n\nexport const boardThemeSwitcherService = new BoardThemeSwitcherService();\n","class SyzygyService {\n   \n    public async init(): Promise<any> {\n\n    }\n\n    public get(fen: string): Promise<Response> {\n        return fetch(`https://tablebase.lichess.ovh/standard?fen=${fen}`, {\n            method: 'GET',\n            cache: 'force-cache'\n        });\n\n    }\n}\n\nexport const syzygyService = new SyzygyService();\n","import { EventEmitter } from '../commons';\n\ndeclare var WebAssembly: any;\n\nclass StockfishService {\n\n    private stockfish: any;\n    private _version!: string;\n    private _messageEmitter: EventEmitter<string> = new EventEmitter<string>();\n\n    constructor() { }\n\n    get version(): string { return this._version; }\n    get messageEmitter(): EventEmitter<string> { return this._messageEmitter; }\n\n    public postMessage(message: string) {\n        this.stockfish.postMessage(message);\n    }\n\n    private initStockfish(engineUrl: string, nnue: boolean) {\n        const self = this;\n        this.stockfish = new Worker(engineUrl);\n        this.stockfish.addEventListener('message', function (event: MessageEvent<string>) {\n            self._messageEmitter.notify(event.data);\n        });\n        this.stockfish.postMessage('uci');\n        if (nnue) this.stockfish.postMessage('setoption name Use NNUE value true');\n    }\n\n    private async initStockfishNnue16() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16.js#stockfish-nnue-16.wasm', true);\n    }\n\n    private initStockfishNnue16NoSimd() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16-no-simd.js#stockfish-nnue-16-no-simd.wasm', true);\n    }\n\n    private initStockfishNnue16Single() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16-single.js#stockfish-nnue-16-single.wasm', true);\n    }\n\n    private initStockfishJs() {\n        this.initStockfish('assets/stockfish/stockfish.asm.js', false);\n    }\n\n    private sharedMemoryTest(): boolean {\n        if (typeof Atomics !== 'object') return false;\n        if (typeof SharedArrayBuffer !== 'function') return false;\n        let mem;\n        try {\n            mem = new WebAssembly.Memory({ shared: true, initial: 1, maximum: 2 });\n            if (!(mem.buffer instanceof SharedArrayBuffer)) return false;\n\n            window.postMessage(mem.buffer, '*');\n        } catch (_) {\n            return false;\n        }\n        return mem.buffer instanceof SharedArrayBuffer;\n    }\n\n    private detectFeatures(): string[] {\n        const result: string[] = [];\n        if (typeof WebAssembly === 'object' &&\n            typeof WebAssembly.validate === 'function' &&\n            WebAssembly.validate(Uint8Array.from([0, 97, 115, 109, 1, 0, 0, 0]))) {\n            result.push('wasm');\n            if (this.sharedMemoryTest()) {\n                result.push('sharedMem');\n                // i32x4.dot_i16x8_s, i32x4.trunc_sat_f64x2_u_zero\n                const sourceWithSimd = Uint8Array.from([0, 97, 115, 109, 1, 0, 0, 0, 1, 12, 2, 96, 2, 123, 123, 1, 123, 96, 1, 123, 1, 123, 3, 3, 2, 0, 1, 7, 9, 2, 1, 97, 0, 0, 1, 98, 0, 1, 10, 19, 2, 9, 0, 32, 0, 32, 1, 253, 186, 1, 11, 7, 0, 32, 0, 253, 253, 1, 11]); // prettier-ignore\n                if (WebAssembly.validate(sourceWithSimd)) result.push('simd');\n            }\n        }\n        return result;\n    }\n\n    public init(): Promise<boolean> {\n        return new Promise(resolve => {\n            const stockfishListener = (message: string) => {\n                if (!this._version) this._version = message;\n                console.log(message);\n                if ('uciok' == message) {\n                    //this._messageEmitter.removeEventListener(stockfishListener);\n                    resolve(true);\n                }\n            }\n            this._messageEmitter.addEventListener(stockfishListener);\n            const features = this.detectFeatures();\n            if (features.includes(\"simd\"))\n                this.initStockfishNnue16();\n            else if (features.includes(\"sharedMem\")) {\n                this.initStockfishNnue16NoSimd();\n            } else if (features.includes(\"wasm\")) {\n                this.initStockfishNnue16Single();\n            } else {\n                this.initStockfishJs();\n            }\n        });\n    }\n\n}\n\nexport const stockfishService = new StockfishService();\n","import { Howl } from 'howler';\n\nimport { configurationService } from './configuration-service';\nimport { soundJson } from '../static';\n\ntype SOUND_ITEM = {\n    key: string,\n    audio: Howl\n}\n\nclass SoundService {\n\n    private sounds: SOUND_ITEM[] = [];\n\n    public playAudio(sound: string) {\n        if (configurationService.configuration.playSounds) {\n            const soundToPlay = this.sounds.find((item) => { return item.key === sound; });\n            if (soundToPlay && (sound !== 'fail' || !soundToPlay.audio.playing())) {\n                soundToPlay.audio.play();\n            }\n        }\n    }\n\n    public init() {\n        soundJson.sounds.forEach(item => this.sounds.push({ key: item.key, audio: new Howl({ src: [item.audio] }) }))\n    }\n}\n\nexport const soundService = new SoundService();\n","import AlpineI18n from 'alpinejs-i18n';\nimport Alpine, { DirectiveData, DirectiveUtilities, ElementWithXAttributes } from 'alpinejs';\nimport { i18nJson } from '../static';\n\n// https://github.dev/bennadel/JavaScript-Demos/tree/master/demos/json-explorer-alpine3\nfunction TemplateOutletDirective(element: ElementWithXAttributes, metadata: DirectiveData, framework: DirectiveUtilities): void {\n\n    // Get the template reference that we want to clone and render.\n    var templateRef = framework.evaluate(metadata.expression);\n\n    // Clone the template and get the root node - this is the node that we will\n    // inject into the DOM.\n    // @ts-ignore\n    var clone = templateRef.content\n        .cloneNode(true)\n        .firstElementChild\n        ;\n\n    // For the clone, all I need to do at the moment is copy the datastack from the\n    // template over to the clone. This way, even if the template doesn't have an \"x-data\"\n    // attribute, I'll still have the right stack.\n    clone._x_dataStack = Alpine.closestDataStack(element);\n\n    // Instead of leaving the template in the DOM, we're going to swap the\n    // template with a comment hook. This isn't necessary; but, I think it leaves\n    // the DOM more pleasant looking.\n    var domHook = document.createComment(` Template outlet hook (${metadata.expression}) with bindings (${element.getAttribute(\"x-data\")}). `);\n    // @ts-ignore\n    domHook._template_outlet_ref = templateRef;\n    // @ts-ignore\n    domHook._template_outlet_clone = clone;\n\n    // Swap the template-outlet element with the hook and clone.\n    // --\n    // NOTE: Doing this inside the mutateDom() method will pause Alpine's internal\n    // MutationObserver, which allows us to perform DOM manipulation without\n    // triggering actions in the framework. Then, we can call initTree() and\n    // destroyTree() to have explicitly setup and teardowm DOM node bindings.\n    Alpine.mutateDom(\n        function pauseMutationObserver() {\n            element.after(domHook);\n            domHook.after(clone);\n            Alpine.initTree(clone);\n            element.remove();\n            Alpine.destroyTree(element);\n        }\n    );\n}\n\nclass AlpineService {\n\n    private hideLoader() {\n        const loaderContainer = document.querySelector('.loader-container');\n        if (loaderContainer) { loaderContainer.remove(); }\n    }\n\n    private startup() {\n        document.addEventListener('alpine:init', () => {\n            Alpine.directive(\"template-outlet\", TemplateOutletDirective);\n        });\n    }\n\n    private i18n() {\n        document.addEventListener('alpine-i18n:ready', () => {\n            const browserLang = navigator.language;\n            let candidate = '';\n            let created = false;\n            Object.keys(i18nJson).forEach((key) => {\n                if (!window.AlpineI18n.fallbackLocale) {\n                    window.AlpineI18n.fallbackLocale = key;\n                }\n                if (!created) {\n                    if (key == browserLang) {\n                        window.AlpineI18n.create(key, i18nJson);\n                        created = true;\n                        document.documentElement.lang = key;\n                    } else if (!candidate && browserLang.startsWith(key)) {\n                        candidate = key;\n                    }\n                }\n            });\n            if (!created) {\n                if (candidate) {\n                    window.AlpineI18n.create(candidate, i18nJson);\n                    document.documentElement.lang = candidate;\n                } else {\n                    window.AlpineI18n.create(window.AlpineI18n.fallbackLocale, i18nJson);\n                    document.documentElement.lang = window.AlpineI18n.fallbackLocale;\n                }\n            }\n        });\n    }\n\n    public init() {\n        this.startup();\n        this.i18n();\n        Alpine.plugin(AlpineI18n);\n        Alpine.start();\n        this.hideLoader();\n    }\n\n}\n\nexport const alpineService = new AlpineService();\n","import './ionic';\nimport { storageService } from './storage-service';\nimport { configurationService } from './configuration-service';\nimport { endgameDatabaseService } from './endgame-database-service';\nimport { alpineService } from './alpine-service';\nimport { themeSwitcherService } from './theme-switcher-service';\nimport { boardThemeSwitcherService } from './board-theme-switcher-service';\nimport { syzygyService } from './syzygy-service';\nimport { stockfishService } from './stockfish-service';\nimport { soundService } from './sound-service';\n\nexport function services_initialize() {\n    return storageService.init()\n        .then(() => configurationService.init())\n        .then(() => stockfishService.init())\n        .then(() => syzygyService.init())\n        .then(() => soundService.init())\n        .then(() => themeSwitcherService.init())\n        .then(() => boardThemeSwitcherService.init())\n        .then(() => endgameDatabaseService.init())\n        .then(() => alpineService.init())\n        ;\n\n}\n","export interface Controller {\n    setInfo(info: any): void;\n    getSEOParams(): any;\n    onEnter($routeParams?: any): void;\n    onExit(): Promise<boolean>;\n}\n\nexport class BaseController implements Controller {\n    setInfo(_info: any) {\n    }\n    getSEOParams(): any {\n        return {};\n    }\n    onEnter(_$routeParams?: any): void {\n    }\n    onExit(): Promise<boolean> {\n        return new Promise<boolean>(resolve => { resolve(true); });\n    }\n}\n\nexport const dummyController = new BaseController();","import Alpine from 'alpinejs';\nimport { version } from '../../package.json';\nimport { BaseController } from './controller';\nimport { aboutJson } from '../static';\nimport { stockfishService } from '../services';\n\nclass AboutController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info', () => ({\n            version: version,\n            items: aboutJson.items.map(item => { return {url: item.url, text: window.AlpineI18n.t(item.i18n, {'stockfishRunningVersion': stockfishService.version}) } })\n        }));\n    }\n}\n\nexport const aboutController = new AboutController();\n","import { PIECE_THEMES, BOARD_THEMES } from '../commons';\nimport { redrawIconImages, themeSwitcherService, configurationService, boardThemeSwitcherService } from '../services';\nimport { BaseController } from './controller';\nimport Alpine from 'alpinejs';\nimport { toastController } from '@ionic/core';\nimport { IonModal } from '@ionic/core/components/ion-modal';\nimport { IonToggle } from '@ionic/core/components/ion-toggle';\nimport { IonRange } from '@ionic/core/components/ion-range';\n\nclass SettingsController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n\n        Alpine.data('settings', () => ({\n            color: themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b',\n            // theme\n            showThemes: false,\n            themes: themeSwitcherService.getThemes(),\n            currentTheme() {\n                return configurationService.configuration.colorTheme;\n            },\n            toggleThemes() {\n                this.showThemes = !this.showThemes;\n                this.showPieceThemes = false;\n                this.showBoardThemes = false;\n            },\n            setTheme(theme: string) {\n                themeSwitcherService.setTheme(theme);\n                configurationService.configuration.colorTheme = theme;\n                this.color = themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b';\n            },\n            // piece theme\n            showPieceThemes: false,\n            pieceThemes: PIECE_THEMES,\n            currentPieceTheme: configurationService.configuration.pieceTheme,\n            togglePieceThemes() {\n                this.showPieceThemes = !this.showPieceThemes;\n                this.showThemes = false;\n                this.showBoardThemes = false;\n            },\n            setPieceTheme(pieceTheme: string) {\n                this.currentPieceTheme = pieceTheme;\n                configurationService.configuration.pieceTheme = pieceTheme;\n            },\n            // board theme\n            showBoardThemes: false,\n            boardThemes: BOARD_THEMES,\n            currentBoardTheme: configurationService.configuration.boardTheme,\n            toggleBoardThemes() {\n                this.showBoardThemes = !this.showBoardThemes;\n                this.showThemes = false;\n                this.showPieceThemes = false;\n\n            },\n            setBoardTheme(boardTheme: string) {\n                this.currentBoardTheme = boardTheme;\n                configurationService.configuration.boardTheme = boardTheme;\n                boardThemeSwitcherService.setTheme(boardTheme);\n            },\n            // play sounds\n            playSounds: configurationService.configuration.playSounds,\n            playSoundsChanged(checked: boolean) {\n                this.playSounds = checked;\n                configurationService.configuration.playSounds = checked;\n            },\n            // highlight squares\n            highlightSquares: configurationService.configuration.highlightSquares,\n            highlightSquaresChanged(checked: boolean) {\n                this.highlightSquares = checked;\n                configurationService.configuration.highlightSquares = checked;\n            },\n            // use syzygy\n            useSyzygy: configurationService.configuration.useSyzygy,\n            useSyzygyChanged(checked: boolean) {\n                this.useSyzygy = checked;\n                configurationService.configuration.useSyzygy = checked;\n            },\n            // stockfish depth\n            currentStockfishDepth: configurationService.configuration.stockfishDepth,\n            changeStockfishDepth(value: number) {\n                this.currentStockfishDepth = value;\n                configurationService.configuration.stockfishDepth = value;  \n            },\n            // stockfish movetime\n            currentStockfishMovetime: configurationService.configuration.stockfishMovetime,\n            changeStockfishMovetime(value: number) {\n                this.currentStockfishMovetime = value;\n                configurationService.configuration.stockfishMovetime = value;  \n            },\n            // save settings\n            save() {\n                configurationService.save().then(async () => {\n                    const toast = await toastController.create({\n                        message: window.AlpineI18n.t('settings.changes-saved'),\n                        position: 'middle',\n                        color: 'success',\n                        duration: 1000\n                    });\n                    toast.present();\n                    this.close();\n                });\n            },\n            close() {\n                (document.querySelector('ion-modal') as IonModal).dismiss();\n            },\n            init() {\n                const toggleHighlightSquares = document.getElementById('toggleHighlightSquares') as IonToggle;\n                toggleHighlightSquares.addEventListener('ionChange', () => { this.highlightSquaresChanged(toggleHighlightSquares.checked); });\n                \n                const togglePlaySounds = document.getElementById('togglePlaySounds') as IonToggle;\n                togglePlaySounds.addEventListener('ionChange', () => { this.playSoundsChanged(togglePlaySounds.checked); });\n                \n                const toggleUseSyzygy = document.getElementById('toggleUseSyzygy') as IonToggle;\n                toggleUseSyzygy.addEventListener('ionChange', () => { this.useSyzygyChanged(toggleUseSyzygy.checked); });\n          \n                const stockfishDepthRange = document.getElementById('stockfishDepthRange') as IonRange;\n                stockfishDepthRange.value = configurationService.configuration.stockfishDepth;\n                stockfishDepthRange.addEventListener('ionChange', () => {\n                    if (typeof stockfishDepthRange.value ===  'number') this.changeStockfishDepth(stockfishDepthRange.value);\n                });\n\n                const stockfishMovetimeRange = document.getElementById('stockfishMovetimeRange') as IonRange;\n                stockfishMovetimeRange.value = configurationService.configuration.stockfishMovetime;\n                stockfishMovetimeRange.addEventListener('ionChange', () => {\n                    if (typeof stockfishMovetimeRange.value ===  'number') this.changeStockfishMovetime(stockfishMovetimeRange.value);\n                });\n\n                ['showThemes', 'showPieceThemes', 'showBoardThemes'].forEach((item) => {\n                    this.$watch(item, (_value) => {\n                        redrawIconImages();\n                    });\n                });\n            }\n        }));\n    }\n}\n\nexport const settingsController = new SettingsController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService, redrawIconImages, routeService } from '../services';\nimport { EndgameDatabase } from '../model';\nimport { ariaDescriptionFromIcon, clone } from '../commons';\nimport { settingsController } from './settings';\n\nclass AppController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info',  () => ({\n            categories: clone(endgameDatabaseService.endgameDatabase.categories),\n            categorySelected: '',\n            selectCategory(category: string) {\n                if (this.categorySelected != category) {\n                    this.categorySelected = category;\n                    this.$nextTick().then(() => { routeService.updatePageLinks(); });\n                } else {\n                    this.categorySelected = '';\n                }\n            },\n            ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n            showSettings() {\n                routeService.openModal('settings', 'settings.html', settingsController, true, false);\n            },\n            init() {\n                endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n                    this.categories = clone(database.categories);\n                });\n                ['categorySelected'].forEach((item) => {\n                    this.$watch(item, (_value) => {\n                        redrawIconImages();\n                    });\n                });\n            }\n        }));\n    }\n}\n\nexport const appController = new AppController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService } from '../services';\n\nclass HomeController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info', () => ({\n            categories: endgameDatabaseService.endgameDatabase.categories\n        }));\n    }\n}\n\nexport const homeController = new HomeController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService } from '../services';\nimport { ariaDescriptionFromIcon, clone, setupSEO } from '../commons';\nimport { EndgameDatabase } from '../model';\n\nclass ListController extends BaseController {\n\n    private title!: string;\n    private seo!: string;\n\n    onEnter($routeParams?: any): void {\n        const self = this;\n        const endgameDatabase = endgameDatabaseService.endgameDatabase;\n        const categories = endgameDatabase.categories;\n        const idxCategory = parseInt($routeParams['idxCategory']);\n        const idxSubcategory = parseInt($routeParams['idxSubcategory']);\n        const category = categories[idxCategory];\n        const subcategory = category.subcategories[idxSubcategory];\n        const idxLastSubcategory = category.count - 1;\n\n        this.title = `${window.AlpineI18n.t(`category.${category.name}`)} [ ${idxSubcategory + 1} / ${idxLastSubcategory + 1} ]`;\n        this.seo = `${window.AlpineI18n.t(`category.${category.name}`)} (${subcategory.name}) ${idxSubcategory + 1}/${idxLastSubcategory + 1}`;\n\n        Alpine.data('info', () => ({\n            title: this.title,\n            idxCategory: idxCategory,\n            idxSubcategory: idxSubcategory,\n            category: category,\n            subcategory: subcategory,\n            gameCount: subcategory.games.length,\n            idxLastSubcategory: idxLastSubcategory,\n            showNavPrev: idxSubcategory > 0 || idxCategory > 0,\n            showNavNext: !(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory),\n            rows: Math.ceil(subcategory.games.length / 6),\n            showPrevious() {\n                if (this.idxSubcategory > 0 || this.idxCategory > 0) {\n                    this.idxSubcategory--;\n                    if (this.idxSubcategory < 0) {\n                        this.idxCategory--;\n                        this.idxSubcategory = endgameDatabase.categories[this.idxCategory].count - 1;\n                        this.idxLastSubcategory = this.idxSubcategory;\n                        this.category =  endgameDatabase.categories[this.idxCategory];\n                    }\n                    this.subcategory =  this.category.subcategories[this.idxSubcategory];\n                    this.gameCount = this.subcategory.games.length;\n                    this.rows = Math.ceil(this.gameCount / 6);\n                    this.showNavPrev = this.idxSubcategory > 0 || this.idxCategory > 0;\n                    this.showNavNext = true;\n                    this.title = `${window.AlpineI18n.t(`category.${this.category.name}`)} [ ${this.idxSubcategory + 1} / ${this.idxLastSubcategory + 1} ]`;\n                    self.title = this.title;\n                    self.seo = `${window.AlpineI18n.t(`category.${this.category.name}`)} (${this.subcategory.name}) ${this.idxSubcategory + 1}/${this.idxLastSubcategory + 1}`;\n                    setupSEO('list.html', self.getSEOParams());\n                    window.history.replaceState(this.title, this.title, `/chessendgametraining/#/chessendgametraining/list/${this.idxCategory}/${this.idxSubcategory}`);\n                }\n            },\n            showNext() {\n                if (!(this.idxCategory === endgameDatabase.count - 1 && this.idxSubcategory === this.idxLastSubcategory)) {\n                    this.idxSubcategory++;\n                    if (this.idxSubcategory > this.idxLastSubcategory) {\n                        this.idxCategory++;\n                        this.idxSubcategory = 0;\n                        this.idxLastSubcategory = endgameDatabase.categories[this.idxCategory].count - 1;\n                        this.category =  endgameDatabase.categories[this.idxCategory];\n                    }\n                    this.subcategory =  this.category.subcategories[this.idxSubcategory];\n                    this.gameCount = this.subcategory.games.length;\n                    this.rows = Math.ceil(this.gameCount / 6);\n                    this.showNavPrev = true;\n                    this.showNavNext = !(this.idxCategory === endgameDatabase.count - 1 && this.idxSubcategory === this.idxLastSubcategory);\n                    this.title = `${window.AlpineI18n.t(`category.${this.category.name}`)} [ ${this.idxSubcategory + 1} / ${this.idxLastSubcategory + 1} ]`;\n                    self.title = this.title;\n                    self.seo = `${window.AlpineI18n.t(`category.${this.category.name}`)} (${this.subcategory.name}) ${this.idxSubcategory + 1}/${this.idxLastSubcategory + 1}`;\n                    setupSEO('list.html', self.getSEOParams());\n                    window.history.replaceState(this.title, this.title, `/chessendgametraining/#/chessendgametraining/list/${this.idxCategory}/${this.idxSubcategory}`);\n                }\n            },\n            ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n            init() {\n                endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n                    const categories = database.categories;\n                    this.category = clone(categories[idxCategory]);\n                    this.subcategory = clone(this.category.subcategories[idxSubcategory]);\n                });\n            }\n        }));\n    }\n\n    getSEOParams(): any {\n        return { 'kind': this.seo };\n    }\n\n}\n\nexport const listController = new ListController();\n","import { BaseController } from './controller';\nimport Alpine from 'alpinejs';\nimport { IonModal } from '@ionic/core/components/ion-modal';\nimport { configurationService } from '../services';\n\nclass PromotionController extends BaseController {\n    private player!: string\n    setInfo(player: string) {\n        this.player = player;\n    }\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('promotion', () => ({\n            player: this.player,\n            currentPieceTheme: configurationService.configuration.pieceTheme,\n            select(piece: string) {\n                (document.querySelector('ion-modal') as IonModal).dismiss({piece: piece});\n            }\n        }));\n    }\n}\n\nexport const promotionController = new PromotionController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { configurationService, endgameDatabaseService, redrawIconImages, routeService, soundService, stockfishService, syzygyService } from '../services';\nimport { MAIN_MENU_ID, ariaDescriptionFromIcon, clone, urlIcon } from '../commons';\nimport { Category, EndgameDatabase, MoveItem, Position, Subcategory } from '../model';\nimport { Chess, ChessInstance, PieceType, SQUARES, Square } from 'chess.js';\nimport { Chessground } from 'chessground';\nimport { Api } from 'chessground/api';\nimport { colors, MoveMetadata, Color, Key } from 'chessground/types';\nimport { Config } from 'chessground/config';\nimport { promotionController } from './promotion';\nimport { alertController, menuController, toastController } from '@ionic/core';\n\nclass PositionController extends BaseController {\n\n  private seo!: string;\n  private chess: ChessInstance = Chess();\n  private board!: Api;\n  private boardConfig!: Config;\n  private fen!: string;\n  private moveList: MoveItem[] = Alpine.reactive([]);\n  private movePointer: { value: number } = Alpine.reactive({ value: -1 });\n  private player!: \"white\" | \"black\";\n  //private engine!: \"white\" | \"black\";\n  private target!: string;\n  private useSyzygy = false;\n  private gameOver = Alpine.reactive({ value: false });\n  private waitingForOpponent = Alpine.reactive({ value: false });\n  private askingForHint = Alpine.reactive({ value: false });\n  private solving = Alpine.reactive({ value: false });\n\n  constructor() {\n    super();\n    stockfishService.messageEmitter.addEventListener((message: string) => this.stockfishMessage(message));\n  }\n\n  private resizeBoard() {\n    const headers = Array.from(document.querySelectorAll('ion-header')) as HTMLElement[];\n    const header = headers.find(header => header.clientHeight > 0);\n    if (!header) return;\n    const container = document.querySelector('.container') as HTMLElement;\n    const infoWrapper = document.querySelector('.info_wrapper') as HTMLElement;\n    const infoTarget = document.getElementById('info_target') as HTMLElement;\n    const infoMoves = document.querySelector('.info_moves') as HTMLElement;\n    const actionButtons = document.querySelector('.action_buttons') as HTMLElement;\n    const containerWidth = container.clientWidth;\n    const containerHeight = container.clientHeight;\n    let minSize = Math.min(containerWidth, containerHeight);\n    const mod = minSize % 8;\n    minSize = minSize - mod;\n    const board: any = document.getElementById('__chessboard__');\n    board.style.height = `${minSize}px`;\n    board.style.width = `${minSize}px`;\n\n    if (containerWidth > containerHeight) {\n      infoWrapper.style.width = `${(containerWidth - minSize - 2)}px`;\n      infoWrapper.style.height = `calc(100% - ${actionButtons.clientHeight}px`;\n    } else {\n      infoWrapper.style.width = '100%';\n      infoWrapper.style.height = `calc(100% - ${minSize + actionButtons.clientHeight + 2}px`;\n    }\n    infoMoves.style.height = `${infoWrapper.clientHeight - (infoTarget.clientHeight)}px`;\n    actionButtons.style.width = infoWrapper.style.width;\n  }\n\n  private toDests(): Map<Key, Key[]> {\n    const dests = new Map();\n    SQUARES.forEach(s => {\n      const ms = this.chess.moves({ square: s, verbose: true });\n      if (ms.length) dests.set(s, ms.map(m => m.to));\n    });\n    return dests;\n  }\n\n  private resetPosition() {\n    this.waitingForOpponent.value = false;\n    redrawIconImages();\n    this.gameOver.value = false;\n    stockfishService.postMessage('stop');\n    this.chess.load(this.fen);\n    const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n    this.board.set({\n      fen: this.chess.fen(),\n      turnColor: turn,\n      lastMove: [],\n      viewOnly: false,\n      movable: {\n        dests: this.toDests()\n      }\n    });\n    this.moveList.splice(0, this.moveList.length);\n    this.movePointer.value = -1;\n  }\n\n  private showRestartDialog() {\n    alertController.create({\n      header: window.AlpineI18n.t('position.confirm-restart.header'),\n      message: window.AlpineI18n.t('position.confirm-restart.message'),\n      buttons: [\n        {\n          text: window.AlpineI18n.t('position.confirm-restart.no'),\n          role: 'cancel',\n          cssClass: 'overlay-button',\n          handler: () => {\n          }\n        }, {\n          text: window.AlpineI18n.t('position.confirm-restart.yes'),\n          cssClass: 'overlay-button',\n          handler: () => {\n            this.resetPosition();\n          }\n        }\n      ]\n    }).then(alert => alert.present());\n  }\n\n  private showPruneDialog(idx: number) {\n    alertController.create({\n      header: window.AlpineI18n.t('position.confirm-prune.header'),\n      message: window.AlpineI18n.t('position.confirm-prune.message'),\n      buttons: [\n        {\n          text: window.AlpineI18n.t('position.confirm-prune.no'),\n          role: 'cancel',\n          cssClass: 'overlay-button',\n          handler: () => {\n          }\n        }, {\n          text: window.AlpineI18n.t('position.confirm-prune.yes'),\n          cssClass: 'overlay-button',\n          handler: () => {\n            this.pruneMove(idx);\n          }\n        }\n      ]\n    }).then(alert => alert.present());\n  }\n\n  private pruneMove(idx: number) {\n    const order = this.moveList[idx].order;\n    do {\n      this.moveList.splice(idx, 1);\n    } while (this.moveList.length > idx && this.moveList[idx].order > order);\n    this.gotoMove(idx - 1);\n  }\n\n  private gotoMove(idx: number) {\n    if (idx >= 0 && !this.moveList[idx].fen) return;\n    this.movePointer.value = idx;\n    this.waitingForOpponent.value = false;\n    redrawIconImages();\n    this.gameOver.value = false;\n    stockfishService.postMessage('stop');\n    this.chess.load(idx == -1 ? this.fen : this.moveList[idx].fen);\n    this.gameOver.value = this.chess.game_over();\n    const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n    this.board.set({\n      fen: this.chess.fen(),\n      turnColor: turn,\n      lastMove: [],\n      viewOnly: this.gameOver.value,\n      movable: {\n        dests: this.toDests()\n      }\n    });\n  }\n\n  private stop() {\n    this.waitingForOpponent.value = false;\n    this.askingForHint.value = false;\n    this.solving.value = false;\n    redrawIconImages();\n    stockfishService.postMessage('stop');\n    if (!this.moveList[this.movePointer.value].move2) {\n     this.pruneMove(this.movePointer.value); \n    }\n  }\n\n  onEnter($routeParams?: any): void {\n    const self = this;\n    menuController.get(MAIN_MENU_ID).then(function (menu) {\n      if (menu) menu.swipeGesture = false;\n    });\n    this.useSyzygy = configurationService.configuration.useSyzygy;\n    const endgameDatabase = endgameDatabaseService.endgameDatabase;\n    let categories = endgameDatabase.categories;\n    let idxCategory: number;\n    let idxSubcategory: number;\n    let category: Category;\n    let subcategory: Subcategory;\n    let idxGame: number;\n    let game: Position;\n    let idxLastSubcategory: number;\n    let idxLastGame: number;\n\n    const customFen = ($routeParams['fen1'] !== undefined);\n    if (customFen) {\n      this.fen = `${$routeParams['fen1']}/${$routeParams['fen2']}/${$routeParams['fen3']}/${$routeParams['fen4']}/${$routeParams['fen5']}/${$routeParams['fen6']}/${$routeParams['fen7']}/${$routeParams['fen8']}`;\n      this.target = $routeParams['target'];\n      this.seo = this.fen;\n    } else {\n      idxCategory = parseInt($routeParams['idxCategory']);\n      idxSubcategory = parseInt($routeParams['idxSubcategory']);\n      category = categories[idxCategory];\n      subcategory = category.subcategories[idxSubcategory];\n      idxGame = parseInt($routeParams['idxGame']);\n      game = subcategory.games[idxGame];\n      idxLastSubcategory = category.count - 1;\n      idxLastGame = subcategory.count - 1;\n      this.fen = game.fen;\n      this.target = game.target;\n      this.seo = `${window.AlpineI18n.t(`category.${category.name}`)} (${subcategory.name}) ${idxGame + 1}/${idxLastGame + 1}`;\n    }\n\n    this.chess.load(this.fen);\n    this.moveList.splice(0, this.moveList.length);\n    this.movePointer.value = -1;\n\n    const turnWhite = this.chess.turn() == 'w';\n    const turnColor: Color = (turnWhite ? 'white' : 'black');\n    this.player = turnColor;\n    //this.engine = this.player == 'white' ? 'black' : 'white';\n    const move = (turnWhite ? 'white' : 'black');\n    const targetImage = urlIcon(turnWhite ? 'wK.svg' : 'bK.svg', configurationService.configuration.pieceTheme);\n    this.boardConfig = {\n      fen: this.chess.fen(),\n      orientation: (this.chess.turn() == 'w' ? colors[0] : colors[1]),\n      viewOnly: false,\n      turnColor: turnColor,\n      premovable: {\n        enabled: false\n      },\n      movable: {\n        free: false,\n        color: turnColor,\n        dests: this.toDests(),\n        showDests: configurationService.configuration.highlightSquares,\n        events: {\n          after: (orig: Key, dest: Key, _metadata: MoveMetadata) => { this.afterMove(orig, dest); }\n        }\n      },\n      highlight: {\n        lastMove: true,\n        check: true\n      },\n      draggable: {\n        enabled: true,\n        autoDistance: true,\n        showGhost: true\n      },\n      selectable: {\n        enabled: true\n      }\n    };\n    window.addEventListener('resize', function () {\n      self.resizeBoard();\n    });\n\n    Alpine.data('info', () => ({\n      position: self,\n      boardTheme: configurationService.configuration.boardTheme,\n      pieceTheme: configurationService.configuration.pieceTheme,\n      customFen: customFen,\n      fen: this.fen,\n      target: this.target,\n      idxCategory: idxCategory,\n      idxSubcategory: idxSubcategory,\n      idxGame: idxGame,\n      category: category,\n      subcategory: subcategory,\n      game: game,\n      moveList: self.moveList,\n      movePointer: self.movePointer,\n      move: move,\n      targetImage: targetImage,\n      idxLastSubcategory: idxLastSubcategory,\n      idxLastGame: idxLastGame,\n      showNavPrev: idxSubcategory > 0 || idxCategory > 0 || idxGame > 0,\n      showNavNext: !(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory && idxGame === idxLastGame),\n      listUrl: `/list/${idxCategory}/${idxSubcategory}`,\n      ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n      chess: this.chess,\n      showPreviousPosition() {\n        if (this.idxSubcategory > 0 || this.idxCategory > 0 || this.idxGame > 0) {\n          self.onExit().then(value => {\n            if (value) {\n              menuController.get(MAIN_MENU_ID).then(function (menu) {\n                if (menu) menu.swipeGesture = false;\n              });\n              this.idxGame--;\n              if (this.idxGame < 0) {\n                this.idxSubcategory--;\n                if (this.idxSubcategory < 0) {\n                  this.idxCategory--;\n                  this.idxSubcategory = categories[this.idxCategory].count - 1;\n                  this.idxLastSubcategory = this.idxSubcategory;\n                }\n                this.idxGame = categories[this.idxCategory].subcategories[this.idxSubcategory].count - 1;\n                this.idxLastGame = this.idxGame;\n              }\n              this.showNavPrev = this.idxSubcategory > 0 || this.idxCategory > 0 || this.idxGame > 0;\n              this.showNavNext = true;\n              self.fen = categories[this.idxCategory].subcategories[this.idxSubcategory].games[this.idxGame].fen;\n              self.resetPosition.call(self);\n            }\n          });\n        }\n      },\n      showNextPosition() {\n        if (!(this.idxCategory === endgameDatabase.count - 1 && this.idxSubcategory === this.idxLastSubcategory && this.idxGame === this.idxLastGame)) {\n          self.onExit().then(value => {\n            if (value) {\n              menuController.get(MAIN_MENU_ID).then(function (menu) {\n                if (menu) menu.swipeGesture = false;\n              });\n              this.idxGame++;\n              if (this.idxGame > this.idxLastGame) {\n                this.idxSubcategory++;\n                if (this.idxSubcategory > this.idxLastSubcategory) {\n                  this.idxCategory++;\n                  this.idxSubcategory = 0;\n                  this.idxLastSubcategory = categories[this.idxCategory].count - 1;\n                }\n                this.idxGame = 0;\n                this.idxLastGame = categories[this.idxCategory].subcategories[this.idxSubcategory].count - 1;\n              }\n              this.showNavPrev = true;\n              this.showNavNext = !(this.idxCategory === endgameDatabase.count - 1 && this.idxSubcategory === this.idxLastSubcategory && this.idxGame === this.idxLastGame);\n              self.fen = categories[this.idxCategory].subcategories[this.idxSubcategory].games[this.idxGame].fen;\n              self.resetPosition.call(self);\n            }\n          });\n        }\n      },\n      showRestartDialog() {\n        self.showRestartDialog.call(self);\n      },\n      gotoMove(idx: number) {\n        self.gotoMove.call(self, idx);\n      },\n      showPruneDialog(idx: number) {\n        self.showPruneDialog.call(self, idx);\n      },\n      stop() {\n        self.stop.call(self);\n      },\n      hint() {\n        self.getHint.call(self);\n      },\n      solve() {\n        self.solve.call(self);\n      },\n      init() {\n        self.board = Chessground(document.getElementById('__chessboard__') as HTMLElement, self.boardConfig);\n        // resize the board on the next tick, when the DOM of the chessboard has been loaded\n        requestAnimationFrame(() => {\n          self.resizeBoard();\n        });\n        this.$watch('movePointer', (_value) => {\n          const movelist = document.querySelector('.info_moves') as HTMLIonListElement;\n          const item = document.getElementById(`item-${this.movePointer.value}`) as HTMLElement;\n          if (item) {\n            const y = item.offsetHeight * (this.movePointer.value);\n            movelist.scrollTo({ top: y, behavior: 'smooth' });\n          }\n        });\n        endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n          const categories = database.categories;\n          this.category = clone(categories[idxCategory]);\n          this.subcategory = clone(this.category.subcategories[idxSubcategory]);\n          this.game = clone(this.subcategory.games[idxGame]);\n        });\n        configurationService.configuration.configurationChangedEmitter.addEventListener((event) => {\n          switch (event.field) {\n            case 'boardTheme': this.boardTheme = event.config.boardTheme; break;\n            case 'pieceTheme': this.pieceTheme = event.config.pieceTheme; break;\n            case 'highlightSquares': {\n              if (self.boardConfig.movable) {\n                self.board.set({\n                  movable: { showDests: event.config.highlightSquares },\n                });\n              }\n              break;\n            }\n            case 'useSyzygy': self.useSyzygy = configurationService.configuration.useSyzygy; break;\n          }\n        });\n      }\n    }));\n  }\n\n  afterMove(orig: Key, dest: Key) {\n    if (orig == 'a0' || dest == 'a0') return;\n    // check promotion\n    if (this.chess.get(orig)?.type == 'p' && (dest.charAt(1) == '8' || dest.charAt(1) == '1')) {\n      routeService.openModal('promotion', 'promotion.html', promotionController, false, true, this.player[0]).then((data: any) => {\n        this.registerMove(orig, dest, data.piece);\n      });\n    } else {\n      this.registerMove(orig, dest, undefined);\n    }\n  }\n\n  private updateMoveList(prevFen: string) {\n    const history = this.chess.history();\n    if (this.chess.turn() === 'w') {\n      const move = this.moveList[this.movePointer.value];\n      move.move2 = history[history.length - 1];\n      move.fen = this.chess.fen();\n    } else {\n      // look for moveItem\n      const itemOrder = this.movePointer.value >= 0 ? this.moveList[this.movePointer.value].order + 1 : 1;\n      const move1 = history[history.length - 1];\n      const itemIndex = this.moveList.findIndex(item => item.order == itemOrder && item.move1 == move1 && item.prevFen == prevFen);\n      if (itemIndex > -1) {\n        this.movePointer.value = itemIndex;\n      } else {\n        const moveItem: MoveItem = {\n          order: itemOrder,\n          move1: move1,\n          move2: '',\n          prevFen: prevFen,\n          fen: ''\n        };\n        if (this.movePointer.value === this.moveList.length - 1) {\n          // If movePointer is pointing to the last item, simply push the new item to the end of the array\n          this.moveList.push(moveItem);\n          // Update movePointer to point to the newly added item\n          this.movePointer.value = this.moveList.length - 1;\n        } else {\n          // If movePointer is pointing to any other item, insert the new item after the current one\n          this.moveList.splice(this.movePointer.value + 1, 0, moveItem);\n          // Update movePointer to point to the newly added item\n          this.movePointer.value++;\n        }\n      }\n      if (this.chess.game_over()) {\n        this.moveList[this.movePointer.value].fen = this.chess.fen();\n      }\n    }\n  }\n\n  private registerMove(source: Square, target: Square, promotion: Exclude<PieceType, \"p\" | \"k\"> | undefined) {\n    const prevFen = this.chess.fen();\n    this.chess.move({\n      from: source,\n      to: target,\n      promotion: promotion\n    });\n    if (promotion)\n      this.board.set({ fen: this.chess.fen() });\n\n    this.updateMoveList(prevFen);\n\n    if (!this.checkEnding()) {\n      soundService.playAudio('move');\n      this.getOpponentMove();\n    }\n  }\n\n  private checkEnding(): boolean {\n    const result = this.chess.game_over();\n    if (result) {\n      this.gameOver.value = true;\n      if ('checkmate' !== this.target && !this.chess.in_checkmate() ||\n        'checkmate' === this.target && this.chess.in_checkmate() && !this.player.startsWith(this.chess.turn())) {\n        soundService.playAudio('success');\n      } else {\n        soundService.playAudio('fail');\n      }\n\n      let message;\n      if (this.chess.in_checkmate())\n        message = 'position.checkmate';\n      else if (this.chess.in_stalemate())\n        message = 'position.stalemate';\n      else if (this.chess.insufficient_material())\n        message = 'position.insufficent-material';\n      else if (this.chess.in_threefold_repetition())\n        message = 'position.three-repetition';\n      else if (this.chess.in_draw())\n        message = 'position.rule-fifty';\n      else\n        message = 'position.game-over';\n\n      alertController.create({\n        header: window.AlpineI18n.t('position.game-over'),\n        message: window.AlpineI18n.t(`${message}`),\n        buttons: [\n          {\n            text: window.AlpineI18n.t('position.ok'),\n            cssClass: 'overlay-button'\n          }\n        ]\n      }).then(alert => alert.present());\n\n    }\n    return result;\n  }\n\n\n  private numberOfPieces(fen: string) {\n    return fen.substring(0, fen.indexOf(\" \")).replace(/\\d/g, \"\").replace(/\\//g, \"\").length;\n  }\n\n  private getHint() {\n    this.askingForHint.value = true;\n    this.getOpponentMove();\n  }\n\n  private solve() {\n    this.solving.value = true;\n    this.getOpponentMove();\n  }\n\n  private getOpponentMove() {\n    let moveFunk;\n    if (this.useSyzygy && this.numberOfPieces(this.chess.fen()) <= 7) {\n      moveFunk = this.getSyzygyMove;\n    } else {\n      moveFunk = this.getStockfishMove;\n    }\n    moveFunk.call(this);\n  }\n\n  private getSyzygyMove() {\n    this.waitingForOpponent.value = true;\n    redrawIconImages();\n    syzygyService.get(this.chess.fen())\n      .then(response => response.json().then(data => {\n        if (!this.waitingForOpponent.value) return;\n        this.waitingForOpponent.value = false;\n        redrawIconImages();\n        const bestmove = data.moves[0].uci;\n        let match = bestmove.match(/^([a-h][1-8])([a-h][1-8])([qrbn])?/);\n        const from = match[1];\n        const to = match[2];\n        if (this.askingForHint.value) {\n          this.board.setShapes([{ orig: from, dest: to, brush: 'blue' }]);\n          this.askingForHint.value = false;\n          return;\n        }\n        const promotion = match[3];\n        this.board.move(from as Key, to as Key);\n        this.chess.move({ from: from as Square, to: to as Square, promotion: promotion });\n        const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n        this.board.set({\n          fen: this.chess.fen(),\n          turnColor: turn,\n          movable: {\n            dests: this.toDests()\n          }\n        });\n\n        this.updateMoveList('');\n\n        if (this.checkEnding()) {\n          this.board.set({ viewOnly: true });\n        } else {\n          soundService.playAudio('move');\n          if (this.solving.value) setTimeout(() => { if (this.solving.value) this.getOpponentMove()}, 500);\n        }\n      })\n      ).catch((_err) => {\n        this.useSyzygy = false;\n        toastController.create({\n          message: window.AlpineI18n.t('position.syzygy-error'),\n          position: 'middle',\n          color: 'warning',\n          duration: 2000\n        }).then(toast => toast.present());\n        this.getStockfishMove();\n      });\n\n    /*\n{\n  \"checkmate\": false,\n  \"stalemate\": false,\n  \"variant_win\": false,\n  \"variant_loss\": false,\n  \"insufficient_material\": false,\n  \"dtz\": -14,\n  \"precise_dtz\": -14,\n  \"dtm\": -14,\n  \"category\": \"loss\",\n  \"moves\": [\n    {\n      \"uci\": \"d7c7\",\n      \"san\": \"Kc7\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 13,\n      \"precise_dtz\": 13,\n      \"dtm\": 13,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7e7\",\n      \"san\": \"Ke7\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 13,\n      \"precise_dtz\": 13,\n      \"dtm\": 13,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7c8\",\n      \"san\": \"Kc8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7d8\",\n      \"san\": \"Kd8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7e8\",\n      \"san\": \"Ke8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    }\n  ]\n}\n    */\n  }\n\n  private getStockfishMove() {\n    stockfishService.postMessage(`position fen ${this.chess.fen()}`);\n    this.waitingForOpponent.value = true;\n    redrawIconImages();\n    stockfishService.postMessage(`go depth ${configurationService.configuration.stockfishDepth} movetime ${configurationService.configuration.stockfishMovetime * 1000}`);\n  }\n\n  private stockfishMessage(message: string) {\n    if (!this.waitingForOpponent.value) return;\n    let match;\n    if (match = message.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/)) {\n      this.waitingForOpponent.value = false;\n      redrawIconImages();\n      const from = match[1];\n      const to = match[2];\n      if (this.askingForHint.value) {\n        this.board.setShapes([{ orig: from as Key, dest: to as Key, brush: 'blue' }]);\n        this.askingForHint.value = false;\n        return;\n      }\n      const promotion = (match[3] == 'r' || match[3] == 'n' || match[3] == 'b' || match[3] == 'q') ? match[3] : undefined;\n      this.board.move(from as Key, to as Key);\n      this.chess.move({ from: from as Square, to: to as Square, promotion: promotion });\n      const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n      // this.board.set({\n      //   fen: this.chess.fen(),\n      //   turnColor: turn,\n      //   movable: {\n      //     dests: this.toDests()\n      //   }\n      // });\n      this.board.set({\n        fen: this.chess.fen(),\n        turnColor: turn,\n        movable: {\n          color: turn,\n          dests: this.toDests()\n        }\n      });\n\n      this.updateMoveList('');\n\n      if (this.checkEnding()) {\n        this.board.set({ viewOnly: true });\n      } else {\n        soundService.playAudio('move');\n        if (this.solving.value) setTimeout(() => { if (this.solving.value) this.getOpponentMove()}, 500);\n      }\n    }\n  }\n\n  getSEOParams(): any {\n    return { 'kind': this.seo };\n  }\n\n  onExit(): Promise<boolean> {\n    return new Promise<boolean>(async resolve => {\n      if (this.moveList.length == 0) {\n        resolve(true);\n        return;\n      }\n      const alert = await alertController.create({\n        header: window.AlpineI18n.t('position.confirm-exit.header'),\n        message: window.AlpineI18n.t('position.confirm-exit.message'),\n        buttons: [\n          {\n            text: window.AlpineI18n.t('position.confirm-exit.no'),\n            role: 'cancel',\n            cssClass: 'overlay-button',\n            handler: () => {\n              resolve(false);\n            }\n          }, {\n            text: window.AlpineI18n.t('position.confirm-exit.yes'),\n            cssClass: 'overlay-button',\n            handler: () => {\n              this.waitingForOpponent.value = false;\n              redrawIconImages();\n              stockfishService.postMessage('stop');\n              menuController.get(MAIN_MENU_ID).then(function (menu) {\n                if (menu) menu.swipeGesture = true;\n              });\n              resolve(true);\n            }\n          }\n        ]\n      });\n      alert.present();\n    });\n  }\n\n}\n\nexport const positionController = new PositionController();\n","import { appController, homeController, aboutController, settingsController, listController, positionController, promotionController } from './controllers';\n\nexport const ROUTE_MAP = {\n    hash: true,\n    mainRoute: {\n        path: '/chessendgametraining/',\n        template: 'app.html',\n        tag: 'ion-app',\n        controller: appController,\n        hasParams: false\n    },\n    routes: [\n        {\n            path: '/',\n            template: 'home.html',\n            tag: 'ion-router-outlet',\n            controller: homeController,\n            hasParams: false\n        },\n        {\n            path: '/home',\n            template: 'home.html',\n            tag: 'ion-router-outlet',\n            controller: homeController,\n            hasParams: false\n        },\n        {\n            path: '/about',\n            template: 'about.html',\n            tag: 'ion-router-outlet',\n            controller: aboutController,\n            hasParams: false\n        },\n        {\n            path: '/settings',\n            template: 'settings.html',\n            tag: 'ion-router-outlet',\n            controller: settingsController,\n            hasParams: false\n        },\n        {\n            path: '/list/:idxCategory/:idxSubcategory',\n            template: 'list.html',\n            tag: 'ion-router-outlet',\n            controller: listController,\n            hasParams: true\n        },\n        {\n            path: '/position/:idxCategory/:idxSubcategory/:idxGame',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/fen/:fen1/:fen2/:fen3/:fen4/:fen5/:fen6/:fen7/:fen8',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/fen/:fen1/:fen2/:fen3/:fen4/:fen5/:fen6/:fen7/:fen8/:target',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/promotion',\n            template: 'promotion.html',\n            tag: 'ion-router-outlet',\n            controller: promotionController,\n            hasParams: false\n        }\n    ]\n};\n","import './styles';\n\nimport { services_initialize, routeService } from './services';\nimport { ROUTE_MAP } from './routes';\n\nservices_initialize().then(() => { routeService.init(ROUTE_MAP); });\n"],"file":"assets/index-CTQgy624.js"}