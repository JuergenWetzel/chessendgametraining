{"version":3,"mappings":";;;;;;qyCAAO,MAAMA,EAAe,YACfC,GAAS,CAClB,CACI,KAAQ,OACR,MAAS,OACT,UAAa,SACjB,EACA,CACI,KAAQ,QACR,MAAS,GACT,UAAa,SACjB,CACJ,EAEaC,EAAe,CAAC,QAAS,aAAc,WAAY,SAAU,WAAY,UAAW,YAAa,UAAW,OAAQ,QAAS,UAAW,SAAU,SAAU,OAAQ,OAAQ,YAAa,QAAS,SAAU,WAAY,SAAU,UAAW,WAAW,EAExPC,EAAe,CACxB,CACE,KAAQ,QACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,OACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,QACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,OACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,OACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,OACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,aACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,EACA,CACE,KAAQ,cACR,OAAU,CACR,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,EAC7D,CAAE,cAAiB,2BAA4B,MAAS,SAAU,EAClE,CAAE,cAAiB,sBAAuB,MAAS,SAAU,CAC/D,CACF,CACF,ECzFK,MAAMC,CAAgB,CAG3B,aAAc,CAFNC,EAAA,kBAAqC,GAE7B,CAET,iBAAiBC,EAA8B,CAC/C,KAAK,WAAW,SAASA,CAAQ,GAC/B,gBAAW,KAAKA,CAAQ,CAEjC,CAEO,oBAAoBA,EAA8B,CACvD,MAAMC,EAAM,KAAK,WAAW,QAAQD,CAAQ,EACxCC,IAAQ,IACL,gBAAW,OAAOA,EAAK,CAAC,CAEjC,CAEO,iBAAkB,CACvB,KAAK,WAAa,EACpB,CAEO,OAAOC,EAAU,CACjB,gBAAW,QAASC,GAAe,CACtCA,EAAWD,CAAK,EACjB,CACH,CACF,CC3Ba,MAAAE,GAAgBC,GAAiB,OAC1C,MAAMC,EAAmB,GACnBC,EAAQF,EAAK,MAAM,GAAG,EAC5B,IAAIG,EAAO,EACPC,GAAaC,EAAA,SAAS,cAAc,MAAM,IAA7B,MAAAA,EAAgC,UAAU,SAAS,QAAU,IAAM,IAChFC,EAAQ,IACZ,OAAAJ,EAAM,QAAgBK,GAAA,CACd,IAAAC,EAEJ,GADAD,EAAOA,EAAK,cACRA,GAAQ,MACDJ,EAAA,UACAI,GAAQ,MACRJ,EAAA,UACAI,GAAQ,QACfC,EAAQ,GAAGJ,CAAU,QACrBH,EAAO,KAAKO,CAAK,EACVL,EAAA,UACAI,GAAQ,OACfC,EAAQ,GAAGJ,CAAU,QACrBH,EAAO,KAAKO,CAAK,EACVL,EAAA,UACAI,GAAQ,OACfC,EAAQ,GAAGJ,CAAU,QACrBH,EAAO,KAAKO,CAAK,EACVL,EAAA,UACAI,GAAQ,KACfC,EAAQ,GAAGJ,CAAU,aACrBH,EAAO,KAAKO,CAAK,EACTF,EAAA,YACDC,EAAK,YAAY,OAAQ,CAAC,IAAM,EAAG,CAC1C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,UACAI,EAAK,YAAY,QAAS,CAAC,IAAM,EAAG,CAC3C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,UACAI,EAAK,YAAY,OAAQ,CAAC,IAAM,EAAG,CAC1C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,UACAI,EAAK,YAAY,SAAU,CAAC,IAAM,EAAG,CAC5C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,UACAI,EAAK,YAAY,SAAU,CAAC,IAAM,EAAG,CAC5C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,UACAI,EAAK,YAAY,OAAQ,CAAC,IAAM,EAAG,CAC1C,QAASE,EAAIN,EAAMM,EAAI,EAAGA,IACtBD,EAAQ,GAAGF,CAAK,QAChBL,EAAO,KAAKO,CAAK,EAEdL,EAAA,CACX,EACH,EACMF,CACX,EAEaS,EAAU,CAACC,EAAcC,IAC9BD,EAAK,SAAS,OAAO,GAAKA,EAAK,SAAS,OAAO,GAAKA,EAAK,SAAS,OAAO,GAAKA,EAAK,SAAS,YAAY,GAAKA,EAAK,SAAS,gBAAgB,EACpI,gBAAgBA,CAAI,GAGpB,iBAAiBC,CAAU,IAAID,CAAI,GAIrCE,EAA2BF,GAChCA,EAAK,SAAS,OAAO,EAAU,QAC1BA,EAAK,SAAS,OAAO,EAAU,OAC/BA,EAAK,SAAS,OAAO,EAAU,OAC/BA,EAAK,SAAS,gBAAgB,EAAU,aACxCA,EAAK,SAAS,YAAY,EAAU,UACpCA,EAAK,SAAS,OAAO,EAAU,SAC/BA,EAAK,SAAS,OAAO,EAAU,OAC/BA,EAAK,SAAS,OAAO,EAAU,SAC/BA,EAAK,SAAS,OAAO,EAAU,OAC/BA,EAAK,SAAS,OAAO,EAAU,QAC/BA,EAAK,SAAS,OAAO,EAAU,OAC5B,UAGHG,EAASC,GACX,KAAK,MAAM,KAAK,UAAUA,CAAM,CAAC,EAGtCC,GAAYC,GAAqB,CACnC,OAAO,SAAS,MAAQA,CAC5B,EAEMC,GAAU,CAACC,EAAcC,IAAqB,CAC/C,OAAO,SAAS,kBAAkBD,CAAI,EAAE,CAAC,EAAsB,QAAUC,CAC9E,EAEaC,EAAW,CAACC,EAAkBC,IAAgB,CACvD,MAAMC,EAAOF,EAAS,QAAQ,QAAS,EAAE,EACzCN,GAAS,OAAO,WAAW,EAAE,GAAGQ,CAAI,aAAcD,CAAM,CAAC,EACjDL,GAAA,cAAe,OAAO,WAAW,EAAE,GAAGM,CAAI,wBAAyBD,CAAM,CAAC,CACtF,ECtGO,MAAME,CAAc,CAIvB,YACYC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACV,CAdM1C,EAAA,oCAAwE,IAAID,GAGxE,gBAAAiC,EACA,qBAAAC,EACA,wBAAAC,EACA,iCAAAC,EACA,uBAAAC,EACA,iBAAAC,EACA,iBAAAC,EACA,iBAAAC,EACA,uBAAAC,EACA,iBAAAC,EACA,iBAAAC,CACR,CAEG,WAAY,CACR,OACH,UAAW,KAAK,WAChB,eAAgB,KAAK,gBACrB,kBAAmB,KAAK,mBACxB,2BAA4B,KAAK,4BACjC,iBAAkB,KAAK,kBACvB,WAAY,KAAK,YACjB,WAAY,KAAK,YACjB,WAAY,KAAK,YACjB,iBAAkB,KAAK,kBACvB,WAAY,KAAK,YACjB,WAAY,KAAK,YAEzB,CAEA,IAAI,eAA+B,CAAS,WAAM,CAClD,IAAI,6BAAuE,CAAE,OAAO,KAAK,4BAA8B,CAEvH,IAAI,WAAqB,CAAE,OAAO,KAAK,UAAY,CACnD,IAAI,UAAUC,EAAgB,CAAE,KAAK,WAAaA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,YAAa,CAAG,CAEzI,IAAI,gBAAyB,CAAE,OAAO,KAAK,eAAiB,CAC5D,IAAI,eAAeA,EAAe,CAAE,KAAK,gBAAkBA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,iBAAkB,CAAG,CAEvJ,IAAI,mBAA4B,CAAE,OAAO,KAAK,kBAAoB,CAClE,IAAI,kBAAkBA,EAAe,CAAE,KAAK,mBAAqBA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,oBAAqB,CAAG,CAEhK,IAAI,4BAAsC,CAAE,OAAO,KAAK,2BAA6B,CACrF,IAAI,2BAA2BA,EAAgB,CAAE,KAAK,4BAA8BA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,6BAA8B,CAAG,CAE5L,IAAI,kBAA4B,CAAE,OAAO,KAAK,iBAAmB,CACjE,IAAI,iBAAiBA,EAAgB,CAAE,KAAK,kBAAoBA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,mBAAoB,CAAG,CAE9J,IAAI,YAAqB,CAAE,OAAO,KAAK,WAAa,CACpD,IAAI,WAAWA,EAAe,CAAE,KAAK,YAAcA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,aAAc,CAAG,CAE3I,IAAI,YAAsB,CAAE,OAAO,KAAK,WAAa,CACrD,IAAI,WAAWA,EAAgB,CAAE,KAAK,YAAcA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,aAAc,CAAG,CAE5I,IAAI,YAAsB,CAAE,OAAO,KAAK,WAAa,CACrD,IAAI,WAAWA,EAAgB,CAAE,KAAK,YAAcA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,aAAc,CAAG,CAE5I,IAAI,kBAA4B,CAAE,OAAO,KAAK,iBAAmB,CACjE,IAAI,iBAAiBA,EAAgB,CAAE,KAAK,kBAAoBA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,mBAAoB,CAAG,CAE9J,IAAI,YAAqB,CAAE,OAAO,KAAK,WAAa,CACpD,IAAI,WAAWA,EAAe,CAAE,KAAK,YAAcA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,aAAc,CAAG,CAE3I,IAAI,YAAqB,CAAE,OAAO,KAAK,WAAa,CACpD,IAAI,WAAWA,EAAe,CAAE,KAAK,YAAcA,EAAO,KAAK,6BAA6B,OAAO,CAAE,OAAQ,KAAM,MAAO,aAAc,CAAG,CAE/I,CAEO,MAAMC,EAAiB,IAAIb,EAC9B,GACA,GACA,EACA,GACA,GACA,OACA,GACA,GACA,GACAlC,EAAa,CAAC,EACdC,EAAa,CAAC,EAAE,IACpB,223NCnFa+C,GAAwCC,GCPrD,MAAMC,EAAe,CAArB,cACY/C,EAAA,aAAQ,IAAIgD,GAAQ,CAAE,KAAM,cAAe,YAAa,CAAEC,EAAQ,UAAWA,EAAQ,YAAa,CAAG,IAE7G,MAAa,MAAqB,CACvB,YAAK,MAAM,QACtB,CAEO,IAAIC,EAAa,CACb,YAAK,MAAM,IAAIA,CAAG,CAC7B,CAEO,IAAIA,EAAaP,EAAY,CAChC,OAAO,KAAK,MAAM,IAAIO,EAAKP,CAAK,CACpC,CAEO,OAAOO,EAAa,CAChB,YAAK,MAAM,OAAOA,CAAG,CAChC,CAEJ,CAEa,MAAAC,EAAiB,IAAIJ,GCpBlC,MAAMK,EAAqB,CAMvB,aAAc,CAJNpD,EAAA,sBAIQ,CAFhB,IAAI,eAA+B,CAAE,OAAO,KAAK,cAAgB,CAI1D,MAA+B,CAC3B,WAAI,QAAkCqD,GAAA,CACzCF,EAAe,IAAI,eAAe,EAAE,KAAeG,GAAA,CAC3CA,GACIA,EAAO,YAAc,SAAWA,EAAO,UAAYV,EAAe,WAClEU,EAAO,iBAAmB,SAAWA,EAAO,eAAiBV,EAAe,gBAC5EU,EAAO,oBAAsB,SAAWA,EAAO,kBAAoBV,EAAe,mBAClFU,EAAO,6BAA+B,SAAWA,EAAO,2BAA6BV,EAAe,4BACpGU,EAAO,mBAAqB,SAAWA,EAAO,iBAAmBV,EAAe,kBAChFU,EAAO,aAAe,SAAWA,EAAO,WAAaV,EAAe,YACpEU,EAAO,aAAe,SAAWA,EAAO,WAAaV,EAAe,YACpEU,EAAO,aAAe,SAAWA,EAAO,WAAaV,EAAe,YACpEU,EAAO,mBAAqB,SAAWA,EAAO,iBAAmBV,EAAe,kBAChFU,EAAO,aAAe,SAAWA,EAAO,WAAaV,EAAe,YACpEU,EAAO,aAAe,SAAWA,EAAO,WAAaV,EAAe,YACxE,KAAK,eAAiB,IAAIb,EACtBuB,EAAO,UACPA,EAAO,eACPA,EAAO,kBACPA,EAAO,2BACPA,EAAO,iBACPA,EAAO,WACPA,EAAO,WACPA,EAAO,WACPA,EAAO,iBACPA,EAAO,WACPA,EAAO,YAEXD,EAAQ,KAAK,cAAc,IAE3B,KAAK,eAAiBT,EACjB,YAAO,KAAYW,GAAA,CACpBF,EAAQE,CAAG,EACd,EACL,CACH,EACJ,CACL,CAEO,MAA+B,CAClC,OAAOJ,EAAe,IAAI,gBAAiB,KAAK,eAAe,WAAW,CAC9E,CAEJ,CAEa,MAAAK,EAAuB,IAAIJ,GCrDxC,MAAMK,EAAqB,CAEhB,WAAY,CACR,OAAA7D,EACX,CAEO,SAAS8D,EAAe,SACbA,GAAV,QACA/C,EAAA,SAAS,cAAc,MAAM,IAA7B,MAAAA,EAAgC,UAAU,IAAI,SAE9CgD,EAAA,SAAS,cAAc,MAAM,IAA7B,MAAAA,EAAgC,UAAU,OAAO,OACzD,CAEO,cAAe,OACX,OAAAhD,EAAA,SAAS,cAAc,MAAM,IAA7B,MAAAA,EAAgC,UAAU,SAAS,QAAU,OAAS,OACjF,CAEO,MAAO,CACL,cAAS6C,EAAqB,cAAc,UAAU,CAC/D,CACJ,CAEa,MAAAI,EAAuB,IAAIH,GCnBxC,MAAMI,EAAuB,CAA7B,cACY7D,EAAA,yBACAA,EAAA,sCAAgE,IAAID,GAE5E,IAAI,iBAAmC,CAAE,OAAO,KAAK,gBAAkB,CACvE,IAAI,+BAA+D,CAAE,OAAO,KAAK,8BAAgC,CAEjH,MAAa,MAAyB,CAC3B,WAAI,QAAmBsD,GAAA,CAC1B,KAAK,iBAAiB,EAAE,KAAMS,GAAmC,CAC7D,KAAK,iBAAmB,KAAK,mBAAmBA,EAAejB,EAAe,EAC9E,KAAK,OAAO,KAAK,gBAAiBW,EAAqB,cAAc,UAAU,EAC/EA,EAAqB,cAAc,4BAA4B,iBAAkBrD,GAAU,CACnFA,EAAM,OAAS,cAAc,KAAK,OAAO,KAAK,gBAAiBA,EAAM,OAAO,UAAU,EAC7F,EAaDkD,EAAQ,EAAI,EACf,EACJ,CACL,CAEQ,kBAA6C,CAC1C,OAAAF,EAAe,IAAI,kBAAkB,CAChD,CAEQ,OAAOY,EAA2B7C,EAAoB,CAC1D,MAAMN,EAAQgD,EAAqB,aAAa,GAAK,OAAS,IAAM,IAC3DG,EAAA,MAAQA,EAAS,WAAW,OAC5BA,EAAA,WAAW,QAAoBC,GAAA,CAC7BA,EAAA,MAAQA,EAAS,cAAc,OACxCA,EAAS,SAAW,GACpBA,EAAS,MAAM,QAAgB/C,GAAA+C,EAAS,SAAS,KAAKhD,EAAQ,GAAGJ,CAAK,GAAGK,CAAI,GAAIC,CAAU,CAAC,CAAC,EACpF8C,EAAA,cAAc,QAAuBC,GAAA,CAChCA,EAAA,MAAQA,EAAY,MAAM,OAC1BA,EAAA,OAAS5D,GAAa4D,EAAY,IAAI,EAClDA,EAAY,UAAY,GACZA,EAAA,OAAO,QAAQnD,GAASmD,EAAY,UAAU,KAAKjD,EAAQF,EAAOI,CAAU,CAAC,CAAC,EAC3F,EACF,EACI,oCAA+B,OAAO6C,CAAQ,CACvD,CAEQ,mBAAmBD,EAAgCI,EAAmD,CAC1G,OAAKJ,EAIDA,EAAc,SAAWA,EAAc,UAAYI,EAAgB,QAC5DJ,GAGKI,EAAA,WAAW,QAAoBF,GAAA,CAClCA,EAAA,cAAc,QAAuBC,GAAA,CAC9BA,EAAA,MAAM,QAAgBE,GAAA,CACxB,MAAAC,EAAgBN,EAAc,WAAW,QAAU/C,EAAE,OAASiD,EAAS,IAAI,EACjF,GAAII,EAAe,CACT,MAAAC,EAAmBD,EAAc,cAAc,QAAUrD,EAAE,OAASkD,EAAY,IAAI,EAC1F,GAAII,EAAkB,CACZ,MAAAC,EAAYD,EAAiB,MAAM,QAAUtD,EAAE,MAAQoD,EAAK,GAAG,EACjEG,GAAaA,EAAU,SACvBH,EAAK,OAASG,EAAU,OAEhC,CACJ,EACH,EACJ,EACJ,EACcnB,EAAA,IAAI,mBAAoBe,CAAe,EAC/CA,IAxBYf,EAAA,IAAI,mBAAoBe,CAAe,EAC/CA,EAwBf,CACJ,CAEa,MAAAK,EAAyB,IAAIV,GCQ1C,SAAS,gBAAgB,UAAU,IAAI,QAAQ,EAE/C,SAASW,EAAUC,EAAgCC,EAAa,CAC1D,IACa,sBAAOA,EAAKD,CAAI,OACjB,CAAC,CACnB,CAEAE,GAA2B,EAK3BH,EAAUI,GAAU,WAAW,EAC/BJ,EAAUK,GAAQ,SAAS,EAO3BL,EAAUM,GAAW,YAAY,EACjCN,EAAUO,GAAY,aAAa,EACnCP,EAAUQ,GAAgB,kBAAkB,EAC5CR,EAAUS,GAAe,iBAAiB,EAC1CT,EAAUU,GAAS,UAAU,EAE7BV,EAAUW,GAAc,gBAAgB,EAGxCX,EAAUY,GAAQ,SAAS,EAC3BZ,EAAUa,GAAY,aAAa,EAEnCb,EAAUc,GAAc,gBAAgB,EACxCd,EAAUe,GAAQ,SAAS,EAC3Bf,EAAUgB,GAAY,cAAc,EACpChB,EAAUiB,GAAW,YAAY,EACjCjB,EAAUkB,GAAS,UAAU,EAC7BlB,EAAUmB,GAAW,YAAY,EACjCnB,EAAUoB,GAAS,UAAU,EAO7BpB,EAAUqB,GAAS,UAAU,EAI7BrB,EAAUsB,GAAU,WAAW,EAI/BtB,EAAUuB,GAAe,iBAAiB,EAC1CvB,EAAUwB,GAAS,UAAU,EAC7BxB,EAAUyB,GAAe,iBAAiB,EAC1CzB,EAAU0B,GAAU,WAAW,EAY/B1B,EAAU2B,GAAU,WAAW,EAK/B3B,EAAU4B,GAAiB,mBAAmB,EAI9C5B,EAAU6B,GAAe,iBAAiB,EAC1C7B,EAAU8B,GAAiB,mBAAmB,EAC9C9B,EAAU+B,GAAQ,SAAS,EAE3B/B,EAAUgC,GAAkB,oBAAoB,EAChDhC,EAAUiC,GAAY,aAAa,EAQnCjC,EAAUkC,GAAc,gBAAgB,EAQxClC,EAAUmC,GAAU,WAAW,EAC/BnC,EAAUoC,GAAU,WAAW,EAC/BpC,EAAUqC,GAAW,YAAY,EACjCrC,EAAUsC,GAAY,aAAa,EAGnC,MAAMC,kvEACOC,EAAmB,IAAM,CACpC,SAAS,iBAAiB,UAAU,EAAE,QAASC,GAAO,CAC5C,MAAAxF,EAAOwF,EAAG,aAAa,WAAW,EACpCxF,GAAQ,MACVsF,GAAO,4CAA4CtF,CAAI,MAAM,IAAI,KAAMyF,GAAgB,CACrFD,EAAG,IAAMC,CAAA,CACV,CACH,CACD,CACL,EC/LA,MAAMC,EAAa,CAAnB,cAEYnH,EAAA,eACAA,EAAA,sBAAiB,IACjBA,EAAA,qBAAgB,KAEhBA,EAAA,iBAAaoH,GAAmB,CAChC,IAAC,KAAK,eAAgB,CAChB,MAAAC,EAAQ,qBAAuBD,EAAS,KACxCE,EAAO,SAAS,cAAcD,CAAK,EACzC,GAAI,CAACC,EAAM,OACXC,EAAe,UAAUD,CAAI,EAC7B,KAAK,eAAiB,EAC1B,CACAC,EAAe,MAAMH,CAAM,IAGvBpH,EAAA,iBAAY,CAACwH,EAAgB5F,EAAkB6F,EAA+BC,EAAwB7F,KAC1G,KAAK,UAAUlC,CAAY,EACpB,IAAI,QAAyB0D,GAAA,CAC1B,MAAAsE,EAAgB,SAAS,cAAcF,CAAqB,EAClE,GAAIE,EAAe,CACf,MAAMC,EAAkB,IAAI,iBAAkBC,GAAc,CAC9CA,EAAA,QAASC,GAAc,CACzBJ,IACAE,EAAgB,WAAW,EACVZ,IACjBQ,EAAO,gBAAgB,EACfnE,IACZ,CACH,EACJ,EACDuE,EAAgB,QAAQD,EAAe,CAAE,UAAW,EAAM,GAC1DD,EAAW,QAAQ7F,CAAM,EACzB,MAAMkG,EAAU,KAAK,UAAU,IAAInG,CAAQ,EACvCmG,GACAJ,EAAc,UAAYI,EACjBpG,EAAAC,EAAU8F,EAAW,aAAc,IAEtC,MAAA9F,CAAQ,EACT,KAAKoG,GAAYA,EAAS,KAAK,EAC3B,KAAKD,GAAW,CACR,eAAU,IAAInG,EAAUmG,CAAO,EACpCJ,EAAc,UAAYI,EACjBpG,EAAAC,EAAU8F,EAAW,aAAc,GAC3BV,GACpB,EAAC,CAElB,EACH,IAGG,KAAKiB,EAAuD,CAChE,OAAIA,EAAU,UACFpG,GAAgB,KAAK,UAAU,KAAK,OAAQoG,EAAU,SAAUA,EAAU,IAAKA,EAAU,WAAYpG,CAAM,EAE5G,IAAM,KAAK,UAAU,KAAK,OAAQoG,EAAU,SAAUA,EAAU,IAAKA,EAAU,UAAU,CAExG,CAEO,UAAUC,EAAetG,EAAkB8F,EAAwBS,EAAmBC,EAAqBC,EAA0B,CAClI,MAAAC,EAAU,SAAS,cAAc,KAAK,EACpCA,EAAA,aAAa,SAAUJ,CAAK,EACpC,MAAMH,EAAU,KAAK,UAAU,IAAInG,CAAQ,EAC3C,OAAImG,GACAO,EAAQ,UAAYP,EACb,KAAK,eAAeO,EAASZ,EAAYS,EAAUC,EAAYC,CAAI,GAEnE,MAAMzG,CAAQ,EAChB,KAAKoG,GAAYA,EAAS,KAAK,EAC3B,KAAK,MAAMD,IACH,eAAU,IAAInG,EAAUmG,CAAO,EACpCO,EAAQ,UAAYP,EACb,KAAK,eAAeO,EAASZ,EAAYS,EAAUC,EAAYC,CAAI,EAC7E,CAAC,CAElB,CAEA,MAAc,eAAeE,EAAwBb,EAAwBS,EAAmBC,EAAqBC,EAA0B,CAC3I,MAAMG,EAAQ,MAAMC,GAAgB,OAAO,CAAE,UAAAF,CAAsB,GAC/DH,GAAkBI,EAAA,MAAM,YAAY,WAAY,MAAM,EACtDH,GAAMX,EAAW,QAAQW,CAAI,EACjCX,EAAW,QAAQW,CAAI,EACjBG,EAAA,UAAU,KAAK,IAAM,CAAmBxB,GAAA,CAAI,EAE7CmB,GACD,sBAAsB,IAAM,CACnBA,GAAoBI,EAAA,UAAU,OAAO,UAAU,EACvD,EAEL,KAAM,CAAE,KAAAG,CAAS,QAAMF,EAAM,aAAa,EACnC,OAAAE,CACX,CAEO,iBAAkB,CACrB,KAAK,OAAO,iBAChB,CAEO,KAAKC,EAAoB,CACvB,YAAS,IAAIC,GAAOD,EAAS,UAAU,KAAM,CAAE,KAAMA,EAAS,IAAM,GACzE,MAAME,EAAY,KAAK,KAAKF,EAAS,SAAS,EACrCA,EAAA,OAAO,QAASG,GAAU,CACzB,MAAAC,EAAS,KAAK,KAAKD,CAAK,EAC1BA,EAAM,UACN,KAAK,OAAO,GAAGA,EAAM,KAAOT,GAAc,CACtC,SAAS,cAAcS,EAAM,GAAG,EAAIC,EAAOV,EAAK,IAAI,EAAIQ,EAAA,EAAY,KAAK,IAAME,EAAOV,EAAK,IAAI,CAAC,GACjG,CACC,MAAMW,EAAMC,EAAQ,CACVH,EAAA,WAAW,SAAS,KAAMI,GAAqBF,EAAKE,CAAO,CAAC,CACtE,EACH,EAED,KAAK,OAAO,GAAGJ,EAAM,KAAM,IAAM,CACpB,uBAAcA,EAAM,GAAG,EAAIC,IAAWF,IAAY,KAAK,IAAME,EAAQ,IAC/E,CACC,MAAMC,EAAMC,EAAQ,CACVH,EAAA,WAAW,SAAS,KAAMI,GAAqBF,EAAKE,CAAO,CAAC,CACtE,EACH,CACL,CACH,EACD,KAAK,OAAO,SAChB,CACJ,CAEa,MAAAC,EAAe,IAAIhC,GC/IhC,MAAMiC,EAA0B,CAErB,WAAY,CACR,OAAAtJ,CACX,CAEO,SAAS4D,EAAe,CAC3B,MAAM2F,EAAkBvJ,EAAa,KAAawJ,KAAK,MAAQ5F,CAAK,EAChE2F,GAAiCA,EAAA,OAAO,QAAiBE,GAAA,CACzD,SAAS,gBAAgB,MAAM,YAAYA,EAAM,cAAeA,EAAM,KAAK,EAC5E,CACP,CAEO,cAAe,CAClB,OAAO/F,EAAqB,cAAc,UAC9C,CAEO,MAAO,CACL,cAAS,KAAK,aAAc,EACrC,CACJ,CAEa,MAAAgG,EAA4B,IAAIJ,GCzB7C,MAAMK,EAAc,CAEhB,MAAa,MAAqB,CAElC,CAEO,IAAIC,EAAgC,CAChC,aAAM,8CAA8CA,CAAG,GAAI,CAC9D,OAAQ,MACR,MAAO,cACV,CAEL,CACJ,CAEa,MAAAC,EAAgB,IAAIF,GCXjC,MAAMG,EAAiB,CAMnB,aAAc,CAJN5J,EAAA,kBACAA,EAAA,iBACAA,EAAA,uBAAwC,IAAID,EAEpC,CAEhB,IAAI,SAAkB,CAAE,OAAO,KAAK,QAAU,CAC9C,IAAI,gBAAuC,CAAE,OAAO,KAAK,eAAiB,CAEnE,YAAY8J,EAAiB,CAC3B,eAAU,YAAYA,CAAO,CACtC,CAEQ,cAAcC,EAAmBC,EAAe,CACpD,MAAMC,EAAO,KACR,eAAY,IAAI,OAAOF,CAAS,EACrC,KAAK,UAAU,iBAAiB,UAAW,SAAU3J,EAA6B,CACzE6J,EAAA,gBAAgB,OAAO7J,EAAM,IAAI,EACzC,EACI,eAAU,YAAY,KAAK,EAC5B4J,GAAW,eAAU,YAAY,oCAAoC,CAC7E,CAEA,MAAc,qBAAsB,CAC3B,mBAAc,+DAAgE,EAAI,CAC3F,CAEQ,2BAA4B,CAC3B,mBAAc,+EAAgF,EAAI,CAC3G,CAEQ,2BAA4B,CAC3B,mBAAc,6EAA8E,EAAI,CACzG,CAEQ,iBAAkB,CACjB,mBAAc,oCAAqC,EAAK,CACjE,CAEQ,kBAA4B,CAEhC,GADI,OAAO,SAAY,UACnB,OAAO,mBAAsB,WAAmB,SAChD,IAAAE,EACA,IAEI,GADEA,EAAA,IAAI,YAAY,OAAO,CAAE,OAAQ,GAAM,QAAS,EAAG,QAAS,CAAG,GACjE,EAAEA,EAAI,kBAAkB,mBAA2B,SAEhD,mBAAYA,EAAI,OAAQ,GAAG,OAC1B,CACD,QACX,CACA,OAAOA,EAAI,kBAAkB,iBACjC,CAEQ,gBAA2B,CAC/B,MAAM1J,EAAmB,GACrB,UAAO,aAAgB,UACvB,OAAO,YAAY,UAAa,YAChC,YAAY,SAAS,WAAW,KAAK,CAAC,EAAG,GAAI,IAAK,IAAK,EAAG,EAAG,EAAG,CAAC,CAAC,CAAC,IACnEA,EAAO,KAAK,MAAM,EACd,KAAK,oBAAoB,CACzBA,EAAO,KAAK,WAAW,EAEvB,MAAM2J,EAAiB,WAAW,KAAK,CAAC,EAAG,GAAI,IAAK,IAAK,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,IAAK,IAAK,EAAG,IAAK,GAAI,EAAG,IAAK,EAAG,IAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,IAAK,IAAK,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,IAAK,IAAK,EAAG,EAAE,CAAC,EACvP,YAAY,SAASA,CAAc,GAAG3J,EAAO,KAAK,MAAM,CAChE,CAEG,OAAAA,CACX,CAEO,MAAyB,CACrB,WAAI,QAAmB8C,GAAA,CACpB,MAAA8G,EAAqBN,GAAoB,CACtC,KAAK,WAAU,KAAK,SAAWA,GACpC,QAAQ,IAAIA,CAAO,EACJA,GAAX,SAEAxG,EAAQ,EAAI,CAChB,EAEC,qBAAgB,iBAAiB8G,CAAiB,EACjD,MAAAC,EAAW,KAAK,iBAClBA,EAAS,SAAS,MAAM,EACxB,KAAK,oBAAoB,EACpBA,EAAS,SAAS,WAAW,EAClC,KAAK,0BAA0B,EACxBA,EAAS,SAAS,MAAM,EAC/B,KAAK,0BAA0B,EAE/B,KAAK,gBAAgB,CACzB,CACH,CACL,CAEJ,CAEa,MAAAC,EAAmB,IAAIT,GC5FpC,MAAMU,EAAa,CAAnB,cAEYtK,EAAA,cAAuB,IAExB,UAAUuK,EAAe,CACxB,GAAA/G,EAAqB,cAAc,WAAY,CAC/C,MAAMgH,EAAc,KAAK,OAAO,KAAMlB,GAAkBA,EAAK,MAAQiB,CAAQ,EACzEC,IAAgBD,IAAU,QAAU,CAACC,EAAY,MAAM,YACvDA,EAAY,MAAM,MAE1B,CACJ,CAEO,MAAO,CACAC,GAAA,OAAO,QAAgBnB,GAAA,KAAK,OAAO,KAAK,CAAE,IAAKA,EAAK,IAAK,MAAO,IAAIoB,QAAK,CAAE,IAAK,CAACpB,EAAK,KAAK,CAAE,CAAC,CAAG,EAAC,CAChH,CACJ,CAEa,MAAAqB,EAAe,IAAIL,GCxBhC,MAAMM,EAAc,CAER,YAAa,CACX,MAAAC,EAAkB,SAAS,cAAc,mBAAmB,EAC9DA,GAAmBA,EAAgB,OAAO,CAClD,CAEQ,MAAO,CACF,0BAAiB,oBAAqB,IAAM,CACjD,MAAMC,EAAc,UAAU,SAC9B,IAAIC,EAAY,GACZC,EAAU,GACd,OAAO,KAAKC,CAAQ,EAAE,QAAS/H,GAAQ,CAC9B,OAAO,WAAW,iBACnB,OAAO,WAAW,eAAiBA,GAElC8H,IACG9H,GAAO4H,GACA,kBAAW,OAAO5H,EAAK+H,CAAQ,EAC5BD,EAAA,GACV,SAAS,gBAAgB,KAAO9H,GACzB,CAAC6H,GAAaD,EAAY,WAAW5H,CAAG,IACnC6H,EAAA7H,GAEpB,CACH,EACI8H,IACGD,GACO,kBAAW,OAAOA,EAAWE,CAAQ,EAC5C,SAAS,gBAAgB,KAAOF,IAEhC,OAAO,WAAW,OAAO,OAAO,WAAW,eAAgBE,CAAQ,EAC1D,yBAAgB,KAAO,OAAO,WAAW,gBAE1D,CACH,CACL,CAEO,MAAO,CACV,KAAK,KAAK,EACVC,EAAO,OAAOC,EAAU,EACxBD,EAAO,MAAM,EACb,KAAK,WAAW,CACpB,CAEJ,CAEa,MAAAE,GAAgB,IAAIR,GCxC1B,SAASS,IAAsB,CAC3B,OAAAlI,EAAe,OACjB,KAAK,IAAMK,EAAqB,MAAM,EACtC,KAAK,IAAM6G,EAAiB,KAAM,GAClC,KAAK,IAAMV,EAAc,MAAM,EAC/B,KAAK,IAAMgB,EAAa,MAAM,EAC9B,KAAK,IAAM/G,EAAqB,KAAM,GACtC,KAAK,IAAM4F,EAA0B,MAAM,EAC3C,KAAK,IAAMjF,EAAuB,KAAM,GACxC,KAAK,IAAM6G,GAAc,MAAM,CAGxC,CChBO,MAAME,CAAqC,CAC9C,QAAQC,EAAY,CACpB,CACA,cAAoB,CAChB,MAAO,EACX,CACA,QAAQC,EAA2B,CACnC,CACA,QAA2B,CAChB,WAAI,QAA4BnI,GAAA,CAAEA,EAAQ,EAAI,EAAI,CAC7D,CACJ,0BCZA,MAAMoI,WAAwBH,CAAe,CACzC,QAAQE,EAA2B,CACxBN,EAAA,KAAK,OAAQ,KAAO,CACvB,QAAAQ,GACA,MAAOC,GAAU,MAAM,IAAYrC,IAAS,CAAC,IAAKA,EAAK,IAAK,KAAM,OAAO,WAAW,EAAEA,EAAK,KAAM,CAAC,wBAA2Be,EAAiB,OAAQ,IAAK,CAC7J,GACN,CACJ,CAEa,MAAAuB,GAAkB,IAAIH,GCNnC,MAAMI,WAA2BP,CAAe,CAC5C,QAAQE,EAA2B,CAExBN,EAAA,KAAK,WAAY,KAAO,CAC3B,MAAOtH,EAAqB,aAAa,GAAK,OAAS,IAAM,IAE7D,WAAY,GACZ,OAAQA,EAAqB,UAAU,EACvC,cAAe,CACX,OAAOJ,EAAqB,cAAc,UAC9C,EACA,cAAe,CACN,gBAAa,CAAC,KAAK,WACxB,KAAK,gBAAkB,GACvB,KAAK,gBAAkB,EAC3B,EACA,SAASE,EAAe,CACpBE,EAAqB,SAASF,CAAK,EACnCF,EAAqB,cAAc,WAAaE,EAChD,KAAK,MAAQE,EAAqB,aAAa,GAAK,OAAS,IAAM,GACvE,EAEA,gBAAiB,GACjB,YAAa/D,EACb,kBAAmB2D,EAAqB,cAAc,WACtD,mBAAoB,CACX,qBAAkB,CAAC,KAAK,gBAC7B,KAAK,WAAa,GAClB,KAAK,gBAAkB,EAC3B,EACA,cAActC,EAAoB,CAC9B,KAAK,kBAAoBA,EACzBsC,EAAqB,cAAc,WAAatC,CACpD,EAEA,gBAAiB,GACjB,YAAapB,EACb,kBAAmB0D,EAAqB,cAAc,WACtD,mBAAoB,CACX,qBAAkB,CAAC,KAAK,gBAC7B,KAAK,WAAa,GAClB,KAAK,gBAAkB,EAE3B,EACA,cAAcsI,EAAoB,CAC9B,KAAK,kBAAoBA,EACzBtI,EAAqB,cAAc,WAAasI,EAChDtC,EAA0B,SAASsC,CAAU,CACjD,EAEA,WAAYtI,EAAqB,cAAc,WAC/C,kBAAkBuI,EAAkB,CAChC,KAAK,WAAaA,EAClBvI,EAAqB,cAAc,WAAauI,CACpD,EAEA,iBAAkBvI,EAAqB,cAAc,iBACrD,wBAAwBuI,EAAkB,CACtC,KAAK,iBAAmBA,EACxBvI,EAAqB,cAAc,iBAAmBuI,CAC1D,EAEA,UAAWvI,EAAqB,cAAc,UAC9C,iBAAiBuI,EAAkB,CAC/B,KAAK,UAAYA,EACjBvI,EAAqB,cAAc,UAAYuI,CACnD,EAEA,sBAAuBvI,EAAqB,cAAc,eAC1D,qBAAqBb,EAAe,CAChC,KAAK,sBAAwBA,EAC7Ba,EAAqB,cAAc,eAAiBb,CACxD,EAEA,yBAA0Ba,EAAqB,cAAc,kBAC7D,wBAAwBb,EAAe,CACnC,KAAK,yBAA2BA,EAChCa,EAAqB,cAAc,kBAAoBb,CAC3D,EAEA,MAAO,CACkBa,EAAA,OAAO,KAAK,SAAY,EAC3B,MAAMwI,EAAgB,OAAO,CACvC,QAAS,OAAO,WAAW,EAAE,wBAAwB,EACrD,SAAU,SACV,MAAO,UACP,SAAU,IACb,GACK,QAAQ,EACd,KAAK,MAAM,EACd,CACL,EACA,OAAQ,CACH,SAAS,cAAc,WAAW,EAAe,QAAQ,CAC9D,EACA,MAAO,CACG,MAAAC,EAAyB,SAAS,eAAe,wBAAwB,EACxDA,EAAA,iBAAiB,YAAa,IAAM,CAAO,6BAAwBA,EAAuB,OAAO,EAAI,EAEtH,MAAAC,EAAmB,SAAS,eAAe,kBAAkB,EAClDA,EAAA,iBAAiB,YAAa,IAAM,CAAO,uBAAkBA,EAAiB,OAAO,EAAI,EAEpG,MAAAC,EAAkB,SAAS,eAAe,iBAAiB,EACjDA,EAAA,iBAAiB,YAAa,IAAM,CAAO,sBAAiBA,EAAgB,OAAO,EAAI,EAEjG,MAAAC,EAAsB,SAAS,eAAe,qBAAqB,EACrDA,EAAA,MAAQ5I,EAAqB,cAAc,eAC3C4I,EAAA,iBAAiB,YAAa,IAAM,CAChD,OAAOA,EAAoB,OAAW,UAAe,0BAAqBA,EAAoB,KAAK,EAC1G,EAEK,MAAAC,EAAyB,SAAS,eAAe,wBAAwB,EACxDA,EAAA,MAAQ7I,EAAqB,cAAc,kBAC3C6I,EAAA,iBAAiB,YAAa,IAAM,CACnD,OAAOA,EAAuB,OAAW,UAAe,6BAAwBA,EAAuB,KAAK,EACnH,EAED,CAAC,aAAc,kBAAmB,iBAAiB,EAAE,QAAS/C,GAAS,CAC9D,YAAOA,EAAOgD,GAAW,CACTtF,GAAA,CACpB,EACJ,CACL,CACF,GACN,CACJ,CAEa,MAAAuF,GAAqB,IAAIV,GCjItC,MAAMW,WAAsBlB,CAAe,CACvC,QAAQE,EAA2B,CACxBN,EAAA,KAAK,OAAS,KAAO,CACxB,WAAY9J,EAAMmD,EAAuB,gBAAgB,UAAU,EACnE,iBAAkB,GAClB,eAAeP,EAAkB,CACzB,KAAK,kBAAoBA,GACzB,KAAK,iBAAmBA,EACnB,iBAAY,KAAK,IAAM,CAAEmF,EAAa,gBAAgB,EAAI,GAE/D,KAAK,iBAAmB,EAEhC,EACA,wBAAAhI,EACA,cAAe,CACXgI,EAAa,UAAU,WAAY,gBAAiBoD,GAAoB,GAAM,EAAK,CACvF,EACA,MAAO,CACoBhI,EAAA,8BAA8B,iBAAkBR,GAA8B,CAC5F,gBAAa3C,EAAM2C,EAAS,UAAU,EAC9C,EACD,CAAC,kBAAkB,EAAE,QAASuF,GAAS,CAC9B,YAAOA,EAAOgD,GAAW,CACTtF,GAAA,CACpB,EACJ,CACL,CACF,GACN,CACJ,CAEa,MAAAyF,GAAgB,IAAID,GClCjC,MAAME,WAAuBpB,CAAe,CACxC,QAAQE,EAA2B,CACxBN,EAAA,KAAK,OAAQ,KAAO,CACvB,WAAY3G,EAAuB,gBAAgB,UACrD,GACN,CACJ,CAEa,MAAAoI,EAAiB,IAAID,GCNlC,MAAME,WAAuBtB,CAAe,CAA5C,kCAEYtL,EAAA,cACAA,EAAA,YAER,QAAQ6M,EAA0B,CAC9B,MAAMhK,EAAkB0B,EAAuB,gBAC/C,IAAIuI,EAAajK,EAAgB,WACjC,MAAMkK,EAAc,SAASF,EAAa,WAAc,EAClDG,EAAiB,SAASH,EAAa,cAAiB,EACxD7I,EAAW8I,EAAWC,CAAW,EACjC9I,EAAcD,EAAS,cAAcgJ,CAAc,EACnDC,EAAqBjJ,EAAS,MAAQ,EAE5C,KAAK,MAAQ,GAAG,OAAO,WAAW,EAAE,YAAYA,EAAS,IAAI,EAAE,CAAC,MAAMgJ,EAAiB,CAAC,MAAMC,EAAqB,CAAC,KACpH,KAAK,IAAM,GAAG,OAAO,WAAW,EAAE,YAAYjJ,EAAS,IAAI,EAAE,CAAC,KAAKC,EAAY,IAAI,KAAK+I,EAAiB,CAAC,IAAIC,EAAqB,CAAC,GAE7H/B,EAAA,KAAK,OAAQ,KAAO,CACvB,MAAO,KAAK,MACZ,YAAA6B,EACA,eAAAC,EACA,SAAAhJ,EACA,YAAAC,EACA,UAAWA,EAAY,MAAM,OAC7B,mBAAAgJ,EACA,YAAaD,EAAiB,GAAKD,EAAc,EACjD,YAAa,EAAEA,IAAgBlK,EAAgB,MAAQ,GAAKmK,IAAmBC,GAC/E,QAAS,GACT,QAAS,GACT,KAAM,KAAK,KAAKhJ,EAAY,MAAM,OAAS,CAAC,EAC5C,aAAaiJ,EAAiB,CAC1B,QAAQ,IAAIA,CAAO,CACvB,EACA,wBAAA/L,EACA,MAAO,CAOC,GANmBoD,EAAA,8BAA8B,iBAAkBR,GAA8B,CACjG,MAAM+I,EAAa/I,EAAS,WAC5B,KAAK,SAAW3C,EAAM0L,EAAWC,CAAW,CAAC,EAC7C,KAAK,YAAc3L,EAAM,KAAK,SAAS,cAAc4L,CAAc,CAAC,EACvE,EAEGA,EAAiB,GAAKD,EAAc,EAAG,CACvC,IAAII,EAAS,KAAK,YACdC,EAAS,KAAK,eAAiB,EAC/BA,EAAS,IACXD,IACAC,EAASvK,EAAgB,WAAWsK,CAAM,EAAE,MAAQ,GAEtD,KAAK,QAAU,SAASA,CAAM,IAAIC,CAAM,EAC5C,CAEA,GAAI,EAAEL,IAAgBlK,EAAgB,MAAQ,GAAKmK,IAAmBC,GAAqB,CACvF,IAAIE,EAAS,KAAK,YACdC,EAAS,KAAK,eAAiB,EAC/BA,EAAS,KAAK,qBAChBD,IACSC,EAAA,GAEX,KAAK,QAAU,SAASD,CAAM,IAAIC,CAAM,EAC5C,CACJ,CACF,GACN,CAEA,cAAoB,CACT,OAAE,KAAQ,KAAK,IAC1B,CAEJ,CAEa,MAAAC,GAAiB,IAAIT,GCvElC,MAAMU,WAA4BhC,CAAe,CAAjD,kCACYtL,EAAA,eACR,QAAQuN,EAAgB,CACpB,KAAK,OAASA,CAClB,CACA,QAAQ/B,EAA2B,CACxBN,EAAA,KAAK,YAAa,KAAO,CAC5B,OAAQ,KAAK,OACb,kBAAmB1H,EAAqB,cAAc,WACtD,OAAOgK,EAAe,CACjB,SAAS,cAAc,WAAW,EAAe,QAAQ,CAAC,MAAAA,EAAa,CAC5E,CACF,GACN,CACJ,CAEa,MAAAC,GAAsB,IAAIH,GCRvC,MAAMI,WAA2BpC,CAAe,CAa9C,aAAc,CACN,QAZAtL,EAAA,YACAA,EAAA,aAAuB2N,GAAM,GAC7B3N,EAAA,cACAA,EAAA,oBACAA,EAAA,iBAAmCkL,EAAO,SAAS,CAAE,MAAO,EAAI,IAChElL,EAAA,eAEAA,EAAA,eACAA,EAAA,iBAAY,IACZA,EAAA,4BAAuB,IAI7BqK,EAAiB,eAAe,iBAAkBR,GAAoB,KAAK,iBAAiBA,CAAO,CAAC,CACtG,CAEQ,aAAc,CAGpB,GAAI,CAFY,MAAM,KAAK,SAAS,iBAAiB,YAAY,CAAC,EAC3C,KAAK+D,GAAUA,EAAO,aAAe,CAAC,EAChD,OACP,MAAAC,EAAY,SAAS,cAAc,YAAY,EAC/CC,EAAe,SAAS,cAAc,gBAAgB,EACtDC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAgB,SAAS,cAAc,iBAAiB,EACxDC,EAAiBL,EAAU,YAC3BM,EAAkBN,EAAU,aAClC,IAAIO,EAAU,KAAK,IAAIF,EAAgBC,CAAe,EACtD,MAAME,EAAMD,EAAU,EACtBA,EAAUA,EAAUC,EACPP,EAAA,MAAM,OAAS,GAAGM,CAAO,KACzBN,EAAA,MAAM,MAAQ,GAAGM,CAAO,KACjCF,EAAiBC,GACnBJ,EAAY,MAAM,MAAQ,GAAIG,EAAiBE,EAAU,CAAE,KAC3DL,EAAY,MAAM,OAAS,eAAeE,EAAc,YAAY,OAEpEF,EAAY,MAAM,MAAQ,OAC1BA,EAAY,MAAM,OAAS,GAAII,EAAkBC,EAAUH,EAAc,aAAe,CAAE,MAE5FD,EAAU,MAAM,OAAS,GAAGD,EAAY,aAAe,EAAE,KAC3CE,EAAA,MAAM,MAAQF,EAAY,MAAM,MACxC,MAAAO,EAAa,SAAS,eAAe,gBAAgB,EAC3DA,EAAM,MAAM,OAAS,GAAGR,EAAa,WAAW,KAChDQ,EAAM,MAAM,MAAQ,GAAGR,EAAa,YAAY,IAClD,CAEQ,SAASS,EAAa,CAE5B,GADK,eAAU,MAAQ,GACnBA,GAAO,GACT,OACI,MAAAC,EAAQD,EAAI,MAAM,GAAG,EAC3B,IAAIE,EAAM,EACVD,EAAM,QAAgBE,GAAA,CACpB,GAAID,EAAM,EAAG,CACX,IAAIE,EAAQD,EAAK,OAAO,MAAM,IAAK,CAAC,EAC/B,eAAU,MAAM,KAAKC,CAAK,CACjC,CACAF,GAAA,CACD,EACD,QAAQ,IAAI,KAAK,UAAU,KAAK,UAAU,KAAK,CAAC,CAClD,CAEQ,SAA2B,CAC3B,MAAAG,MAAY,IAClB,OAAAC,GAAQ,QAAaC,GAAA,CACb,MAAAC,EAAK,KAAK,MAAM,MAAM,CAAE,OAAQD,EAAG,QAAS,GAAM,EACpDC,EAAG,QAAQH,EAAM,IAAIE,EAAGC,EAAG,IAASC,KAAE,EAAE,CAAC,EAC9C,EACMJ,CACT,CAEA,QAAQ/B,EAA0B,CAChC,MAAM7C,EAAO,KACbzC,EAAe,IAAI5H,CAAY,EAAE,KAAK,SAAU2H,EAAM,CAChDA,IAAMA,EAAK,aAAe,IAC/B,EACI,eAAY9D,EAAqB,cAAc,UACpD,MAAMX,EAAkB0B,EAAuB,gBAC/C,IAAIuI,EAAajK,EAAgB,WAC7BkK,EACAC,EACAhJ,EACAC,EACAiJ,EACA/I,EACA8I,EACAgC,EAEE,MAAAC,EAAarC,EAAa,OAAY,OACxC,IAAAnD,EACAwF,GACFxF,EAAM,GAAGmD,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,IAAIA,EAAa,IAAO,GAChM,YAASA,EAAa,OAC3B,KAAK,IAAMnD,IAEGqD,EAAA,SAASF,EAAa,WAAc,EACjCG,EAAA,SAASH,EAAa,cAAiB,EACxD7I,EAAW8I,EAAWC,CAAW,EACnB9I,EAAAD,EAAS,cAAcgJ,CAAc,EACzCE,EAAA,SAASL,EAAa,OAAU,EACnC1I,EAAAF,EAAY,MAAMiJ,CAAO,EAChCD,EAAqBjJ,EAAS,MAAQ,EACtCiL,EAAchL,EAAY,MAAQ,EAClCyF,EAAMvF,EAAK,IACX,KAAK,OAASA,EAAK,OACnB,KAAK,IAAM,GAAG,OAAO,WAAW,EAAE,YAAYH,EAAS,IAAI,EAAE,CAAC,KAAKC,EAAY,IAAI,KAAKiJ,EAAU,CAAC,IAAI+B,EAAc,CAAC,IAGnH,WAAM,KAAKvF,CAAG,EACnB,KAAK,SAAS,KAAK,MAAM,IAAK,GAE9B,MAAMyF,EAAY,KAAK,MAAM,QAAU,IACjCC,EAAoBD,EAAY,QAAU,QAChD,KAAK,OAASC,EAER,MAAAC,GAAQF,EAAY,QAAU,QAC9BG,GAActO,EAAQmO,EAAY,SAAW,SAAU3L,EAAqB,cAAc,UAAU,EAC1G,KAAK,YAAc,CACjB,IAAK,KAAK,MAAM,IAAI,EACpB,YAAc,KAAK,MAAM,KAAK,GAAK,IAAM+L,EAAO,CAAC,EAAIA,EAAO,CAAC,EAC7D,SAAU,GACV,UAAAH,EACA,WAAY,CACV,QAAS,EACX,EACA,QAAS,CACP,KAAM,GACN,MAAOA,EACP,MAAO,KAAK,QAAQ,EACpB,UAAW5L,EAAqB,cAAc,iBAC9C,OAAQ,CACN,MAAO,CAACgM,EAAWC,EAAWC,IAA4B,CAAO,eAAUF,EAAMC,CAAI,CAAG,CAC1F,CACF,EACA,UAAW,CACT,SAAU,GACV,MAAO,EACT,EACA,UAAW,CACT,QAAS,GACT,aAAc,GACd,UAAW,EACb,EACA,WAAY,CACV,QAAS,EACX,GAEK,wBAAiB,SAAU,UAAY,CAC5CzF,EAAK,YAAY,EAClB,EAEMkB,EAAA,KAAK,OAAQ,KAAO,CACzB,WAAY1H,EAAqB,cAAc,WAC/C,WAAYA,EAAqB,cAAc,WAC/C,UAAA0L,EACA,IAAAxF,EACA,OAAQ,KAAK,OACb,YAAAqD,EACA,eAAAC,EACA,QAAAE,EACA,SAAAlJ,EACA,YAAAC,EACA,KAAAE,EACA,UAAW6F,EAAK,UAChB,KAAAqF,GACA,YAAAC,GACA,mBAAArC,EACA,YAAAgC,EACA,YAAajC,EAAiB,GAAKD,EAAc,GAAKG,EAAU,EAChE,YAAa,EAAEH,IAAgBlK,EAAgB,MAAQ,GAAKmK,IAAmBC,GAAsBC,IAAY+B,GACjH,QAAS,GACT,QAAS,GACT,QAAS,SAASlC,CAAW,IAAIC,CAAc,GAC/C,wBAAA7L,EACA,MAAO,KAAK,MACZ,MAAO,CA4BL,GA3BA6I,EAAK,MAAQ2F,GAAY,SAAS,eAAe,gBAAgB,EAAkB3F,EAAK,WAAW,EAEnG,sBAAsB,IAAM,CAC1BA,EAAK,YAAY,EAClB,EACsBzF,EAAA,8BAA8B,iBAAkBR,GAA8B,CACnG,MAAM+I,EAAa/I,EAAS,WAC5B,KAAK,SAAW3C,EAAM0L,EAAWC,CAAW,CAAC,EAC7C,KAAK,YAAc3L,EAAM,KAAK,SAAS,cAAc4L,CAAc,CAAC,EACpE,KAAK,KAAO5L,EAAM,KAAK,YAAY,MAAM8L,CAAO,CAAC,EAClD,EACD1J,EAAqB,cAAc,4BAA4B,iBAAkBrD,GAAU,CACzF,OAAQA,EAAM,MAAO,CACnB,IAAK,aAAmB,gBAAaA,EAAM,OAAO,WAAY,MAC9D,IAAK,aAAmB,gBAAaA,EAAM,OAAO,WAAY,MAC9D,IAAK,mBAAoB,CACnB6J,EAAK,YAAY,SACnBA,EAAK,MAAM,IAAI,CACb,QAAS,CAAE,UAAW7J,EAAM,OAAO,gBAAiB,EACrD,EAEH,KACF,CACA,IAAK,YAAkB6J,EAAA,UAAYxG,EAAqB,cAAc,UAAW,KACnF,EACD,EAEGwJ,EAAiB,GAAKD,EAAc,GAAKG,EAAU,EAAG,CACxD,IAAIC,EAAS,KAAK,YACdC,EAAS,KAAK,eACdF,EAAU,KAAK,QAAU,EACzBA,EAAU,IACZE,IACIA,EAAS,IACXD,IACSC,EAAAN,EAAWK,CAAM,EAAE,MAAQ,GAEtCD,EAAUJ,EAAWK,CAAM,EAAE,cAAcC,CAAM,EAAE,MAAQ,GAE7D,KAAK,QAAU,aAAaD,CAAM,IAAIC,CAAM,IAAIF,CAAO,EACzD,CAEI,KAAEH,IAAgBlK,EAAgB,MAAQ,GAAKmK,IAAmBC,GAAsBC,IAAY+B,GAAc,CACpH,IAAI9B,EAAS,KAAK,YACdC,EAAS,KAAK,eACdF,EAAU,KAAK,QAAU,EACzBA,EAAU,KAAK,cACjBE,IACIA,EAAS,KAAK,qBAChBD,IACSC,EAAA,GAEXF,EAAU,GAEZ,KAAK,QAAU,aAAaC,CAAM,IAAIC,CAAM,IAAIF,CAAO,EACzD,CACF,CACA,GACJ,CAEA,UAAUsC,EAAWC,EAAW,OAC1BD,GAAQ,MAAQC,GAAQ,SAExB9O,EAAA,KAAK,MAAM,IAAI6O,CAAI,IAAnB,YAAA7O,EAAsB,OAAQ,MAAQ8O,EAAK,OAAO,CAAC,GAAK,KAAOA,EAAK,OAAO,CAAC,GAAK,KACnFtG,EAAa,UAAU,YAAa,iBAAkBsE,GAAqB,GAAO,GAAM,KAAK,OAAO,CAAC,CAAC,EAAE,KAAM/E,GAAc,CAC1H,KAAK,aAAa8G,EAAMC,EAAM/G,EAAK,KAAK,EACzC,EAEI,kBAAa8G,EAAMC,EAAM,MAAS,EAE3C,CAEQ,aAAaG,EAAgBC,EAAgBC,EAAsD,CACzG,KAAK,MAAM,KAAK,CACd,KAAMF,EACN,GAAIC,EACJ,UAAAC,CAAA,CACD,EACGA,GACG,WAAM,IAAI,CAAE,IAAK,KAAK,MAAM,MAAO,EAC1C,QAAQ,IAAI,KAAK,MAAM,IAAK,GAE5B,KAAK,SAAS,KAAK,MAAM,IAAK,GAOzB,KAAK,gBACRnF,EAAa,UAAU,MAAM,EAE7B,KAAK,eAAe,EAExB,CAEQ,aAAuB,CACvB,MAAApK,EAAS,KAAK,MAAM,UAAU,EACpC,GAAIA,EAAQ,CACU,KAAK,SAArB,aAA+B,CAAC,KAAK,MAAM,aAC7C,GAAgB,KAAK,SAArB,aAA+B,KAAK,MAAM,gBAAkB,CAAC,KAAK,OAAO,WAAW,KAAK,MAAM,KAAK,CAAC,EACrGoK,EAAa,UAAU,SAAS,EAEhCA,EAAa,UAAU,MAAM,EAG3B,IAAAd,EACA,KAAK,MAAM,aAAa,EAChBA,EAAA,qBACH,KAAK,MAAM,aAAa,EACrBA,EAAA,qBACH,KAAK,MAAM,sBAAsB,EAC9BA,EAAA,gCACH,KAAK,MAAM,wBAAwB,EAChCA,EAAA,4BACH,KAAK,MAAM,QAAQ,EAChBA,EAAA,sBAEAA,EAAA,qBAEZkG,EAAgB,OAAO,CACrB,OAAQ,OAAO,WAAW,EAAE,oBAAoB,EAChD,QAAS,OAAO,WAAW,EAAE,GAAGlG,CAAO,EAAE,EACzC,QAAS,CACP,CACE,KAAM,OAAO,WAAW,EAAE,aAAa,EACvC,SAAU,gBACZ,CACF,EACD,EAAE,KAAcmG,KAAM,QAAS,EAElC,CACO,OAAAzP,CACT,CAGQ,eAAemJ,EAAa,CAClC,OAAOA,EAAI,UAAU,EAAGA,EAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,MAAO,EAAE,EAAE,QAAQ,MAAO,EAAE,EAAE,MAClF,CAEQ,gBAAiB,CACnB,IAAAuG,EACA,KAAK,WAAa,KAAK,eAAe,KAAK,MAAM,KAAK,GAAK,EAC7DA,EAAW,KAAK,cAEhBA,EAAW,KAAK,iBAElBA,EAAS,KAAK,IAAI,CACpB,CAEQ,eAAgB,CACtBtG,EAAc,IAAI,KAAK,MAAM,KAAK,EAC/B,KAAiB3B,KAAS,KAAK,EAAE,KAAaU,GAAA,CAC7C,QAAQ,IAAI,KAAK,UAAUA,CAAI,CAAC,EAE5B,IAAAwH,EADaxH,EAAK,MAAM,CAAC,EAAE,IACV,MAAM,oCAAoC,EACzD,MAAAyH,EAAOD,EAAM,CAAC,EACdE,EAAKF,EAAM,CAAC,EACZJ,EAAYI,EAAM,CAAC,EACpB,WAAM,KAAKC,EAAaC,CAAS,EACtC,KAAK,MAAM,KAAK,CAAE,KAAAD,EAAsB,GAAAC,EAAkB,UAAAN,EAAsB,EAChF,MAAMO,EAAO,KAAK,MAAM,KAAK,IAAM,IAAM,QAAU,QACnD,KAAK,MAAM,IAAI,CACb,IAAK,KAAK,MAAM,IAAI,EACpB,UAAWA,EACX,QAAS,CACP,MAAO,KAAK,QAAQ,CACtB,EACD,EACD,QAAQ,IAAI,KAAK,MAAM,IAAK,GAC5B,KAAK,SAAS,KAAK,MAAM,IAAK,GAC1B,KAAK,cACP,KAAK,MAAM,IAAI,CAAE,SAAU,EAAM,GAEjC1F,EAAa,UAAU,MAAM,CAC/B,CACD,GACC,MAAO2F,GAAS,CAChB,KAAK,UAAY,GACjBtE,EAAgB,OAAO,CACrB,QAAS,OAAO,WAAW,EAAE,uBAAuB,EACpD,SAAU,SACV,MAAO,UACP,SAAU,IACX,EAAE,KAAcuE,KAAM,QAAS,GAChC,KAAK,iBAAiB,EACvB,CAuFL,CAEQ,kBAAmB,CACzBlG,EAAiB,YAAY,gBAAgB,KAAK,MAAM,KAAK,EAAE,EAC/D,KAAK,qBAAuB,GACXA,EAAA,YAAY,YAAY7G,EAAqB,cAAc,cAAc,aAAaA,EAAqB,cAAc,kBAAoB,GAAI,EAAE,CACtK,CAEQ,iBAAiBqG,EAAiB,CACxC,GAAI,CAAC,KAAK,qBAAsB,OAE5B,IAAAqG,EACJ,GAAIA,EAAQrG,EAAQ,MAAM,6CAA6C,EAAG,CACxE,KAAK,qBAAuB,GAEtB,MAAAsG,EAAOD,EAAM,CAAC,EACdE,EAAKF,EAAM,CAAC,EACZJ,EAAaI,EAAM,CAAC,GAAK,KAAOA,EAAM,CAAC,GAAK,KAAOA,EAAM,CAAC,GAAK,KAAOA,EAAM,CAAC,GAAK,IAAOA,EAAM,CAAC,EAAI,OACrG,WAAM,KAAKC,EAAaC,CAAS,EACtC,KAAK,MAAM,KAAK,CAAE,KAAAD,EAAsB,GAAAC,EAAkB,UAAAN,EAAsB,EAChF,MAAMO,EAAO,KAAK,MAAM,KAAK,IAAM,IAAM,QAAU,QAQnD,KAAK,MAAM,IAAI,CACb,IAAK,KAAK,MAAM,IAAI,EACpB,UAAWA,EACX,QAAS,CACP,MAAOA,EACP,MAAO,KAAK,QAAQ,CACtB,EACD,EACD,QAAQ,IAAI,KAAK,MAAM,IAAK,GAC5B,KAAK,SAAS,KAAK,MAAM,IAAK,GAC1B,KAAK,cACP,KAAK,MAAM,IAAI,CAAE,SAAU,EAAM,GAEjC1F,EAAa,UAAU,MAAM,CAEjC,CACF,CAEA,cAAoB,CACX,OAAE,KAAQ,KAAK,IACxB,CAEA,QAA2B,CAClB,WAAI,QAAiB,MAAMtH,GAAW,EAC7B,MAAM0M,EAAgB,OAAO,CACzC,OAAQ,OAAO,WAAW,EAAE,8BAA8B,EAC1D,QAAS,OAAO,WAAW,EAAE,+BAA+B,EAC5D,QAAS,CACP,CACE,KAAM,OAAO,WAAW,EAAE,0BAA0B,EACpD,KAAM,SACN,SAAU,iBACV,QAAS,IAAM,CACb1M,EAAQ,EAAK,CACf,CACF,EAAG,CACD,KAAM,OAAO,WAAW,EAAE,2BAA2B,EACrD,SAAU,iBACV,QAAS,IAAM,CACbgH,EAAiB,YAAY,MAAM,EACnC9C,EAAe,IAAI5H,CAAY,EAAE,KAAK,SAAU2H,EAAM,CAChDA,IAAMA,EAAK,aAAe,IAC/B,EACDjE,EAAQ,EAAI,CACd,CACF,CACF,EACD,GACK,QAAQ,EACf,CACH,CAEF,CAEa,MAAAmN,EAAqB,IAAI9C,GChiBzB+C,GAAY,CACrB,KAAM,GACN,UAAW,CACP,KAAM,yBACN,SAAU,WACV,IAAK,UACL,WAAYhE,GACZ,UAAW,EACf,EACA,OAAQ,CACJ,CACI,KAAM,IACN,SAAU,YACV,IAAK,oBACL,WAAYE,EACZ,UAAW,EACf,EACA,CACI,KAAM,QACN,SAAU,YACV,IAAK,oBACL,WAAYA,EACZ,UAAW,EACf,EACA,CACI,KAAM,SACN,SAAU,aACV,IAAK,oBACL,WAAYf,GACZ,UAAW,EACf,EACA,CACI,KAAM,YACN,SAAU,gBACV,IAAK,oBACL,WAAYW,GACZ,UAAW,EACf,EACA,CACI,KAAM,qCACN,SAAU,YACV,IAAK,oBACL,WAAYc,GACZ,UAAW,EACf,EACA,CACI,KAAM,kDACN,SAAU,gBACV,IAAK,oBACL,WAAYmD,EACZ,UAAW,EACf,EACA,CACI,KAAM,uDACN,SAAU,gBACV,IAAK,oBACL,WAAYA,EACZ,UAAW,EACf,EACA,CACI,KAAM,+DACN,SAAU,gBACV,IAAK,oBACL,WAAYA,EACZ,UAAW,EACf,EACA,CACI,KAAM,aACN,SAAU,iBACV,IAAK,oBACL,WAAY/C,GACZ,UAAW,EACf,CACJ,CACJ,ECvEApC,GAAoB,EAAE,KAAK,IAAM,CAAElC,EAAa,KAAKsH,EAAS,CAAG,CAAC","names":["MAIN_MENU_ID","THEMES","PIECE_THEMES","BOARD_THEMES","EventEmitter","__publicField","listener","idx","event","_listeners","textToImages","text","result","words","cont","themeColor","_a","color","word","image","x","urlIcon","icon","pieceTheme","ariaDescriptionFromIcon","clone","object","setTitle","newTitle","setMeta","name","newValue","setupSEO","template","params","page","Configuration","_useSyzygy","_stockfishDepth","_stockfishMovetime","_automaticShowFirstPosition","_preventScreenOff","_colorTheme","_playSounds","_fullScreen","_highlightSquares","_pieceTheme","_boardTheme","value","DEFAULT_CONFIG","endgameDatabase","endgamedatabaseJson","StorageService","Storage","Drivers","key","storageService","ConfigurationService","resolve","config","cfg","configurationService","ThemeSwitcherService","theme","_b","themeSwitcherService","EndgameDatabaseService","localDatabase","database","category","subcategory","defaultDatabase","game","localCategory","localSubcategory","localGame","endgameDatabaseService","tryDefine","impl","tag","initialize","IonAlert","IonApp","IonButton","IonButtons","IonCardContent","IonCardHeader","IonCard","IonCardTitle","IonCol","IonContent","IonFabButton","IonFab","IonFabList","IonFooter","IonGrid","IonHeader","IonIcon","IonItem","IonLabel","IonMenuButton","IonMenu","IonMenuToggle","IonModal","IonRange","IonRippleEffect","IonRouterLink","IonRouterOutlet","IonRow","IonSegmentButton","IonSegment","IonSplitPane","IonTitle","IonToast","IonToggle","IonToolbar","images","redrawIconImages","el","url","RouteService","menuId","query","menu","menuController","navigo","targetElementSelector","controller","targetElement","elementObserver","mutations","_mutation","content","response","routeItem","xData","pageMode","autoHeight","info","element","component","modal","modalController","data","routeMap","Navigo","mainRoute","route","oRoute","done","_match","canExit","routeService","BoardThemeSwitcherService","themeDefinition","item","style","boardThemeSwitcherService","SyzygyService","fen","syzygyService","StockfishService","message","engineUrl","nnue","self","mem","sourceWithSimd","stockfishListener","features","stockfishService","SoundService","sound","soundToPlay","soundJson","Howl","soundService","AlpineService","loaderContainer","browserLang","candidate","created","i18nJson","Alpine","AlpineI18n","alpineService","services_initialize","BaseController","_info","_$routeParams","AboutController","version","aboutJson","aboutController","SettingsController","boardTheme","checked","toastController","toggleHighlightSquares","togglePlaySounds","toggleUseSyzygy","stockfishDepthRange","stockfishMovetimeRange","_value","settingsController","AppController","appController","HomeController","homeController","ListController","$routeParams","categories","idxCategory","idxSubcategory","idxLastSubcategory","idxGame","idxCat","idxSub","listController","PromotionController","player","piece","promotionController","PositionController","Chess","header","container","boardWrapper","infoWrapper","infoMoves","actionButtons","containerWidth","containerHeight","minSize","mod","board","pgn","parts","pos","part","moves","dests","SQUARES","s","ms","m","idxLastGame","customFen","turnWhite","turnColor","move","targetImage","colors","orig","dest","_metadata","Chessground","source","target","promotion","alertController","alert","moveFunk","match","from","to","turn","_err","toast","positionController","ROUTE_MAP"],"sources":["../../code/src/commons/constants.ts","../../code/src/commons/event-emitter.ts","../../code/src/commons/utils.ts","../../code/src/model/configuration.ts","../../code/src/model/endgame-database.ts","../../code/src/services/storage-service.ts","../../code/src/services/configuration-service.ts","../../code/src/services/theme-switcher-service.ts","../../code/src/services/endgame-database-service.ts","../../code/src/services/ionic.ts","../../code/src/services/route-service.ts","../../code/src/services/board-theme-switcher-service.ts","../../code/src/services/syzygy-service.ts","../../code/src/services/stockfish-service.ts","../../code/src/services/sound-service.ts","../../code/src/services/alpine-service.ts","../../code/src/services/services.ts","../../code/src/controllers/controller.ts","../../code/src/controllers/about.ts","../../code/src/controllers/settings.ts","../../code/src/controllers/app.ts","../../code/src/controllers/home.ts","../../code/src/controllers/list.ts","../../code/src/controllers/promotion.ts","../../code/src/controllers/position.ts","../../code/src/routes.ts","../../code/src/main.ts"],"sourcesContent":["export const MAIN_MENU_ID = 'main-menu';\nexport const THEMES = [\n    {\n        'name': 'dark',\n        'class': 'dark',\n        'mainColor': '#000000'\n    },\n    {\n        'name': 'light',\n        'class': '',\n        'mainColor': '#ffffff'\n    }\n];\n\nexport const PIECE_THEMES = ['alpha', 'california', 'cburnett', 'chess7', 'chessnut', 'chicago', 'companion', 'fantasy', 'iowa', 'kosal', 'leipzig', 'letter', 'merida', 'mono', 'oslo', 'pirouetti', 'pixel', 'reilly', 'riohacha', 'shapes', 'spatial', 'symmetric'];\n\nexport const BOARD_THEMES = [\n    {\n      'name': 'brown',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#F3E1C2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#C39976' },\n        { 'themeVariable': '--chess-black-background', 'value': '#C39976' },\n        { 'themeVariable': '--chess-black-color', 'value': '#F3E1C2' },\n      ]\n    },\n    {\n      'name': 'blue',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#E4E9EB' },\n        { 'themeVariable': '--chess-white-color', 'value': '#9DB1BB' },\n        { 'themeVariable': '--chess-black-background', 'value': '#9DB1BB' },\n        { 'themeVariable': '--chess-black-color', 'value': '#E4E9EB' },\n      ]\n    },\n    {\n      'name': 'green',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#FFFEE4' },\n        { 'themeVariable': '--chess-white-color', 'value': '#97B378' },\n        { 'themeVariable': '--chess-black-background', 'value': '#97B378' },\n        { 'themeVariable': '--chess-black-color', 'value': '#FFFEE4' },\n      ]\n    },\n    {\n      'name': 'grey',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#AAAAAA' },\n        { 'themeVariable': '--chess-white-color', 'value': '#888888' },\n        { 'themeVariable': '--chess-black-background', 'value': '#888888' },\n        { 'themeVariable': '--chess-black-color', 'value': '#AAAAAA' },\n      ]\n    },\n    {\n      'name': 'pink',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#FFF2F2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#BC4545' },\n        { 'themeVariable': '--chess-black-background', 'value': '#BC4545' },\n        { 'themeVariable': '--chess-black-color', 'value': '#FFF2F2' },\n      ]\n    },\n    {\n      'name': 'navy',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#ECECEC' },\n        { 'themeVariable': '--chess-white-color', 'value': '#385170' },\n        { 'themeVariable': '--chess-black-background', 'value': '#385170' },\n        { 'themeVariable': '--chess-black-color', 'value': '#ECECEC' },\n      ]\n    },\n    {\n      'name': 'dark-green',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#E0EFBA' },\n        { 'themeVariable': '--chess-white-color', 'value': '#467A4B' },\n        { 'themeVariable': '--chess-black-background', 'value': '#467A4B' },\n        { 'themeVariable': '--chess-black-color', 'value': '#E0EFBA' },\n      ]\n    },\n    {\n      'name': 'black-white',\n      'styles': [\n        { 'themeVariable': '--chess-white-background', 'value': '#F2F2F2' },\n        { 'themeVariable': '--chess-white-color', 'value': '#0C0C0C' },\n        { 'themeVariable': '--chess-black-background', 'value': '#0C0C0C' },\n        { 'themeVariable': '--chess-black-color', 'value': '#F2F2F2' },\n      ]\n    }\n  ];","export class EventEmitter<T> {\n  private _listeners: ((event: T) => void)[] = [];\n\n  constructor() { }\n\n  public addEventListener(listener: (event: T) => void) {\n    if (!this._listeners.includes(listener)) {\n      this._listeners.push(listener);\n    }\n  }\n\n  public removeEventListener(listener: (event: T) => void) {\n    const idx = this._listeners.indexOf(listener);\n    if (idx !== -1) {\n      this._listeners.splice(idx, 1);\n    }\n  }\n\n  public removeListeners() {\n    this._listeners = [];\n  }\n\n  public notify(event: T) {\n    this._listeners.forEach((_listeners) => {\n      _listeners(event);\n    });\n  }\n}\n","export const textToImages = (text: string) => {\n    const result: string[] = [];\n    const words = text.split(\" \");\n    let cont = 1;\n    let themeColor = document.querySelector('body')?.classList.contains('dark') ? 'w' : 'b';\n    let color = 'w';\n    words.forEach(word => {\n        let image;\n        word = word.toUpperCase();\n        if (word == 'ONE') {\n            cont = 1;\n        } else if (word == 'TWO') {\n            cont = 2;\n        } else if (word == 'THREE') {\n            image = `${themeColor}3.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'FOUR') {\n            image = `${themeColor}4.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'FIVE') {\n            image = `${themeColor}5.svg`;\n            result.push(image);\n            cont = 1;\n        } else if (word == 'VS') {\n            image = `${themeColor}swords.svg`;\n            result.push(image);\n            color = 'b';\n        } else if (word.lastIndexOf('KING', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}K.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('QUEEN', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}Q.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('ROOK', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}R.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('BISHOP', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}B.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('KNIGHT', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}N.svg`\n                result.push(image);\n            }\n            cont = 1;\n        } else if (word.lastIndexOf('PAWN', 0) === 0) {\n            for (let x = cont; x > 0; x--) {\n                image = `${color}P.svg`\n                result.push(image);\n            }\n            cont = 1;\n        }\n    });\n    return result;\n};\n\nexport const urlIcon = (icon: string, pieceTheme: string) => {\n    if (icon.includes('3.svg') || icon.includes('4.svg') || icon.includes('5.svg') || icon.includes('swords.svg') || icon.includes('elementary.svg')) {\n        return `assets/icons/${icon}`;\n    }\n    else {\n        return `assets/pieces/${pieceTheme}/${icon}`;\n    }\n};\n\nexport const ariaDescriptionFromIcon = (icon: string) => {\n    if (icon.endsWith('3.svg')) return 'three';\n    else if (icon.endsWith('4.svg')) return 'four';\n    else if (icon.endsWith('5.svg')) return 'five';\n    else if (icon.endsWith('elementary.svg')) return 'elementary';\n    else if (icon.endsWith('swords.svg')) return 'against';\n    else if (icon.endsWith('B.svg')) return 'bishop';\n    else if (icon.endsWith('K.svg')) return 'king';\n    else if (icon.endsWith('N.svg')) return 'knight';\n    else if (icon.endsWith('P.svg')) return 'pawn';\n    else if (icon.endsWith('Q.svg')) return 'queen';\n    else if (icon.endsWith('R.svg')) return 'rook';\n    else return 'unknown';\n};\n\nexport const clone = (object: any) => {\n    return JSON.parse(JSON.stringify(object));\n};\n\nconst setTitle = (newTitle: string) => {\n    window.document.title = newTitle;\n};\n\nconst setMeta = (name: string, newValue: string) => {\n    (window.document.getElementsByName(name)[0] as HTMLMetaElement).content = newValue;\n}\n\nexport const setupSEO = (template: string, params: any) => {\n    const page = template.replace('.html', '');\n    setTitle(window.AlpineI18n.t(`${page}.seo.title`, params));\n    setMeta('description', window.AlpineI18n.t(`${page}.seo.meta_description`, params));\n};","import { BOARD_THEMES, PIECE_THEMES, EventEmitter } from '../commons';\n\nexport type ConfigurationField =\n\n    'useSyzygy' | 'stockfishDepth' | 'stockfishMovetime' | 'automaticShowFirstPosition' | 'preventScreenOff' | 'colorTheme' | 'playSounds' | 'fullScreen' | 'highlightSquares' | 'pieceTheme' | 'boardTheme';\n\nexport type ConfigurationChangedEvent = { config: Configuration, field: ConfigurationField };\n\nexport class Configuration {\n\n    private _configurationChangedEmitter: EventEmitter<ConfigurationChangedEvent> = new EventEmitter<ConfigurationChangedEvent>();\n\n    constructor(\n        private _useSyzygy: boolean,\n        private _stockfishDepth: number,\n        private _stockfishMovetime: number,\n        private _automaticShowFirstPosition: boolean,\n        private _preventScreenOff: boolean,\n        private _colorTheme: string,\n        private _playSounds: boolean,\n        private _fullScreen: boolean,\n        private _highlightSquares: boolean,\n        private _pieceTheme: string,\n        private _boardTheme: string\n    ) { }\n\n    public serialize() {\n        return {\n            useSyzygy: this._useSyzygy,\n            stockfishDepth: this._stockfishDepth,\n            stockfishMovetime: this._stockfishMovetime,\n            automaticShowFirstPosition: this._automaticShowFirstPosition,\n            preventScreenOff: this._preventScreenOff,\n            colorTheme: this._colorTheme,\n            playSounds: this._playSounds,\n            fullScreen: this._fullScreen,\n            highlightSquares: this._highlightSquares,\n            pieceTheme: this._pieceTheme,\n            boardTheme: this._boardTheme\n        };\n    }\n\n    get configuration(): Configuration { return this; }\n    get configurationChangedEmitter(): EventEmitter<ConfigurationChangedEvent> { return this._configurationChangedEmitter; }\n\n    get useSyzygy(): boolean { return this._useSyzygy; }\n    set useSyzygy(value: boolean) { this._useSyzygy = value; this._configurationChangedEmitter.notify({ config: this, field: 'useSyzygy' }); }\n\n    get stockfishDepth(): number { return this._stockfishDepth; }\n    set stockfishDepth(value: number) { this._stockfishDepth = value; this._configurationChangedEmitter.notify({ config: this, field: 'stockfishDepth' }); }\n\n    get stockfishMovetime(): number { return this._stockfishMovetime; }\n    set stockfishMovetime(value: number) { this._stockfishMovetime = value; this._configurationChangedEmitter.notify({ config: this, field: 'stockfishMovetime' }); }\n\n    get automaticShowFirstPosition(): boolean { return this._automaticShowFirstPosition; }\n    set automaticShowFirstPosition(value: boolean) { this._automaticShowFirstPosition = value; this._configurationChangedEmitter.notify({ config: this, field: 'automaticShowFirstPosition' }); }\n\n    get preventScreenOff(): boolean { return this._preventScreenOff; }\n    set preventScreenOff(value: boolean) { this._preventScreenOff = value; this._configurationChangedEmitter.notify({ config: this, field: 'preventScreenOff' }); }\n\n    get colorTheme(): string { return this._colorTheme; }\n    set colorTheme(value: string) { this._colorTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'colorTheme' }); }\n\n    get playSounds(): boolean { return this._playSounds; }\n    set playSounds(value: boolean) { this._playSounds = value; this._configurationChangedEmitter.notify({ config: this, field: 'playSounds' }); }\n\n    get fullScreen(): boolean { return this._fullScreen; }\n    set fullScreen(value: boolean) { this._fullScreen = value; this._configurationChangedEmitter.notify({ config: this, field: 'fullScreen' }); }\n\n    get highlightSquares(): boolean { return this._highlightSquares; }\n    set highlightSquares(value: boolean) { this._highlightSquares = value; this._configurationChangedEmitter.notify({ config: this, field: 'highlightSquares' }); }\n\n    get pieceTheme(): string { return this._pieceTheme; }\n    set pieceTheme(value: string) { this._pieceTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'pieceTheme' }); }\n\n    get boardTheme(): string { return this._boardTheme; }\n    set boardTheme(value: string) { this._boardTheme = value; this._configurationChangedEmitter.notify({ config: this, field: 'boardTheme' }); }\n\n}\n\nexport const DEFAULT_CONFIG = new Configuration(\n    true,\n    15,\n    5,\n    true,\n    true,\n    'dark',\n    true,\n    true,\n    true,\n    PIECE_THEMES[0],\n    BOARD_THEMES[0].name\n);\n","import { Category } from './category';\nimport { endgamedatabaseJson } from '../static';\n\nexport interface EndgameDatabase {\n    version: string;\n    categories: Category[];\n    count: number;\n}\n\nexport const endgameDatabase: EndgameDatabase = <any>endgamedatabaseJson;","import { Drivers, Storage } from '@ionic/storage';\n\nclass StorageService {\n    private store = new Storage({ name: 'CET_STORAGE', driverOrder: [ Drivers.IndexedDB, Drivers.LocalStorage ] });\n\n    public async init(): Promise<any> {\n        return this.store.create();\n    }\n\n    public get(key: string) {\n        return this.store.get(key);\n    }\n    \n    public set(key: string, value: any) {\n        return this.store.set(key, value);\n    }\n    \n    public remove(key: string) {\n        return this.store.remove(key);\n    }\n\n}\n\nexport const storageService = new StorageService();\n","import { Configuration, DEFAULT_CONFIG } from '../model';\nimport { storageService } from './storage-service';\n\nclass ConfigurationService {\n\n    private _configuration!: Configuration;\n\n    get configuration(): Configuration { return this._configuration; }\n\n    constructor() { }\n\n    public init(): Promise<Configuration> {\n        return new Promise<Configuration>(resolve => {\n            storageService.get('CONFIGURATION').then(config => {\n                if (config) {\n                    if (config.useSyzygy === undefined) config.useSyzygy = DEFAULT_CONFIG.useSyzygy;\n                    if (config.stockfishDepth === undefined) config.stockfishDepth = DEFAULT_CONFIG.stockfishDepth;\n                    if (config.stockfishMovetime === undefined) config.stockfishMovetime = DEFAULT_CONFIG.stockfishMovetime;\n                    if (config.automaticShowFirstPosition === undefined) config.automaticShowFirstPosition = DEFAULT_CONFIG.automaticShowFirstPosition;\n                    if (config.preventScreenOff === undefined) config.preventScreenOff = DEFAULT_CONFIG.preventScreenOff;\n                    if (config.colorTheme === undefined) config.colorTheme = DEFAULT_CONFIG.colorTheme;\n                    if (config.playSounds === undefined) config.playSounds = DEFAULT_CONFIG.playSounds;\n                    if (config.fullScreen === undefined) config.fullScreen = DEFAULT_CONFIG.fullScreen;\n                    if (config.highlightSquares === undefined) config.highlightSquares = DEFAULT_CONFIG.highlightSquares;\n                    if (config.pieceTheme === undefined) config.pieceTheme = DEFAULT_CONFIG.pieceTheme;\n                    if (config.boardTheme === undefined) config.boardTheme = DEFAULT_CONFIG.boardTheme;\n                    this._configuration = new Configuration(\n                        config.useSyzygy,\n                        config.stockfishDepth,\n                        config.stockfishMovetime,\n                        config.automaticShowFirstPosition,\n                        config.preventScreenOff,\n                        config.colorTheme,\n                        config.playSounds,\n                        config.fullScreen,\n                        config.highlightSquares,\n                        config.pieceTheme,\n                        config.boardTheme\n                    );\n                    resolve(this._configuration);\n                } else {\n                    this._configuration = DEFAULT_CONFIG;\n                    this.save().then(cfg => {\n                        resolve(cfg);\n                    });\n                }\n            });\n        });\n    }\n\n    public save(): Promise<Configuration> {\n        return storageService.set('CONFIGURATION', this._configuration.serialize());\n    }\n\n}\n\nexport const configurationService = new ConfigurationService();\n","import { THEMES } from '../commons';\nimport { configurationService } from './configuration-service';\n\nclass ThemeSwitcherService {\n\n    public getThemes() {\n        return THEMES;\n    }\n\n    public setTheme(theme: string) {\n        if ('dark' == theme)\n            document.querySelector('body')?.classList.add('dark');\n        else\n            document.querySelector('body')?.classList.remove('dark');\n    }\n\n    public currentTheme() {\n        return document.querySelector('body')?.classList.contains('dark') ? 'dark' : 'light';\n    }\n\n    public init() {\n        this.setTheme(configurationService.configuration.colorTheme);\n    }\n}\n\nexport const themeSwitcherService = new ThemeSwitcherService();\n","import { EndgameDatabase, endgameDatabase } from '../model';\nimport { configurationService } from './configuration-service';\nimport { storageService } from './storage-service';\nimport { EventEmitter, textToImages, urlIcon } from '../commons';\nimport { themeSwitcherService } from './theme-switcher-service';\n\nclass EndgameDatabaseService {\n    private _endgameDatabase!: EndgameDatabase;\n    private _endgameDatabaseChangedEmitter: EventEmitter<EndgameDatabase> = new EventEmitter<EndgameDatabase>();\n\n    get endgameDatabase(): EndgameDatabase { return this._endgameDatabase; }\n    get endgameDatabaseChangedEmitter(): EventEmitter<EndgameDatabase> { return this._endgameDatabaseChangedEmitter; }\n\n    public async init(): Promise<boolean> {\n        return new Promise(resolve => {\n            this.getLocalDatabase().then((localDatabase: EndgameDatabase) => {\n                this._endgameDatabase = this.reconcileDatabases(localDatabase, endgameDatabase);\n                this.enrich(this.endgameDatabase, configurationService.configuration.pieceTheme);\n                configurationService.configuration.configurationChangedEmitter.addEventListener((event) => {\n                    if (event.field == 'pieceTheme') this.enrich(this.endgameDatabase, event.config.pieceTheme);\n                });\n                /////////////// TO DO: eliminar esto, es para el sitemap.xml\n                /*\n                this._endgameDatabase.categories.forEach( (category, idxCategory) => {\n                    category.subcategories.forEach((subcategory, idxSubcategory) => {\n                        console.log(`<url><loc>https://server.mydomain.local:5173/chess-endgame-training/list/${idxCategory}/${idxSubcategory}</loc><priority>0.7</priority><changefreq>weekly</changefreq></url>`);\n                        subcategory.games.forEach((_position, idxPosition) => {\n                            console.log(`<url><loc>https://server.mydomain.local:5173/chess-endgame-training/position/${idxCategory}/${idxSubcategory}/${idxPosition}</loc><priority>0.6</priority><changefreq>weekly</changefreq></url>`);\n                        });\n                    });\n                });\n                */\n                //////////////\n                resolve(true);\n            });\n        });\n    }\n\n    private getLocalDatabase(): Promise<EndgameDatabase> {\n        return storageService.get('ENDGAME_DATABASE');\n    }\n\n    private enrich(database: EndgameDatabase, pieceTheme: string) {\n        const color = themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b';\n        database.count = database.categories.length;\n        database.categories.forEach(category => {\n          category.count = category.subcategories.length;\n          category.iconUrls = [];\n          category.icons.forEach(icon => category.iconUrls.push(urlIcon(`${color}${icon}`, pieceTheme)));\n          category.subcategories.forEach(subcategory => {\n            subcategory.count = subcategory.games.length;\n            subcategory.images = textToImages(subcategory.name);\n            subcategory.imageUrls = [];\n            subcategory.images.forEach(image => subcategory.imageUrls.push(urlIcon(image, pieceTheme)));\n          });\n        });\n        this._endgameDatabaseChangedEmitter.notify(database);\n    }\n\n    private reconcileDatabases(localDatabase: EndgameDatabase, defaultDatabase: EndgameDatabase): EndgameDatabase {\n        if (!localDatabase) {\n            storageService.set('ENDGAME_DATABASE', defaultDatabase);\n            return defaultDatabase;\n        }\n        if (localDatabase.version && localDatabase.version === defaultDatabase.version) {\n            return localDatabase;\n        }\n        // recover records\n        defaultDatabase.categories.forEach(category => {\n            category.subcategories.forEach(subcategory => {\n                subcategory.games.forEach(game => {\n                    const localCategory = localDatabase.categories.find(x => x.name === category.name);\n                    if (localCategory) {\n                        const localSubcategory = localCategory.subcategories.find(x => x.name === subcategory.name);\n                        if (localSubcategory) {\n                            const localGame = localSubcategory.games.find(x => x.fen === game.fen);\n                            if (localGame && localGame.record) {\n                                game.record = localGame.record;\n                            }\n                        }\n                    }\n                });\n            });\n        });\n        storageService.set('ENDGAME_DATABASE', defaultDatabase);\n        return defaultDatabase;\n    }\n}\n\nexport const endgameDatabaseService = new EndgameDatabaseService();","import { initialize } from '@ionic/core/components';\n\n// import { IonAccordionGroup } from '@ionic/core/components/ion-accordion-group';\n// import { IonAccordion } from '@ionic/core/components/ion-accordion';\n// import { IonActionSheet } from '@ionic/core/components/ion-action-sheet';\nimport { IonAlert } from '@ionic/core/components/ion-alert';\nimport { IonApp } from '@ionic/core/components/ion-app';\n// import { IonAvatar } from '@ionic/core/components/ion-avatar';\n//import { IonBackButton } from '@ionic/core/components/ion-back-button';\n// import { IonBackdrop } from '@ionic/core/components/ion-backdrop';\n// import { IonBadge } from '@ionic/core/components/ion-badge';\n// import { IonBreadcrumb } from '@ionic/core/components/ion-breadcrumb';\n// import { IonBreadcrumbs } from '@ionic/core/components/ion-breadcrumbs';\nimport { IonButton } from '@ionic/core/components/ion-button';\nimport { IonButtons } from '@ionic/core/components/ion-buttons';\nimport { IonCardContent } from '@ionic/core/components/ion-card-content';\nimport { IonCardHeader } from '@ionic/core/components/ion-card-header';\nimport { IonCard } from '@ionic/core/components/ion-card';\n//import { IonCardSubtitle } from '@ionic/core/components/ion-card-subtitle';\nimport { IonCardTitle } from '@ionic/core/components/ion-card-title';\n//import { IonCheckbox } from '@ionic/core/components/ion-checkbox';\n// import { IonChip } from '@ionic/core/components/ion-chip';\nimport { IonCol } from '@ionic/core/components/ion-col';\nimport { IonContent } from '@ionic/core/components/ion-content';\n// import { IonDatetime } from '@ionic/core/components/ion-datetime';\nimport { IonFabButton } from '@ionic/core/components/ion-fab-button';\nimport { IonFab } from '@ionic/core/components/ion-fab';\nimport { IonFabList } from '@ionic/core/components/ion-fab-list';\nimport { IonFooter } from '@ionic/core/components/ion-footer';\nimport { IonGrid } from '@ionic/core/components/ion-grid';\nimport { IonHeader } from '@ionic/core/components/ion-header';\nimport { IonIcon } from '@ionic/core/components/ion-icon';\n// import { IonImg } from '@ionic/core/components/ion-img';\n// import { IonInfiniteScrollContent } from '@ionic/core/components/ion-infinite-scroll-content';\n// import { IonInfiniteScroll } from '@ionic/core/components/ion-infinite-scroll';\n//import { IonInput } from '@ionic/core/components/ion-input';\n// import { IonItemDivider } from '@ionic/core/components/ion-item-divider';\n// import { IonItemGroup } from '@ionic/core/components/ion-item-group';\nimport { IonItem } from '@ionic/core/components/ion-item';\n// import { IonItemOption } from '@ionic/core/components/ion-item-option';\n// import { IonItemOptions } from '@ionic/core/components/ion-item-options';\n// import { IonItemSliding } from '@ionic/core/components/ion-item-sliding';\nimport { IonLabel } from '@ionic/core/components/ion-label';\n//import { IonListHeader } from '@ionic/core/components/ion-list-header';\n//import { IonList } from '@ionic/core/components/ion-list';\n// import { IonLoading } from '@ionic/core/components/ion-loading';\nimport { IonMenuButton } from '@ionic/core/components/ion-menu-button';\nimport { IonMenu } from '@ionic/core/components/ion-menu';\nimport { IonMenuToggle } from '@ionic/core/components/ion-menu-toggle';\nimport { IonModal } from '@ionic/core/components/ion-modal';\n// import { IonNav } from '@ionic/core/components/ion-nav';\n// import { IonNavLink } from '@ionic/core/components/ion-nav-link';\n// import { IonNote } from '@ionic/core/components/ion-note';\n// import { IonPickerColumnInternal } from '@ionic/core/components/ion-picker-column-internal';\n// import { IonPickerColumn } from '@ionic/core/components/ion-picker-column';\n// import { IonPickerInternal } from '@ionic/core/components/ion-picker-internal';\n// import { IonPicker } from '@ionic/core/components/ion-picker';\n// import { IonPopover } from '@ionic/core/components/ion-popover';\n// import { IonProgressBar } from '@ionic/core/components/ion-progress-bar';\n// import { IonRadioGroup } from '@ionic/core/components/ion-radio-group';\n// import { IonRadio } from '@ionic/core/components/ion-radio';\nimport { IonRange } from '@ionic/core/components/ion-range';\n// import { IonRefresherContent } from '@ionic/core/components/ion-refresher-content';\n// import { IonRefresher } from '@ionic/core/components/ion-refresher';\n//import { IonReorderGroup } from '@ionic/core/components/ion-reorder-group';\n//import { IonReorder } from '@ionic/core/components/ion-reorder';\nimport { IonRippleEffect } from '@ionic/core/components/ion-ripple-effect';\n// import { IonRoute } from '@ionic/core/components/ion-route';\n// import { IonRouteRedirect } from '@ionic/core/components/ion-route-redirect';\n// import { IonRouter } from '@ionic/core/components/ion-router';\nimport { IonRouterLink } from '@ionic/core/components/ion-router-link';\nimport { IonRouterOutlet } from '@ionic/core/components/ion-router-outlet';\nimport { IonRow } from '@ionic/core/components/ion-row';\n// import { IonSearchbar } from '@ionic/core/components/ion-searchbar';\nimport { IonSegmentButton } from '@ionic/core/components/ion-segment-button';\nimport { IonSegment } from '@ionic/core/components/ion-segment';\n//import { IonSelect } from '@ionic/core/components/ion-select';\n//import { IonSelectOption } from '@ionic/core/components/ion-select-option';\n// import { IonSelectPopover } from '@ionic/core/components/ion-select-popover';\n// import { IonSkeletonText } from '@ionic/core/components/ion-skeleton-text';\n// import { IonSlide } from '@ionic/core/components/ion-slide';\n// import { IonSlides } from '@ionic/core/components/ion-slides';\n// import { IonSpinner } from '@ionic/core/components/ion-spinner';\nimport { IonSplitPane } from '@ionic/core/components/ion-split-pane';\n// import { IonTabBar } from '@ionic/core/components/ion-tab-bar';\n// import { IonTabButton } from '@ionic/core/components/ion-tab-button';\n// import { IonTab } from '@ionic/core/components/ion-tab';\n// import { IonTabs } from '@ionic/core/components/ion-tabs';\n//import { IonTextarea } from '@ionic/core/components/ion-textarea';\n//import { IonText } from '@ionic/core/components/ion-text';\n// import { IonThumbnail } from '@ionic/core/components/ion-thumbnail';\nimport { IonTitle } from '@ionic/core/components/ion-title';\nimport { IonToast } from '@ionic/core/components/ion-toast';\nimport { IonToggle } from '@ionic/core/components/ion-toggle';\nimport { IonToolbar } from '@ionic/core/components/ion-toolbar';\n// import { IonVirtualScroll } from '@ionic/core/components/ion-virtual-scroll';\n\ndocument.documentElement.classList.add('ion-ce');\n\nfunction tryDefine(impl: CustomElementConstructor, tag: string) {\n  try {\n    customElements.define(tag, impl);\n  } catch (error) {}\n}\n\ninitialize(/*{mode:'ios'}*/);\n\n// tryDefine(IonAccordionGroup, 'ion-accordion-group');\n// tryDefine(IonAccordion, 'ion-accordion');\n// tryDefine(IonActionSheet, 'ion-action-sheet');\ntryDefine(IonAlert, 'ion-alert');\ntryDefine(IonApp, 'ion-app');\n// tryDefine(IonAvatar, 'ion-avatar');\n//tryDefine(IonBackButton, 'ion-back-button');\n// tryDefine(IonBackdrop, 'ion-backdrop');\n// tryDefine(IonBadge, 'ion-badge');\n// tryDefine(IonBreadcrumb, 'ion-breadcrumb');\n// tryDefine(IonBreadcrumbs, 'ion-breadcrumbs');\ntryDefine(IonButton, 'ion-button');\ntryDefine(IonButtons, 'ion-buttons');\ntryDefine(IonCardContent, 'ion-card-content');\ntryDefine(IonCardHeader, 'ion-card-header');\ntryDefine(IonCard, 'ion-card');\n//tryDefine(IonCardSubtitle, 'ion-card-subtitle');\ntryDefine(IonCardTitle, 'ion-card-title');\n//tryDefine(IonCheckbox, 'ion-checkbox');\n// tryDefine(IonChip, 'ion-chip');\ntryDefine(IonCol, 'ion-col');\ntryDefine(IonContent, 'ion-content');\n// tryDefine(IonDatetime, 'ion-datetime');\ntryDefine(IonFabButton, 'ion-fab-button');\ntryDefine(IonFab, 'ion-fab');\ntryDefine(IonFabList, 'ion-fab-list');\ntryDefine(IonFooter, 'ion-footer');\ntryDefine(IonGrid, 'ion-grid');\ntryDefine(IonHeader, 'ion-header');\ntryDefine(IonIcon, 'ion-icon');\n// tryDefine(IonImg, 'ion-img');\n// tryDefine(IonInfiniteScrollContent, 'ion-infinite-scroll-content');\n// tryDefine(IonInfiniteScroll, 'ion-infinite-scroll');\n//tryDefine(IonInput, 'ion-input');\n// tryDefine(IonItemDivider, 'ion-item-divider');\n// tryDefine(IonItemGroup, 'ion-item-group');\ntryDefine(IonItem, 'ion-item');\n// tryDefine(IonItemOption, 'ion-item-option');\n// tryDefine(IonItemOptions, 'ion-item-options');\n// tryDefine(IonItemSliding, 'ion-item-sliding');\ntryDefine(IonLabel, 'ion-label');\n//tryDefine(IonListHeader, 'ion-list-header');\n//tryDefine(IonList, 'ion-list');\n// tryDefine(IonLoading, 'ion-loading');\ntryDefine(IonMenuButton, 'ion-menu-button');\ntryDefine(IonMenu, 'ion-menu');\ntryDefine(IonMenuToggle, 'ion-menu-toggle');\ntryDefine(IonModal, 'ion-modal');\n// tryDefine(IonNav, 'ion-nav');\n// tryDefine(IonNavLink, 'ion-nav-link');\n// tryDefine(IonNote, 'ion-note');\n// tryDefine(IonPickerColumnInternal, 'ion-picker-column-internal');\n// tryDefine(IonPickerColumn, 'ion-picker-column');\n// tryDefine(IonPickerInternal, 'ion-picker-internal');\n// tryDefine(IonPicker, 'ion-picker');\n// tryDefine(IonPopover, 'ion-popover');\n// tryDefine(IonProgressBar, 'ion-progress-bar');\n// tryDefine(IonRadioGroup, 'ion-radio-group');\n// tryDefine(IonRadio, 'ion-radio');\ntryDefine(IonRange, 'ion-range');\n// tryDefine(IonRefresherContent, 'ion-refresher-content');\n// tryDefine(IonRefresher, 'ion-refresher');\n//tryDefine(IonReorderGroup, 'ion-reorder-group');\n//tryDefine(IonReorder, 'ion-reorder');\ntryDefine(IonRippleEffect, 'ion-ripple-effect');\n// tryDefine(IonRoute, 'ion-route');\n// tryDefine(IonRouteRedirect, 'ion-route-redirect');\n// tryDefine(IonRouter, 'ion-router');\ntryDefine(IonRouterLink, 'ion-router-link');\ntryDefine(IonRouterOutlet, 'ion-router-outlet');\ntryDefine(IonRow, 'ion-row');\n// tryDefine(IonSearchbar, 'ion-searchbar');\ntryDefine(IonSegmentButton, 'ion-segment-button');\ntryDefine(IonSegment, 'ion-segment');\n//tryDefine(IonSelect, 'ion-select');\n//tryDefine(IonSelectOption, 'ion-select-option');\n// tryDefine(IonSelectPopover, 'ion-select-popover');\n// tryDefine(IonSkeletonText, 'ion-skeleton-text');\n// tryDefine(IonSlide, 'ion-slide');\n// tryDefine(IonSlides, 'ion-slides');\n// tryDefine(IonSpinner, 'ion-spinner');\ntryDefine(IonSplitPane, 'ion-split-pane');\n// tryDefine(IonTabBar, 'ion-tab-bar');\n// tryDefine(IonTabButton, 'ion-tab-button');\n// tryDefine(IonTab, 'ion-tab');\n// tryDefine(IonTabs, 'ion-tabs');\n//tryDefine(IonTextarea, 'ion-textarea');\n//tryDefine(IonText, 'ion-text');\n// tryDefine(IonThumbnail, 'ion-thumbnail');\ntryDefine(IonTitle, 'ion-title');\ntryDefine(IonToast, 'ion-toast');\ntryDefine(IonToggle, 'ion-toggle');\ntryDefine(IonToolbar, 'ion-toolbar');\n// tryDefine(IonVirtualScroll, 'ion-virtual-scroll');\n\nconst images = import.meta.glob('/node_modules/@ionic/core/dist/ionic/svg/(close|home-sharp|information-circle|settings-sharp|save|caret-down|caret-forward|caret-up|arrow-back|arrow-forward|power|swap-vertical|arrow-undo|bulb|color-wand|flag).svg', { as: 'url' });\nexport const redrawIconImages = () => {\n  document.querySelectorAll('ion-icon').forEach((el) => {\n      const name = el.getAttribute('data-name');\n      if (name != null) {\n        images[`/node_modules/@ionic/core/dist/ionic/svg/${name}.svg`]().then((url: string) => {\n          el.src = url;\n        });\n      }\n    });\n};\n","\nimport Navigo from 'navigo';\nimport { MenuI, menuController, modalController } from '@ionic/core';\nimport { Controller } from '../controllers';\nimport { MAIN_MENU_ID, setupSEO } from '../commons';\nimport { redrawIconImages } from './ionic';\n\ninterface RouteItem {\n    path: string;\n    template: string;\n    tag: string;\n    controller: Controller;\n    hasParams: boolean;\n}\n\ninterface RouteMap {\n    hash: boolean,\n    mainRoute: RouteItem;\n    routes: RouteItem[];\n}\n\nclass RouteService {\n\n    private navigo!: Navigo;\n    private menuRegistered = false;\n    private templates = new Map<string, string>();\n    \n    private closeMenu = (menuId: string) => {\n        if (!this.menuRegistered) {\n            const query = \"ion-menu[menu-id='\" + menuId + \"']\";\n            const menu = document.querySelector(query) as unknown as MenuI;\n            if (!menu) return;\n            menuController._register(menu);\n            this.menuRegistered = true;\n        }\n        menuController.close(menuId);\n    }\n\n    private openRoute = (navigo: Navigo, template: string, targetElementSelector: string, controller: Controller, params?: any): Promise<void> => {\n        this.closeMenu(MAIN_MENU_ID);\n        return new Promise<void>(resolve => {\n            const targetElement = document.querySelector(targetElementSelector);\n            if (targetElement) {\n                const elementObserver = new MutationObserver((mutations) => {\n                    mutations.forEach((_mutation) => {\n                        if (controller) {\n                            elementObserver.disconnect();\n                            redrawIconImages();\n                            navigo.updatePageLinks();\n                            resolve();\n                        }\n                    });\n                });\n                elementObserver.observe(targetElement, { childList: true });\n                controller.onEnter(params);\n                const content = this.templates.get(template);\n                if (content) {\n                    targetElement.innerHTML = content;\n                    setupSEO(template, controller.getSEOParams());\n                } else {\n                    fetch(template)\n                        .then(response => response.text()\n                            .then(content => {\n                                this.templates.set(template, content);\n                                targetElement.innerHTML = content;\n                                setupSEO(template, controller.getSEOParams());\n                                redrawIconImages();\n                            }));\n                }\n            }\n        });\n    }\n\n    private open(routeItem: RouteItem): (params?: any) => Promise<void> {\n        if (routeItem.hasParams) {\n            return (params: any) => this.openRoute(this.navigo, routeItem.template, routeItem.tag, routeItem.controller, params);\n        } else {\n            return () => this.openRoute(this.navigo, routeItem.template, routeItem.tag, routeItem.controller);\n        }\n    }\n\n    public openModal(xData: string, template: string, controller: Controller, pageMode: boolean, autoHeight: boolean, info?: any): Promise<any> {\n        const element = document.createElement('div');\n        element.setAttribute('x-data', xData);\n        const content = this.templates.get(template);\n        if (content) {\n            element.innerHTML = content;\n            return this.innerOpenModal(element, controller, pageMode, autoHeight, info);\n        } else {\n            return fetch(template)\n                .then(response => response.text()\n                    .then(async content => {\n                        this.templates.set(template, content);\n                        element.innerHTML = content;\n                        return this.innerOpenModal(element, controller, pageMode, autoHeight, info);\n                    }));\n        }\n    }\n\n    private async innerOpenModal(component: HTMLElement, controller: Controller, pageMode: boolean, autoHeight: boolean, info?: any): Promise<any> {\n        const modal = await modalController.create({ component: component });\n        if (autoHeight) modal.style.setProperty('--height', 'auto');\n        if (info) controller.setInfo(info);\n        controller.onEnter(info);\n        modal.present().then(() => { redrawIconImages(); });\n        // remove ion-page class on the next tick, when the DOM of the modal has been loaded\n        if (!pageMode) {\n            requestAnimationFrame(() => {\n                if (!pageMode) component.classList.remove('ion-page');\n            });\n        }\n        const { data } = await modal.onDidDismiss();\n        return data;\n    }\n\n    public updatePageLinks() {\n        this.navigo.updatePageLinks();\n    }\n\n    public init(routeMap: RouteMap) {\n        this.navigo = new Navigo(routeMap.mainRoute.path, { hash: routeMap.hash });\n        const mainRoute = this.open(routeMap.mainRoute);\n        routeMap.routes.forEach((route) => {\n            const oRoute = this.open(route);\n            if (route.hasParams) {\n                this.navigo.on(route.path, (info: any) => {\n                    document.querySelector(route.tag) ? oRoute(info.data) : mainRoute().then(() => oRoute(info.data));\n                }, {\n                    leave(done, _match) {\n                        route.controller.onExit().then((canExit: boolean) => done(canExit));\n                    }\n                });\n            } else {\n                this.navigo.on(route.path, () => {\n                    document.querySelector(route.tag) ? oRoute() : mainRoute().then(() => oRoute());\n                }, {\n                    leave(done, _match) {\n                        route.controller.onExit().then((canExit: boolean) => done(canExit));\n                    }\n                });\n            }\n        });\n        this.navigo.resolve();\n    }\n}\n\nexport const routeService = new RouteService();","import { BOARD_THEMES } from '../commons';\nimport { configurationService } from './configuration-service';\n\nclass BoardThemeSwitcherService {\n\n    public getThemes() {\n        return BOARD_THEMES;\n    }\n\n    public setTheme(theme: string) {\n        const themeDefinition = BOARD_THEMES.find(item => item.name == theme);\n        if (themeDefinition) themeDefinition.styles.forEach(style => {\n            document.documentElement.style.setProperty(style.themeVariable, style.value);\n          });\n    }\n\n    public currentTheme() {\n        return configurationService.configuration.boardTheme;\n    }\n\n    public init() {\n        this.setTheme(this.currentTheme());\n    }\n}\n\nexport const boardThemeSwitcherService = new BoardThemeSwitcherService();\n","class SyzygyService {\n   \n    public async init(): Promise<any> {\n\n    }\n\n    public get(fen: string): Promise<Response> {\n        return fetch(`https://tablebase.lichess.ovh/standard?fen=${fen}`, {\n            method: 'GET',\n            cache: 'force-cache'\n        });\n\n    }\n}\n\nexport const syzygyService = new SyzygyService();\n","import { EventEmitter } from '../commons';\n\ndeclare var WebAssembly: any;\n\nclass StockfishService {\n\n    private stockfish: any;\n    private _version!: string;\n    private _messageEmitter: EventEmitter<string> = new EventEmitter<string>();\n\n    constructor() { }\n\n    get version(): string { return this._version; }\n    get messageEmitter(): EventEmitter<string> { return this._messageEmitter; }\n\n    public postMessage(message: string) {\n        this.stockfish.postMessage(message);\n    }\n\n    private initStockfish(engineUrl: string, nnue: boolean) {\n        const self = this;\n        this.stockfish = new Worker(engineUrl);\n        this.stockfish.addEventListener('message', function (event: MessageEvent<string>) {\n            self._messageEmitter.notify(event.data);\n        });\n        this.stockfish.postMessage('uci');\n        if (nnue) this.stockfish.postMessage('setoption name Use NNUE value true');\n    }\n\n    private async initStockfishNnue16() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16.js#stockfish-nnue-16.wasm', true);\n    }\n\n    private initStockfishNnue16NoSimd() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16-no-simd.js#stockfish-nnue-16-no-simd.wasm', true);\n    }\n\n    private initStockfishNnue16Single() {\n        this.initStockfish('assets/stockfish/stockfish-nnue-16-single.js#stockfish-nnue-16-single.wasm', true);\n    }\n\n    private initStockfishJs() {\n        this.initStockfish('assets/stockfish/stockfish.asm.js', false);\n    }\n\n    private sharedMemoryTest(): boolean {\n        if (typeof Atomics !== 'object') return false;\n        if (typeof SharedArrayBuffer !== 'function') return false;\n        let mem;\n        try {\n            mem = new WebAssembly.Memory({ shared: true, initial: 1, maximum: 2 });\n            if (!(mem.buffer instanceof SharedArrayBuffer)) return false;\n\n            window.postMessage(mem.buffer, '*');\n        } catch (_) {\n            return false;\n        }\n        return mem.buffer instanceof SharedArrayBuffer;\n    }\n\n    private detectFeatures(): string[] {\n        const result: string[] = [];\n        if (typeof WebAssembly === 'object' &&\n            typeof WebAssembly.validate === 'function' &&\n            WebAssembly.validate(Uint8Array.from([0, 97, 115, 109, 1, 0, 0, 0]))) {\n            result.push('wasm');\n            if (this.sharedMemoryTest()) {\n                result.push('sharedMem');\n                // i32x4.dot_i16x8_s, i32x4.trunc_sat_f64x2_u_zero\n                const sourceWithSimd = Uint8Array.from([0, 97, 115, 109, 1, 0, 0, 0, 1, 12, 2, 96, 2, 123, 123, 1, 123, 96, 1, 123, 1, 123, 3, 3, 2, 0, 1, 7, 9, 2, 1, 97, 0, 0, 1, 98, 0, 1, 10, 19, 2, 9, 0, 32, 0, 32, 1, 253, 186, 1, 11, 7, 0, 32, 0, 253, 253, 1, 11]); // prettier-ignore\n                if (WebAssembly.validate(sourceWithSimd)) result.push('simd');\n            }\n        }\n        return result;\n    }\n\n    public init(): Promise<boolean> {\n        return new Promise(resolve => {\n            const stockfishListener = (message: string) => {\n                if (!this._version) this._version = message;\n                console.log(message);\n                if ('uciok' == message) {\n                    //this._messageEmitter.removeEventListener(stockfishListener);\n                    resolve(true);\n                }\n            }\n            this._messageEmitter.addEventListener(stockfishListener);\n            const features = this.detectFeatures();\n            if (features.includes(\"simd\"))\n                this.initStockfishNnue16();\n            else if (features.includes(\"sharedMem\")) {\n                this.initStockfishNnue16NoSimd();\n            } else if (features.includes(\"wasm\")) {\n                this.initStockfishNnue16Single();\n            } else {\n                this.initStockfishJs();\n            }\n        });\n    }\n\n}\n\nexport const stockfishService = new StockfishService();\n","import { Howl } from 'howler';\n\nimport { configurationService } from './configuration-service';\nimport { soundJson } from '../static';\n\ntype SOUND_ITEM = {\n    key: string,\n    audio: Howl\n}\n\nclass SoundService {\n\n    private sounds: SOUND_ITEM[] = [];\n\n    public playAudio(sound: string) {\n        if (configurationService.configuration.playSounds) {\n            const soundToPlay = this.sounds.find((item) => { return item.key === sound; });\n            if (soundToPlay && (sound !== 'fail' || !soundToPlay.audio.playing())) {\n                soundToPlay.audio.play();\n            }\n        }\n    }\n\n    public init() {\n        soundJson.sounds.forEach(item => this.sounds.push({ key: item.key, audio: new Howl({ src: [item.audio] }) }))\n    }\n}\n\nexport const soundService = new SoundService();\n","import AlpineI18n from 'alpinejs-i18n';\nimport Alpine from 'alpinejs';\nimport { i18nJson } from '../static';\n\nclass AlpineService {\n\n    private hideLoader() {\n        const loaderContainer = document.querySelector('.loader-container');\n        if (loaderContainer) { loaderContainer.remove(); }\n    }\n\n    private i18n() {\n        document.addEventListener('alpine-i18n:ready', () => {\n            const browserLang = navigator.language;\n            let candidate = '';\n            let created = false;\n            Object.keys(i18nJson).forEach((key) => {\n                if (!window.AlpineI18n.fallbackLocale) {\n                    window.AlpineI18n.fallbackLocale = key;\n                }\n                if (!created) {\n                    if (key == browserLang) {\n                        window.AlpineI18n.create(key, i18nJson);\n                        created = true;\n                        document.documentElement.lang = key;\n                    } else if (!candidate && browserLang.startsWith(key)) {\n                        candidate = key;\n                    }\n                }\n            });\n            if (!created) {\n                if (candidate) {\n                    window.AlpineI18n.create(candidate, i18nJson);\n                    document.documentElement.lang = candidate;\n                } else {\n                    window.AlpineI18n.create(window.AlpineI18n.fallbackLocale, i18nJson);\n                    document.documentElement.lang = window.AlpineI18n.fallbackLocale;\n                }\n            }\n        });\n    }\n\n    public init() {\n        this.i18n();\n        Alpine.plugin(AlpineI18n);\n        Alpine.start();\n        this.hideLoader();\n    }\n\n}\n\nexport const alpineService = new AlpineService();\n","import './ionic';\nimport { storageService } from './storage-service';\nimport { configurationService } from './configuration-service';\nimport { endgameDatabaseService } from './endgame-database-service';\nimport { alpineService } from './alpine-service';\nimport { themeSwitcherService } from './theme-switcher-service';\nimport { boardThemeSwitcherService } from './board-theme-switcher-service';\nimport { syzygyService } from './syzygy-service';\nimport { stockfishService } from './stockfish-service';\nimport { soundService } from './sound-service';\n\nexport function services_initialize() {\n    return storageService.init()\n        .then(() => configurationService.init())\n        .then(() => stockfishService.init())\n        .then(() => syzygyService.init())\n        .then(() => soundService.init())\n        .then(() => themeSwitcherService.init())\n        .then(() => boardThemeSwitcherService.init())\n        .then(() => endgameDatabaseService.init())\n        .then(() => alpineService.init())\n        ;\n\n}\n","export interface Controller {\n    setInfo(info: any): void;\n    getSEOParams(): any;\n    onEnter($routeParams?: any): void;\n    onExit(): Promise<boolean>;\n}\n\nexport class BaseController implements Controller {\n    setInfo(_info: any) {\n    }\n    getSEOParams(): any {\n        return {};\n    }\n    onEnter(_$routeParams?: any): void {\n    }\n    onExit(): Promise<boolean> {\n        return new Promise<boolean>(resolve => { resolve(true); });\n    }\n}\n\nexport const dummyController = new BaseController();","import Alpine from 'alpinejs';\nimport { version } from '../../package.json';\nimport { BaseController } from './controller';\nimport { aboutJson } from '../static';\nimport { stockfishService } from '../services';\n\nclass AboutController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info', () => ({\n            version: version,\n            items: aboutJson.items.map(item => { return {url: item.url, text: window.AlpineI18n.t(item.i18n, {'stockfishRunningVersion': stockfishService.version}) } })\n        }));\n    }\n}\n\nexport const aboutController = new AboutController();\n","import { PIECE_THEMES, BOARD_THEMES } from '../commons';\nimport { redrawIconImages, themeSwitcherService, configurationService, boardThemeSwitcherService } from '../services';\nimport { BaseController } from './controller';\nimport Alpine from 'alpinejs';\nimport { toastController } from '@ionic/core';\nimport { IonModal } from '@ionic/core/components/ion-modal';\nimport { IonToggle } from '@ionic/core/components/ion-toggle';\nimport { IonRange } from '@ionic/core/components/ion-range';\n\nclass SettingsController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n\n        Alpine.data('settings', () => ({\n            color: themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b',\n            // theme\n            showThemes: false,\n            themes: themeSwitcherService.getThemes(),\n            currentTheme() {\n                return configurationService.configuration.colorTheme;\n            },\n            toggleThemes() {\n                this.showThemes = !this.showThemes;\n                this.showPieceThemes = false;\n                this.showBoardThemes = false;\n            },\n            setTheme(theme: string) {\n                themeSwitcherService.setTheme(theme);\n                configurationService.configuration.colorTheme = theme;\n                this.color = themeSwitcherService.currentTheme() == 'dark' ? 'w' : 'b';\n            },\n            // piece theme\n            showPieceThemes: false,\n            pieceThemes: PIECE_THEMES,\n            currentPieceTheme: configurationService.configuration.pieceTheme,\n            togglePieceThemes() {\n                this.showPieceThemes = !this.showPieceThemes;\n                this.showThemes = false;\n                this.showBoardThemes = false;\n            },\n            setPieceTheme(pieceTheme: string) {\n                this.currentPieceTheme = pieceTheme;\n                configurationService.configuration.pieceTheme = pieceTheme;\n            },\n            // board theme\n            showBoardThemes: false,\n            boardThemes: BOARD_THEMES,\n            currentBoardTheme: configurationService.configuration.boardTheme,\n            toggleBoardThemes() {\n                this.showBoardThemes = !this.showBoardThemes;\n                this.showThemes = false;\n                this.showPieceThemes = false;\n\n            },\n            setBoardTheme(boardTheme: string) {\n                this.currentBoardTheme = boardTheme;\n                configurationService.configuration.boardTheme = boardTheme;\n                boardThemeSwitcherService.setTheme(boardTheme);\n            },\n            // play sounds\n            playSounds: configurationService.configuration.playSounds,\n            playSoundsChanged(checked: boolean) {\n                this.playSounds = checked;\n                configurationService.configuration.playSounds = checked;\n            },\n            // highlight squares\n            highlightSquares: configurationService.configuration.highlightSquares,\n            highlightSquaresChanged(checked: boolean) {\n                this.highlightSquares = checked;\n                configurationService.configuration.highlightSquares = checked;\n            },\n            // use syzygy\n            useSyzygy: configurationService.configuration.useSyzygy,\n            useSyzygyChanged(checked: boolean) {\n                this.useSyzygy = checked;\n                configurationService.configuration.useSyzygy = checked;\n            },\n            // stockfish depth\n            currentStockfishDepth: configurationService.configuration.stockfishDepth,\n            changeStockfishDepth(value: number) {\n                this.currentStockfishDepth = value;\n                configurationService.configuration.stockfishDepth = value;  \n            },\n            // stockfish movetime\n            currentStockfishMovetime: configurationService.configuration.stockfishMovetime,\n            changeStockfishMovetime(value: number) {\n                this.currentStockfishMovetime = value;\n                configurationService.configuration.stockfishMovetime = value;  \n            },\n            // save settings\n            save() {\n                configurationService.save().then(async () => {\n                    const toast = await toastController.create({\n                        message: window.AlpineI18n.t('settings.changes-saved'),\n                        position: 'middle',\n                        color: 'success',\n                        duration: 1000\n                    });\n                    toast.present();\n                    this.close();\n                });\n            },\n            close() {\n                (document.querySelector('ion-modal') as IonModal).dismiss();\n            },\n            init() {\n                const toggleHighlightSquares = document.getElementById('toggleHighlightSquares') as IonToggle;\n                toggleHighlightSquares.addEventListener('ionChange', () => { this.highlightSquaresChanged(toggleHighlightSquares.checked); });\n                \n                const togglePlaySounds = document.getElementById('togglePlaySounds') as IonToggle;\n                togglePlaySounds.addEventListener('ionChange', () => { this.playSoundsChanged(togglePlaySounds.checked); });\n                \n                const toggleUseSyzygy = document.getElementById('toggleUseSyzygy') as IonToggle;\n                toggleUseSyzygy.addEventListener('ionChange', () => { this.useSyzygyChanged(toggleUseSyzygy.checked); });\n          \n                const stockfishDepthRange = document.getElementById('stockfishDepthRange') as IonRange;\n                stockfishDepthRange.value = configurationService.configuration.stockfishDepth;\n                stockfishDepthRange.addEventListener('ionChange', () => {\n                    if (typeof stockfishDepthRange.value ===  'number') this.changeStockfishDepth(stockfishDepthRange.value);\n                });\n\n                const stockfishMovetimeRange = document.getElementById('stockfishMovetimeRange') as IonRange;\n                stockfishMovetimeRange.value = configurationService.configuration.stockfishMovetime;\n                stockfishMovetimeRange.addEventListener('ionChange', () => {\n                    if (typeof stockfishMovetimeRange.value ===  'number') this.changeStockfishMovetime(stockfishMovetimeRange.value);\n                });\n\n                ['showThemes', 'showPieceThemes', 'showBoardThemes'].forEach((item) => {\n                    this.$watch(item, (_value) => {\n                        redrawIconImages();\n                    });\n                });\n            }\n        }));\n    }\n}\n\nexport const settingsController = new SettingsController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService, redrawIconImages, routeService } from '../services';\nimport { EndgameDatabase } from '../model';\nimport { ariaDescriptionFromIcon, clone } from '../commons';\nimport { settingsController } from './settings';\n\nclass AppController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info',  () => ({\n            categories: clone(endgameDatabaseService.endgameDatabase.categories),\n            categorySelected: '',\n            selectCategory(category: string) {\n                if (this.categorySelected != category) {\n                    this.categorySelected = category;\n                    this.$nextTick().then(() => { routeService.updatePageLinks(); });\n                } else {\n                    this.categorySelected = '';\n                }\n            },\n            ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n            showSettings() {\n                routeService.openModal('settings', 'settings.html', settingsController, true, false);\n            },\n            init() {\n                endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n                    this.categories = clone(database.categories);\n                });\n                ['categorySelected'].forEach((item) => {\n                    this.$watch(item, (_value) => {\n                        redrawIconImages();\n                    });\n                });\n            }\n        }));\n    }\n}\n\nexport const appController = new AppController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService } from '../services';\n\nclass HomeController extends BaseController {\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('info', () => ({\n            categories: endgameDatabaseService.endgameDatabase.categories\n        }));\n    }\n}\n\nexport const homeController = new HomeController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { endgameDatabaseService } from '../services';\nimport { ariaDescriptionFromIcon, clone } from '../commons';\nimport { EndgameDatabase } from '../model';\n\nclass ListController extends BaseController {\n\n    private title!: string;\n    private seo!: string;\n\n    onEnter($routeParams?: any): void {\n        const endgameDatabase = endgameDatabaseService.endgameDatabase;\n        let categories = endgameDatabase.categories;\n        const idxCategory = parseInt($routeParams['idxCategory']);\n        const idxSubcategory = parseInt($routeParams['idxSubcategory']);\n        const category = categories[idxCategory];\n        const subcategory = category.subcategories[idxSubcategory];\n        const idxLastSubcategory = category.count - 1;\n\n        this.title = `${window.AlpineI18n.t(`category.${category.name}`)} [ ${idxSubcategory + 1} / ${idxLastSubcategory + 1} ]`;\n        this.seo = `${window.AlpineI18n.t(`category.${category.name}`)} (${subcategory.name}) ${idxSubcategory + 1}/${idxLastSubcategory + 1}`;\n\n        Alpine.data('info', () => ({\n            title: this.title,\n            idxCategory: idxCategory,\n            idxSubcategory: idxSubcategory,\n            category: category,\n            subcategory: subcategory,\n            gameCount: subcategory.games.length,\n            idxLastSubcategory: idxLastSubcategory,\n            showNavPrev: idxSubcategory > 0 || idxCategory > 0,\n            showNavNext: !(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory),\n            prevUrl: '',\n            nextUrl: '',\n            rows: Math.ceil(subcategory.games.length / 6),\n            showPosition(idxGame: Number) {\n                console.log(idxGame);\n            },\n            ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n            init() {\n                endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n                    const categories = database.categories;\n                    this.category = clone(categories[idxCategory]);\n                    this.subcategory = clone(this.category.subcategories[idxSubcategory]);\n                });\n                // prevUrl\n                if (idxSubcategory > 0 || idxCategory > 0) {\n                    let idxCat = this.idxCategory;\n                    let idxSub = this.idxSubcategory - 1;\n                    if (idxSub < 0) {\n                      idxCat--;\n                      idxSub = endgameDatabase.categories[idxCat].count - 1;\n                    }\n                    this.prevUrl = `/list/${idxCat}/${idxSub}`;\n                }\n                // nextUrl\n                if (!(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory)) {\n                    let idxCat = this.idxCategory;\n                    let idxSub = this.idxSubcategory + 1;\n                    if (idxSub > this.idxLastSubcategory) {\n                      idxCat++;\n                      idxSub = 0;\n                    }\n                    this.nextUrl = `/list/${idxCat}/${idxSub}`;\n                }\n            }\n        }));\n    }\n\n    getSEOParams(): any {\n        return { 'kind': this.seo };\n    }\n\n}\n\nexport const listController = new ListController();\n","import { BaseController } from './controller';\nimport Alpine from 'alpinejs';\nimport { IonModal } from '@ionic/core/components/ion-modal';\nimport { configurationService } from '../services';\n\nclass PromotionController extends BaseController {\n    private player!: string\n    setInfo(player: string) {\n        this.player = player;\n    }\n    onEnter(_$routeParams?: any): void {\n        Alpine.data('promotion', () => ({\n            player: this.player,\n            currentPieceTheme: configurationService.configuration.pieceTheme,\n            select(piece: string) {\n                (document.querySelector('ion-modal') as IonModal).dismiss({piece: piece});\n            }\n        }));\n    }\n}\n\nexport const promotionController = new PromotionController();\n","import Alpine from 'alpinejs';\nimport { BaseController } from './controller';\nimport { configurationService, endgameDatabaseService, routeService, soundService, stockfishService, syzygyService } from '../services';\nimport { MAIN_MENU_ID, ariaDescriptionFromIcon, clone, urlIcon } from '../commons';\nimport { Category, EndgameDatabase, Position, Subcategory } from '../model';\nimport { Chess, ChessInstance, PieceType, SQUARES, Square } from 'chess.js';\nimport { Chessground } from 'chessground';\nimport { Api } from 'chessground/api';\nimport { colors, MoveMetadata, Color, Key } from 'chessground/types';\nimport { Config } from 'chessground/config';\nimport { promotionController } from './promotion';\nimport { alertController, menuController, toastController } from '@ionic/core';\n\nclass PositionController extends BaseController {\n\n  private seo!: string;\n  private chess: ChessInstance = Chess();\n  private board!: Api;\n  private boardConfig!: Config;\n  private parsedPgn: { value: string[][] } = Alpine.reactive({ value: [] });\n  private player!: \"white\" | \"black\";\n  //private engine!: \"white\" | \"black\";\n  private target!: string;\n  private useSyzygy = false;\n  private listeningToStockfish = false;\n\n  constructor() {\n    super();\n    stockfishService.messageEmitter.addEventListener((message: string) => this.stockfishMessage(message));\n  }\n\n  private resizeBoard() {\n    const headers = Array.from(document.querySelectorAll('ion-header')) as HTMLElement[];\n    const header = headers.find(header => header.clientHeight > 0);\n    if (!header) return;\n    const container = document.querySelector('.container') as HTMLElement;\n    const boardWrapper = document.querySelector('.board_wrapper') as HTMLElement;\n    const infoWrapper = document.querySelector('.info_wrapper') as HTMLElement;\n    const infoMoves = document.querySelector('.info_moves') as HTMLElement;\n    const actionButtons = document.querySelector('.action_buttons') as HTMLElement;\n    const containerWidth = container.clientWidth;\n    const containerHeight = container.clientHeight;\n    let minSize = Math.min(containerWidth, containerHeight);\n    const mod = minSize % 8;\n    minSize = minSize - mod;\n    boardWrapper.style.height = `${minSize}px`;\n    boardWrapper.style.width = `${minSize}px`;\n    if (containerWidth > containerHeight) {\n      infoWrapper.style.width = `${(containerWidth - minSize - 2)}px`;\n      infoWrapper.style.height = `calc(100% - ${actionButtons.clientHeight}px`;\n    } else {\n      infoWrapper.style.width = '100%';\n      infoWrapper.style.height = `${(containerHeight - minSize - actionButtons.clientHeight - 2)}px`;\n    }\n    infoMoves.style.height = `${infoWrapper.clientHeight - 48}px`;\n    actionButtons.style.width = infoWrapper.style.width;\n    const board: any = document.getElementById('__chessboard__');\n    board.style.height = `${boardWrapper.clientWidth}px`;\n    board.style.width = `${boardWrapper.clientHeight}px`;\n  }\n\n  private parsePgn(pgn: string) {\n    this.parsedPgn.value = [];\n    if (pgn == '')\n      return;\n    const parts = pgn.split('.');\n    let pos = 0;\n    parts.forEach(part => {\n      if (pos > 0) {\n        let moves = part.trim().split(' ', 2);\n        this.parsedPgn.value.push(moves);\n      }\n      pos++;\n    });\n    console.log(JSON.stringify(this.parsedPgn.value));\n  }\n\n  private toDests(): Map<Key, Key[]> {\n    const dests = new Map();\n    SQUARES.forEach(s => {\n      const ms = this.chess.moves({ square: s, verbose: true });\n      if (ms.length) dests.set(s, ms.map(m => m.to));\n    });\n    return dests;\n  }\n\n  onEnter($routeParams?: any): void {\n    const self = this;\n    menuController.get(MAIN_MENU_ID).then(function (menu) {\n      if (menu) menu.swipeGesture = false;\n    });\n    this.useSyzygy = configurationService.configuration.useSyzygy;\n    const endgameDatabase = endgameDatabaseService.endgameDatabase;\n    let categories = endgameDatabase.categories;\n    let idxCategory: number;\n    let idxSubcategory: number;\n    let category: Category;\n    let subcategory: Subcategory;\n    let idxGame: number;\n    let game: Position;\n    let idxLastSubcategory: number;\n    let idxLastGame: number;\n\n    const customFen = ($routeParams['fen1'] !== undefined);\n    let fen: string;\n    if (customFen) {\n      fen = `${$routeParams['fen1']}/${$routeParams['fen2']}/${$routeParams['fen3']}/${$routeParams['fen4']}/${$routeParams['fen5']}/${$routeParams['fen6']}/${$routeParams['fen7']}/${$routeParams['fen8']}`;\n      this.target = $routeParams['target'];\n      this.seo = fen;\n    } else {\n      idxCategory = parseInt($routeParams['idxCategory']);\n      idxSubcategory = parseInt($routeParams['idxSubcategory']);\n      category = categories[idxCategory];\n      subcategory = category.subcategories[idxSubcategory];\n      idxGame = parseInt($routeParams['idxGame']);\n      game = subcategory.games[idxGame];\n      idxLastSubcategory = category.count - 1;\n      idxLastGame = subcategory.count - 1;\n      fen = game.fen;\n      this.target = game.target;\n      this.seo = `${window.AlpineI18n.t(`category.${category.name}`)} (${subcategory.name}) ${idxGame + 1}/${idxLastGame + 1}`;\n    }\n\n    this.chess.load(fen);\n    this.parsePgn(this.chess.pgn());\n\n    const turnWhite = this.chess.turn() == 'w';\n    const turnColor: Color = (turnWhite ? 'white' : 'black');\n    this.player = turnColor;\n    //this.engine = this.player == 'white' ? 'black' : 'white';\n    const move = (turnWhite ? 'white' : 'black');\n    const targetImage = urlIcon(turnWhite ? 'wK.svg' : 'bK.svg', configurationService.configuration.pieceTheme);\n    this.boardConfig = {\n      fen: this.chess.fen(),\n      orientation: (this.chess.turn() == 'w' ? colors[0] : colors[1]),\n      viewOnly: false,\n      turnColor: turnColor,\n      premovable: {\n        enabled: false\n      },\n      movable: {\n        free: false,\n        color: turnColor,\n        dests: this.toDests(),\n        showDests: configurationService.configuration.highlightSquares,\n        events: {\n          after: (orig: Key, dest: Key, _metadata: MoveMetadata) => { this.afterMove(orig, dest); }\n        }\n      },\n      highlight: {\n        lastMove: true,\n        check: true\n      },\n      draggable: {\n        enabled: true,\n        autoDistance: true,\n        showGhost: true\n      },\n      selectable: {\n        enabled: true\n      }\n    };\n    window.addEventListener('resize', function () {\n      self.resizeBoard();\n    });\n\n    Alpine.data('info', () => ({\n      boardTheme: configurationService.configuration.boardTheme,\n      pieceTheme: configurationService.configuration.pieceTheme,\n      customFen: customFen,\n      fen: fen,\n      target: this.target,\n      idxCategory: idxCategory,\n      idxSubcategory: idxSubcategory,\n      idxGame: idxGame,\n      category: category,\n      subcategory: subcategory,\n      game: game,\n      parsedPgn: self.parsedPgn,\n      move: move,\n      targetImage: targetImage,\n      idxLastSubcategory: idxLastSubcategory,\n      idxLastGame: idxLastGame,\n      showNavPrev: idxSubcategory > 0 || idxCategory > 0 || idxGame > 0,\n      showNavNext: !(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory && idxGame === idxLastGame),\n      prevUrl: '',\n      nextUrl: '',\n      listUrl: `/list/${idxCategory}/${idxSubcategory}`,\n      ariaDescriptionFromIcon: ariaDescriptionFromIcon,\n      chess: this.chess,\n      init() {\n        self.board = Chessground(document.getElementById('__chessboard__') as HTMLElement, self.boardConfig);\n        // resize the board on the next tick, when the DOM of the chessboard has been loaded\n        requestAnimationFrame(() => {\n          self.resizeBoard();\n        });\n        endgameDatabaseService.endgameDatabaseChangedEmitter.addEventListener((database: EndgameDatabase) => {\n          const categories = database.categories;\n          this.category = clone(categories[idxCategory]);\n          this.subcategory = clone(this.category.subcategories[idxSubcategory]);\n          this.game = clone(this.subcategory.games[idxGame]);\n        });\n        configurationService.configuration.configurationChangedEmitter.addEventListener((event) => {\n          switch (event.field) {\n            case 'boardTheme': this.boardTheme = event.config.boardTheme; break;\n            case 'pieceTheme': this.pieceTheme = event.config.pieceTheme; break;\n            case 'highlightSquares': {\n              if (self.boardConfig.movable) {\n                self.board.set({\n                  movable: { showDests: event.config.highlightSquares },\n                });\n              }\n              break;\n            }\n            case 'useSyzygy': self.useSyzygy = configurationService.configuration.useSyzygy; break;\n          }\n        });\n        // prevUrl\n        if (idxSubcategory > 0 || idxCategory > 0 || idxGame > 0) {\n          let idxCat = this.idxCategory;\n          let idxSub = this.idxSubcategory;\n          let idxGame = this.idxGame - 1;\n          if (idxGame < 0) {\n            idxSub--;\n            if (idxSub < 0) {\n              idxCat--;\n              idxSub = categories[idxCat].count - 1;\n            }\n            idxGame = categories[idxCat].subcategories[idxSub].count - 1;\n          }\n          this.prevUrl = `/position/${idxCat}/${idxSub}/${idxGame}`;\n        }\n        // nextUrl\n        if (!(idxCategory === endgameDatabase.count - 1 && idxSubcategory === idxLastSubcategory && idxGame === idxLastGame)) {\n          let idxCat = this.idxCategory;\n          let idxSub = this.idxSubcategory;\n          let idxGame = this.idxGame + 1;\n          if (idxGame > this.idxLastGame) {\n            idxSub++;\n            if (idxSub > this.idxLastSubcategory) {\n              idxCat++;\n              idxSub = 0;\n            }\n            idxGame = 0;\n          }\n          this.nextUrl = `/position/${idxCat}/${idxSub}/${idxGame}`;\n        }\n      }\n    }));\n  }\n\n  afterMove(orig: Key, dest: Key) {\n    if (orig == 'a0' || dest == 'a0') return;\n    // check promotion\n    if (this.chess.get(orig)?.type == 'p' && (dest.charAt(1) == '8' || dest.charAt(1) == '1')) {\n      routeService.openModal('promotion', 'promotion.html', promotionController, false, true, this.player[0]).then((data: any) => {\n        this.registerMove(orig, dest, data.piece);\n      });\n    } else {\n      this.registerMove(orig, dest, undefined);\n    }\n  }\n\n  private registerMove(source: Square, target: Square, promotion: Exclude<PieceType, \"p\" | \"k\"> | undefined) {\n    this.chess.move({\n      from: source,\n      to: target,\n      promotion: promotion\n    });\n    if (promotion)\n      this.board.set({ fen: this.chess.fen() });\n    console.log(this.chess.fen());\n\n    this.parsePgn(this.chess.pgn());\n    // this.fenHistory.push(this.chess.fen());\n    // this.fenPointer++;\n    // this.playerMoved.emit();\n    // this.initializing = false;\n    // this.prepareMove();\n\n    if (!this.checkEnding()) {\n      soundService.playAudio('move');\n      //this.playerMoved.emit();\n      this.getOponentMove();\n    }\n  }\n\n  private checkEnding(): boolean {\n    const result = this.chess.game_over();\n    if (result) {\n      if ('checkmate' !== this.target && !this.chess.in_checkmate() ||\n        'checkmate' === this.target && this.chess.in_checkmate() && !this.player.startsWith(this.chess.turn())) {\n        soundService.playAudio('success');\n      } else {\n        soundService.playAudio('fail');\n      }\n\n      let message;\n      if (this.chess.in_checkmate())\n        message = 'position.checkmate';\n      else if (this.chess.in_stalemate())\n        message = 'position.stalemate';\n      else if (this.chess.insufficient_material())\n        message = 'position.insufficent-material';\n      else if (this.chess.in_threefold_repetition())\n        message = 'position.three-repetition';\n      else if (this.chess.in_draw())\n        message = 'position.rule-fifty';\n      else\n        message = 'position.game-over';\n\n      alertController.create({\n        header: window.AlpineI18n.t('position.game-over'),\n        message: window.AlpineI18n.t(`${message}`),\n        buttons: [\n          {\n            text: window.AlpineI18n.t('position.ok'),\n            cssClass: 'overlay-button'\n          }\n        ]\n      }).then(alert => alert.present());\n\n    }\n    return result;\n  }\n\n\n  private numberOfPieces(fen: string) {\n    return fen.substring(0, fen.indexOf(\" \")).replace(/\\d/g, \"\").replace(/\\//g, \"\").length;\n  }\n\n  private getOponentMove() {\n    let moveFunk;\n    if (this.useSyzygy && this.numberOfPieces(this.chess.fen()) <= 7) {\n      moveFunk = this.getSyzygyMove;\n    } else {\n      moveFunk = this.getStockfishMove;\n    }\n    moveFunk.call(this);\n  }\n\n  private getSyzygyMove() {\n    syzygyService.get(this.chess.fen())\n      .then(response => response.json().then(data => {\n        console.log(JSON.stringify(data));\n        const bestmove = data.moves[0].uci;\n        let match = bestmove.match(/^([a-h][1-8])([a-h][1-8])([qrbn])?/);\n        const from = match[1];\n        const to = match[2];\n        const promotion = match[3];\n        this.board.move(from as Key, to as Key);\n        this.chess.move({ from: from as Square, to: to as Square, promotion: promotion });\n        const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n        this.board.set({\n          fen: this.chess.fen(),\n          turnColor: turn,\n          movable: {\n            dests: this.toDests()\n          }\n        });\n        console.log(this.chess.fen());\n        this.parsePgn(this.chess.pgn());\n        if (this.checkEnding()) {\n          this.board.set({ viewOnly: true });\n        } else {\n          soundService.playAudio('move');\n        }\n      })\n      ).catch((_err) => {\n        this.useSyzygy = false;\n        toastController.create({\n          message: window.AlpineI18n.t('position.syzygy-error'),\n          position: 'middle',\n          color: 'warning',\n          duration: 2000\n        }).then(toast => toast.present());\n        this.getStockfishMove();\n      });\n\n    /*\n{\n  \"checkmate\": false,\n  \"stalemate\": false,\n  \"variant_win\": false,\n  \"variant_loss\": false,\n  \"insufficient_material\": false,\n  \"dtz\": -14,\n  \"precise_dtz\": -14,\n  \"dtm\": -14,\n  \"category\": \"loss\",\n  \"moves\": [\n    {\n      \"uci\": \"d7c7\",\n      \"san\": \"Kc7\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 13,\n      \"precise_dtz\": 13,\n      \"dtm\": 13,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7e7\",\n      \"san\": \"Ke7\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 13,\n      \"precise_dtz\": 13,\n      \"dtm\": 13,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7c8\",\n      \"san\": \"Kc8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7d8\",\n      \"san\": \"Kd8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    },\n    {\n      \"uci\": \"d7e8\",\n      \"san\": \"Ke8\",\n      \"zeroing\": false,\n      \"checkmate\": false,\n      \"stalemate\": false,\n      \"variant_win\": false,\n      \"variant_loss\": false,\n      \"insufficient_material\": false,\n      \"dtz\": 11,\n      \"precise_dtz\": 11,\n      \"dtm\": 11,\n      \"category\": \"win\"\n    }\n  ]\n}\n    */\n  }\n\n  private getStockfishMove() {\n    stockfishService.postMessage(`position fen ${this.chess.fen()}`);\n    this.listeningToStockfish = true;\n    stockfishService.postMessage(`go depth ${configurationService.configuration.stockfishDepth} movetime ${configurationService.configuration.stockfishMovetime * 1000}`);\n  }\n\n  private stockfishMessage(message: string) {\n    if (!this.listeningToStockfish) return;\n    //console.log(`STOCKFISH: ${message}`);\n    let match;\n    if (match = message.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/)) {\n      this.listeningToStockfish = false;\n\n      const from = match[1];\n      const to = match[2];\n      const promotion = (match[3] == 'r' || match[3] == 'n' || match[3] == 'b' || match[3] == 'q') ? match[3] : undefined;\n      this.board.move(from as Key, to as Key);\n      this.chess.move({ from: from as Square, to: to as Square, promotion: promotion });\n      const turn = this.chess.turn() === 'w' ? 'white' : 'black';\n      // this.board.set({\n      //   fen: this.chess.fen(),\n      //   turnColor: turn,\n      //   movable: {\n      //     dests: this.toDests()\n      //   }\n      // });\n      this.board.set({\n        fen: this.chess.fen(),\n        turnColor: turn,\n        movable: {\n          color: turn,\n          dests: this.toDests()\n        }\n      });\n      console.log(this.chess.fen());\n      this.parsePgn(this.chess.pgn());\n      if (this.checkEnding()) {\n        this.board.set({ viewOnly: true });\n      } else {\n        soundService.playAudio('move');\n      }\n    }\n  }\n\n  getSEOParams(): any {\n    return { 'kind': this.seo };\n  }\n\n  onExit(): Promise<boolean> {\n    return new Promise<boolean>(async resolve => {\n      const alert = await alertController.create({\n        header: window.AlpineI18n.t('position.confirm-exit.header'),\n        message: window.AlpineI18n.t('position.confirm-exit.message'),\n        buttons: [\n          {\n            text: window.AlpineI18n.t('position.confirm-exit.no'),\n            role: 'cancel',\n            cssClass: 'overlay-button',\n            handler: () => {\n              resolve(false);\n            }\n          }, {\n            text: window.AlpineI18n.t('position.confirm-exit.yes'),\n            cssClass: 'overlay-button',\n            handler: () => {\n              stockfishService.postMessage('stop');\n              menuController.get(MAIN_MENU_ID).then(function (menu) {\n                if (menu) menu.swipeGesture = true;\n              });\n              resolve(true);\n            }\n          }\n        ]\n      });\n      alert.present();\n    });\n  }\n\n}\n\nexport const positionController = new PositionController();\n","import { appController, homeController, aboutController, settingsController, listController, positionController, promotionController } from './controllers';\n\nexport const ROUTE_MAP = {\n    hash: true,\n    mainRoute: {\n        path: '/chessendgametraining/',\n        template: 'app.html',\n        tag: 'ion-app',\n        controller: appController,\n        hasParams: false\n    },\n    routes: [\n        {\n            path: '/',\n            template: 'home.html',\n            tag: 'ion-router-outlet',\n            controller: homeController,\n            hasParams: false\n        },\n        {\n            path: '/home',\n            template: 'home.html',\n            tag: 'ion-router-outlet',\n            controller: homeController,\n            hasParams: false\n        },\n        {\n            path: '/about',\n            template: 'about.html',\n            tag: 'ion-router-outlet',\n            controller: aboutController,\n            hasParams: false\n        },\n        {\n            path: '/settings',\n            template: 'settings.html',\n            tag: 'ion-router-outlet',\n            controller: settingsController,\n            hasParams: false\n        },\n        {\n            path: '/list/:idxCategory/:idxSubcategory',\n            template: 'list.html',\n            tag: 'ion-router-outlet',\n            controller: listController,\n            hasParams: true\n        },\n        {\n            path: '/position/:idxCategory/:idxSubcategory/:idxGame',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/fen/:fen1/:fen2/:fen3/:fen4/:fen5/:fen6/:fen7/:fen8',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/fen/:fen1/:fen2/:fen3/:fen4/:fen5/:fen6/:fen7/:fen8/:target',\n            template: 'position.html',\n            tag: 'ion-router-outlet',\n            controller: positionController,\n            hasParams: true\n        },\n        {\n            path: '/promotion',\n            template: 'promotion.html',\n            tag: 'ion-router-outlet',\n            controller: promotionController,\n            hasParams: false\n        }\n    ]\n};\n","import './styles';\n\nimport { services_initialize, routeService } from './services';\nimport { ROUTE_MAP } from './routes';\n\nservices_initialize().then(() => { routeService.init(ROUTE_MAP); });\n"],"file":"assets/index-DWPjWi_y.js"}